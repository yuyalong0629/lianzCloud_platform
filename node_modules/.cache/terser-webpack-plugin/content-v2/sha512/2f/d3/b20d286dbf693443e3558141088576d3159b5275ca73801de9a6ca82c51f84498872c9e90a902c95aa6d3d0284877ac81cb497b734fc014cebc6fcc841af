{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-1de3042a\"],{\"1eca\":function(e,t,s){\"use strict\";var i=s(\"a3a6\"),o=s.n(i);o.a},\"2f74\":function(e,t,s){},\"2fdb\":function(e,t,s){\"use strict\";var i=s(\"5ca1\"),o=s(\"d2c8\"),a=\"includes\";i(i.P+i.F*s(\"5147\")(a),\"String\",{includes:function(e){return!!~o(this,e,a).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},\"3b33\":function(e,t,s){\"use strict\";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"process\"},[s(\"div\",{staticClass:\"process-setup\"},[s(\"a-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:this.getMenuPermission.includes(\"ADD\"),expression:\"this.getMenuPermission.includes('ADD')\"}],attrs:{type:\"primary\"},on:{click:e.showDrawer}},[s(\"a-icon\",{attrs:{type:\"plus\"}}),e._v(\"新建\\n    \")],1),s(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:this.getMenuPermission.includes(\"DELETES\"),expression:\"this.getMenuPermission.includes('DELETES')\"}],staticClass:\"delete-btn\",on:{click:e.processDelete}},[s(\"a-icon\",{staticClass:\"delete-icon\",attrs:{type:\"delete\"}}),s(\"span\",[e._v(\"删除\")])],1),s(\"a-dropdown\",[s(\"span\",{staticClass:\"derive-btn\"},[s(\"a-icon\",{staticClass:\"derive-icon\",attrs:{type:\"check-circle\"}}),s(\"span\",[e._v(\"更多\")])],1),s(\"a-menu\",{attrs:{slot:\"overlay\"},slot:\"overlay\"},[s(\"a-menu-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:this.getMenuPermission.includes(\"IMPORT\"),expression:\"this.getMenuPermission.includes('IMPORT')\"}],key:\"0\"},[s(\"span\",[e._v(\"导入\")])]),s(\"a-menu-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:this.getMenuPermission.includes(\"EXPORT\"),expression:\"this.getMenuPermission.includes('EXPORT')\"}],key:\"1\"},[s(\"span\",[e._v(\"导出\")])])],1)],1)],1),s(\"div\",{staticClass:\"category-tab\"},[s(\"a-table\",{attrs:{columns:e.columns,dataSource:e.data,loading:e.loading,pagination:!1,rowSelection:e.rowSelection},scopedSlots:e._u([{key:\"code\",fn:function(t,i){return[s(\"a\",{attrs:{href:\"javascript:;\"},on:{click:function(t){return e.onHandleInfo(i)}}},[e._v(e._s(t))])]}}])})],1),s(\"a-drawer\",{attrs:{destroyOnClose:!0,placement:\"right\",closable:!1,visible:e.visible,width:1040,wrapStyle:{height:\"100%\",overflow:\"auto\",paddingBottom:\"108px\"}},on:{close:e.closeDrawer}},[s(\"process-info\",{attrs:{processInfo:e.processInfo},on:{isDrawer:e.isDrawer}})],1)],1)},o=[],a=s(\"75fc\"),n=(s(\"6762\"),s(\"2fdb\"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"process-info\"},[s(\"prompt-title\",{on:{isDisabled:e.isDisabled,isDelete:e.isDelete}}),s(\"a-row\",[s(\"a-col\",{attrs:{span:24}},[s(\"h3\",{staticClass:\"process-title\"},[e._v(\"基础信息\")])])],1),s(\"a-row\",[s(\"a-col\",{attrs:{span:24}},[s(\"a-form\",{attrs:{form:e.processFormInfo,layout:\"horizontal\",hideRequiredMark:\"\"}},[s(\"a-row\",[s(\"a-col\",{attrs:{span:8}},[s(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"工序编码\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"processCode\"],expression:\"['processCode']\"}],attrs:{disabled:\"disabled\",placeholder:\"默认带出\"}}):[e._v(e._s(e.getProcessInfo.code))]],2)],1),s(\"a-col\",{attrs:{span:8}},[s(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"工序名称\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"processName\",{rules:[{required:!0,message:\"请输入工序名称\"}]}],expression:\"['processName', {rules: [{ required: true, message: '请输入工序名称' }]}]\"}],attrs:{placeholder:\"请输入工序名称\"}}):[e._v(e._s(e.getProcessInfo.name))]],2)],1),s(\"a-col\",{attrs:{span:8}},[s(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"标准工时\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"processWorkHours\"],expression:\"['processWorkHours']\"}],attrs:{placeholder:\"请输入标准工时\"}}):[e._v(e._s(e.getProcessInfo.standardHours))]],2)],1),s(\"a-col\",{attrs:{span:8}},[s(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"工时计费\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"processBilling\"],expression:\"['processBilling']\"}],attrs:{placeholder:\"请输入工时计费\"}}):[e._v(e._s(e.getProcessInfo.timeBilling))]],2)],1),s(\"a-col\",{attrs:{span:8}},[s(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"备注\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"processRemark\"],expression:\"['processRemark']\"}],attrs:{placeholder:\"请输入备注\"}}):[e._v(e._s(e.getProcessInfo.remark))]],2)],1)],1)],1)],1)],1),s(\"a-row\",[s(\"a-col\",{attrs:{span:24}},[s(\"h3\",{staticClass:\"process-title\"},[e._v(\"文件\")])]),s(\"a-col\",{attrs:{span:24}},[s(\"div\",{staticClass:\"clearfix\",staticStyle:{marginLeft:\"16px\"}},[s(\"a-upload\",{attrs:{action:\"/api/ic/user/file/uploadFile\",listType:\"picture-card\",data:{bizType:\"GOODS\"},headers:e.headers,fileList:e.fileList},on:{preview:e.handlePreview,change:e.handleChange}},[e.fileList.length<1?s(\"div\",[s(\"a-icon\",{attrs:{type:\"plus\"}}),s(\"div\",{staticClass:\"ant-upload-text\"},[e._v(\"Upload\")])],1):e._e()]),s(\"a-modal\",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[s(\"img\",{staticStyle:{width:\"100%\"},attrs:{alt:\"example\",src:e.previewImage}})])],1)])],1),s(\"div\",{style:{position:\"absolute\",left:0,bottom:0,width:\"100%\",borderTop:\"1px solid #E9E9E9\",padding:\"10px 16px\",background:\"#FFF\",textAlign:\"right\"}},[s(\"a-button\",{style:{marginRight:\"8px\"},on:{click:e.onClose}},[e._v(\"取消\")]),e.isEdit?s(\"a-button\",{attrs:{type:\"primary\",loading:e.loading},on:{click:e.onSubmit}},[e._v(\"提交\")]):s(\"a-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"UPDATE\"),expression:\"getDetailPermission.includes('UPDATE')\"}],attrs:{type:\"primary\",disabled:!e.disabled,loading:e.loading},on:{click:e.onSave}},[e._v(\"保存\")])],1)],1)}),r=[],l=(s(\"7f7f\"),s(\"795b\")),c=s.n(l),d=s(\"a1ab\"),u=s(\"cd34\"),p=s(\"0d5e\"),m=s(\"365c\");function f(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"\";return this.loading=!0,Object(p[\"c\"])(m[\"a\"].processList+\"?code=\"+t+\"&name=\"+s).then(function(t){0===t.data.code&&(e.loading=!1,e.data=[],t.data.data.forEach(function(t){e.data.push({key:t.id,code:t.code,name:t.name,qc:t.qc?\"是\":\"否\",optBook:t.optBook,standardHours:t.standardHours,timeBilling:t.timeBilling,remark:t.remark})}))}).catch(function(e){console.log(e)})}function h(e){var t=this;return Object(p[\"e\"])(m[\"a\"].processAdd,e).then(function(e){if(console.log(e),0===e.data.code)return t.loading=!1,t.$message.success(\"添加成功\"),void t.$emit(\"isDrawer\",!1);t.loading=!1,t.$message.success(\"添加失败\"),t.$emit(\"isDrawer\",!0)}).catch(function(e){console.log(e)})}function v(e){var t=this;return Object(p[\"b\"])(m[\"a\"].processDelete,e).then(function(e){if(console.log(e),0===e.data.code)return t.$emit(\"isDrawer\",!1),void t.$message.success(\"删除成功\");t.$message.success(e.data.msg),t.$emit(\"isDrawer\",!0)}).catch(function(e){console.log(e)})}function g(e){var t=this;return Object(p[\"c\"])(m[\"a\"].processInfo+e).then(function(e){console.log(e),0===e.data.code&&(t.processInfo=e.data.data)}).catch(function(e){console.log(e)})}function b(e){var t=this;return Object(p[\"f\"])(m[\"a\"].processUpdate,e).then(function(e){if(console.log(e),0===e.data.code)return t.loading=!1,t.$message.success(\"修改成功\"),void t.$emit(\"isDrawer\",!1);t.loading=!1,t.$message.success(\"修改失败\"),t.$emit(\"isDrawer\",!0)}).catch(function(e){console.log(e)})}s(\"5118\");var w={name:\"ProcessInfo\",mixins:[u[\"a\"],u[\"c\"]],data:function(){return{processFormInfo:this.$form.createForm(this),previewVisible:!1,previewImage:\"\",fileList:[],headers:{\"AUTH-TOKEN\":localStorage.getItem(\"ACCESS_TOKEN\"),companyId:localStorage.getItem(\"companyId\")},getProcessInfo:{}}},props:{processInfo:{type:Object,default:{}}},methods:{onSubmit:function(e){e.preventDefault(),this.getFormData(null,this.fileList.length?this.fileList[0].response.data:\"\",h)},onSave:function(e){e.preventDefault(),this.getFormData(this.getProcessInfo.id,this.fileList.length?this.fileList[0].url:\"\",b)},isDisabled:function(e){var t=this,s=new c.a(function(s){t.disabled=!e,t.isLabelColor=!t.isLabelColor,s()});s.then(function(){t.disabled&&t.setFormData()})},isDelete:function(e){v.call(this,[this.processInfo.id])},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},handleChange:function(e){e.file;var t=e.fileList;this.fileList=t},getFormData:function(e,t,s){var i=this;this.processFormInfo.validateFields(function(o,a){if(!o){console.log(i.fileList),i.loading=!0;var n={id:e,name:a.processName,optBook:i.fileList.length>0?t:\"\",remark:a.processRemark,standardHours:a.processWorkHours,timeBilling:a.processBilling};console.log(n),s.call(i,n)}})},setFormData:function(){this.processFormInfo.setFieldsValue({processName:this.getProcessInfo.name,processInspection:this.getProcessInfo.qc,processRemark:this.getProcessInfo.remark,processWorkHours:this.getProcessInfo.standardHours,processBilling:this.getProcessInfo.timeBilling})}},computed:{getDetailPermission:function(){return this.$store.state.detailPermission}},watch:{processInfo:{handler:function(e){console.log(e),this.getProcessInfo=e,e&&e.optBook&&(this.fileList=[{url:e.optBook,uid:\"-1\",name:\"xxx.png\"}])},deep:!0,immediate:!0}},components:{\"prompt-title\":d[\"a\"]}},D=w,C=(s(\"1eca\"),s(\"2877\")),P=Object(C[\"a\"])(D,n,r,!1,null,\"aa8ef334\",null),y=P.exports,I=[{title:\"工序编码\",dataIndex:\"code\",width:\"20%\",scopedSlots:{customRender:\"code\"}},{title:\"工序名称\",width:\"20%\",dataIndex:\"name\"},{title:\"标准工时\",width:\"20%\",dataIndex:\"standardHours\"},{title:\"公时计费\",width:\"20%\",dataIndex:\"timeBilling\"},{title:\"备注\",width:\"20%\",dataIndex:\"remark\"}],k={name:\"Process\",mixins:[u[\"a\"],u[\"b\"]],data:function(){return{data:[],columns:I,selectKeyDelete:[],processInfo:{}}},created:function(){f.call(this)},methods:{processDelete:function(){var e=this;this.selectKeyDelete.length>0&&this.$confirm({title:\"您确认要删除吗?\",okType:\"danger\",onOk:function(){v.call(e,e.selectKeyDelete).then(function(){f.call(e),e.selectKeyDelete=[]})},onCancel:function(){console.log(\"Cancel\")},class:\"test\"})},onHandleInfo:function(e){var t=this;if(console.log(e),this.getMenuPermission.includes(\"DETAIL\"))return g.call(this,e.key).then(function(){t.visible=!0}),void this.$store.commit(\"setPromptTitle\",{title:\"工序管理详情\",isEdit:!0});this.$message.error(\"权限不足\")},isDrawer:function(e){var t=this;this.visible=e,this.timer=setTimeout(function(){f.call(t)},100)},showDrawer:function(){this.visible=!0,this.processInfo={},this.$store.commit(\"setPromptTitle\",{title:\"新建工序管理\",isEdit:!1})}},computed:{rowSelection:function(){var e=this;return{onChange:function(t,s){e.selectKeyDelete=Object(a[\"a\"])(t),console.log(e.selectKeyDelete),console.log(s),console.log(t)}}},getMenuPermission:function(){return this.$store.state.menuPermission}},components:{\"process-info\":y}},x=k,E=(s(\"3b61\"),Object(C[\"a\"])(x,i,o,!1,null,\"16e9c474\",null));t[\"default\"]=E.exports},\"3b61\":function(e,t,s){\"use strict\";var i=s(\"2f74\"),o=s.n(i);o.a},\"46b4\":function(e,t,s){},5147:function(e,t,s){var i=s(\"2b4c\")(\"match\");e.exports=function(e){var t=/./;try{\"/./\"[e](t)}catch(s){try{return t[i]=!1,!\"/./\"[e](t)}catch(o){}}return!0}},6762:function(e,t,s){\"use strict\";var i=s(\"5ca1\"),o=s(\"c366\")(!0);i(i.P,\"Array\",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),s(\"9c6c\")(\"includes\")},\"7f7f\":function(e,t,s){var i=s(\"86cc\").f,o=Function.prototype,a=/^\\s*function ([^ (]*)/,n=\"name\";n in o||s(\"9e1e\")&&i(o,n,{configurable:!0,get:function(){try{return(\"\"+this).match(a)[1]}catch(e){return\"\"}}})},\"80dd\":function(e,t,s){\"use strict\";var i=s(\"46b4\"),o=s.n(i);o.a},a1ab:function(e,t,s){\"use strict\";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",{staticClass:\"prompt-title\"},[s(\"a-row\",[s(\"a-col\",{attrs:{span:18}},[s(\"h3\",{staticClass:\"prompt-h3\"},[e._v(e._s(e.getPromptTitle.title))])]),e.getPromptTitle.isEdit?s(\"a-col\",{staticClass:\"prompt-wrapper\",attrs:{span:6}},[s(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"UPDATE\"),expression:\"getDetailPermission.includes('UPDATE')\"}],staticClass:\"prompt-edit\",on:{click:e.onHandlePromptEdit}},[s(\"a-icon\",{staticClass:\"eidt-icon\",attrs:{type:\"edit\"}}),s(\"span\",[e._v(e._s(e.editTitle))])],1),s(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"DELETE\"),expression:\"getDetailPermission.includes('DELETE')\"}],staticClass:\"prompt-delete\",on:{click:e.onHandlePromptDelete}},[s(\"a-icon\",{staticClass:\"delete-icon\",attrs:{type:\"delete\"}}),s(\"span\",[e._v(\"删除\")])],1)]):e._e()],1)],1)},o=[],a={name:\"prompt-title\",data:function(){return{editTitle:\"编辑\"}},methods:{onHandlePromptEdit:function(){if(\"编辑\"===this.editTitle)return this.editTitle=\"取消\",void this.$emit(\"isDisabled\",!1);this.$emit(\"isDisabled\",!0),this.editTitle=\"编辑\"},onHandlePromptDelete:function(){var e=this;this.$confirm({title:\"删除\",content:\"您确认要删除？\",okText:\"删除\",okType:\"danger\",cancelText:\"取消\",onOk:function(){e.$emit(\"isDelete\",!1)},onCancel:function(){console.log(\"Cancel\")}})}},computed:{getPromptTitle:function(){return this.$store.state.promptTitle},getDetailPermission:function(){return this.$store.state.detailPermission}}},n=a,r=(s(\"80dd\"),s(\"2877\")),l=Object(r[\"a\"])(n,i,o,!1,null,\"a552123e\",null);t[\"a\"]=l.exports},a3a6:function(e,t,s){},cd34:function(e,t,s){\"use strict\";s.d(t,\"a\",function(){return i}),s.d(t,\"b\",function(){return o}),s.d(t,\"c\",function(){return a});var i={data:function(){return{loading:!1,visible:!1,labelCol:{span:6},wrapperCol:{span:14},isEdit:!0,disabled:!0,isLabelColor:!1,timer:null}},beforeDestroy:function(){clearTimeout(this.timer)},methods:{onClose:function(){this.$emit(\"isDrawer\",!1)}}},o={methods:{closeDrawer:function(){this.visible=!1}}},a={watch:{\"$store.state.promptTitle.isEdit\":{handler:function(e){this.isEdit=!e,this.disabled=!e,this.isEdit?this.isLabelColor=!1:this.isLabelColor=!0},deep:!0,immediate:!0}}};Boolean},d2c8:function(e,t,s){var i=s(\"aae3\"),o=s(\"be13\");e.exports=function(e,t,s){if(i(t))throw TypeError(\"String#\"+s+\" doesn't accept regex!\");return String(o(e))}}}]);","extractedComments":[]}