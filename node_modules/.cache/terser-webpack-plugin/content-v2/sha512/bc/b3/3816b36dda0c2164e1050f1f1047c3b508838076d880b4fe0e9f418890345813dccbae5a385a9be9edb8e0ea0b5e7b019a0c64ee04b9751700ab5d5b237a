{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2387da43\"],{\"129a\":function(e,t,a){\"use strict\";var i=a(\"9defa\"),o=a.n(i);o.a},\"2fdb\":function(e,t,a){\"use strict\";var i=a(\"5ca1\"),o=a(\"d2c8\"),n=\"includes\";i(i.P+i.F*a(\"5147\")(n),\"String\",{includes:function(e){return!!~o(this,e,n).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},\"46b4\":function(e,t,a){},5147:function(e,t,a){var i=a(\"2b4c\")(\"match\");e.exports=function(e){var t=/./;try{\"/./\"[e](t)}catch(a){try{return t[i]=!1,!\"/./\"[e](t)}catch(o){}}return!0}},6762:function(e,t,a){\"use strict\";var i=a(\"5ca1\"),o=a(\"c366\")(!0);i(i.P,\"Array\",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(\"9c6c\")(\"includes\")},\"80dd\":function(e,t,a){\"use strict\";var i=a(\"46b4\"),o=a.n(i);o.a},\"85de\":function(e,t,a){\"use strict\";var i=a(\"b788\"),o=a.n(i);o.a},95205:function(e,t,a){\"use strict\";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"category\"},[a(\"div\",{staticClass:\"category-setup\"},[a(\"a-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:this.getMenuPermission.includes(\"ADD\"),expression:\"this.getMenuPermission.includes('ADD')\"}],attrs:{type:\"primary\"},on:{click:e.showDrawer}},[a(\"a-icon\",{attrs:{type:\"plus\"}}),e._v(\"新建\\n    \")],1)],1),a(\"div\",{staticClass:\"category-tab\"},[a(\"a-table\",{attrs:{columns:e.columns,dataSource:e.data,loading:e.loading,pagination:!1,rowKey:function(e){return e.id},childrenColumnName:\"childrens\"},scopedSlots:e._u([{key:\"name\",fn:function(t,i){return[a(\"a\",{attrs:{href:\"javascript:;\"},on:{click:function(t){return e.onHandleInfo(i)}}},[e._v(e._s(t))])]}},{key:\"createTime\",fn:function(t,i){return[a(\"span\",[e._v(e._s(e._f(\"formatDate\")(t)))])]}}])})],1),a(\"a-drawer\",{attrs:{destroyOnClose:!0,placement:\"right\",closable:!1,visible:e.visible,width:1040,wrapStyle:{height:\"100%\",overflow:\"auto\",paddingBottom:\"108px\"}},on:{close:e.closeDrawer}},[a(\"category-info\",{attrs:{categoryInfo:e.categoryInfo},on:{isDrawer:e.isDrawer}})],1)],1)},o=[],n=(a(\"6762\"),a(\"2fdb\"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"category-info\"},[a(\"prompt-title\",{on:{isDisabled:e.isDisabled,isDelete:e.isDelete}}),a(\"a-row\",[a(\"a-col\",{attrs:{span:24}},[a(\"h3\",{staticClass:\"categoryInfo-title\"},[e._v(\"分类信息\")])])],1),a(\"a-row\",[a(\"a-col\",{attrs:{span:24}},[a(\"a-form\",{attrs:{form:e.cateGoryInfo,layout:\"horizontal\",hideRequiredMark:\"\"}},[a(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"分类名称\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?a(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"categoryClassName\",{rules:[{required:!0,message:\"请输入分类名称\"}]}],expression:\"['categoryClassName', {rules: [{ required: true, message: '请输入分类名称' }]}]\"}],attrs:{placeholder:\"请输入分类名称\"}}):[e._v(e._s(e.viewCategoryInfo.name))]],2),a(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"上级分类\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?a(\"a-cascader\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"categorySuperior\"],expression:\"['categorySuperior']\"}],attrs:{options:e.options,fieldNames:{label:\"name\",value:\"id\",children:\"childrens\"},placeholder:\"请输入分类名称\",changeOnSelect:\"\"},on:{change:e.onChangeCategoryName}}):[e._v(e._s(e.categorySuperiorObj.val.length>1?e.categorySuperiorObj.val.slice(0,-1).join(\"/\"):\"无上级分类\"))]],2),a(\"a-form-item\",{class:{labelColor:e.isLabelColor},attrs:{label:\"备注\",\"label-col\":e.labelCol,\"wrapper-col\":e.wrapperCol}},[e.disabled?a(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"categoryRemark\"],expression:\"['categoryRemark']\"}],attrs:{placeholder:\"请输入备注\"}}):[e._v(e._s(e.viewCategoryInfo.remark))]],2)],1)],1)],1),a(\"div\",{style:{position:\"absolute\",left:0,bottom:0,width:\"100%\",borderTop:\"1px solid #E9E9E9\",padding:\"10px 16px\",background:\"#FFF\",textAlign:\"right\"}},[a(\"a-button\",{style:{marginRight:\"8px\"},on:{click:e.onClose}},[e._v(\"取消\")]),e.isEdit?a(\"a-button\",{attrs:{type:\"primary\",loading:e.loading},on:{click:e.onSubmit}},[e._v(\"提交\")]):a(\"a-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"UPDATE\"),expression:\"getDetailPermission.includes('UPDATE')\"}],attrs:{type:\"primary\",disabled:!e.disabled,loading:e.loading},on:{click:e.onSave}},[e._v(\"保存\")])],1)],1)}),r=[],s=a(\"5176\"),c=a.n(s),l=a(\"75fc\"),d=(a(\"7f7f\"),a(\"96cf\"),a(\"3b8d\")),u=a(\"a1ab\"),m=a(\"cd34\"),f=a(\"365c\"),p=a(\"0d5e\"),h=a(\"c3fb\");function g(){var e=this;return this.loading=!0,Object(p[\"c\"])(f[\"a\"].bomCategoryTree).then(function(t){0===t.data.code&&(e.loading=!1,e.data=[],t.data.data.forEach(function(t){e.data.push({id:t.id,name:t.name,code:t.code,createTime:t.createTime,status:t.status,childrens:null===t.childrens?\"\":t.childrens})}),h[\"a\"].call(e,e.data))}).catch(function(e){console.log(e)})}function v(){var e=this;return Object(p[\"c\"])(f[\"a\"].bomCategoryTree).then(function(t){0===t.data.code&&(e.options=t.data.data)}).catch(function(e){console.log(e)})}function b(e){var t=this;return Object(p[\"e\"])(f[\"a\"].categoryAdd,e).then(function(e){if(0===e.data.code)return t.loading=!1,t.$message.success(\"添加成功\"),t.$emit(\"isDrawer\",!1),!1;t.$message.error(e.data.msg),t.$emit(\"isDrawer\",!0),t.loading=!1}).catch(function(e){console.log(e)})}function y(e){var t=this;return Object(p[\"c\"])(f[\"a\"].viewCategory+e).then(function(e){0===e.data.code&&(t.categoryInfo=e.data.data)}).catch(function(e){console.log(e)})}function w(e){var t=this;return Object(p[\"a\"])(f[\"a\"].categoryRemove+\"?cids=\".concat(e)).then(function(e){return 0===e.data.code?(t.loading=!1,t.$message.success(\"删除成功\"),!1):1===e.data.code?(t.loading=!1,t.$message.error(e.data.msg),!1):void 0}).catch(function(e){console.log(e),t.$message.error(\"请求错误\"),t.loading=!1})}function C(e){var t=this;return Object(p[\"f\"])(f[\"a\"].categorySave,e).then(function(e){if(0===e.data.code)return t.loading=!1,t.$message.success(\"修改成功\"),t.$emit(\"isDrawer\",!1),!1;t.loading=!1,t.$emit(\"isDrawer\",!0),t.$message.error(e.data.msg)}).catch(function(e){console.log(e)})}var D=a(\"5118\"),T=a(\"4be7\"),x={name:\"CategoryInfo\",mixins:[m[\"a\"],m[\"c\"]],data:function(){return{cateGoryInfo:this.$form.createForm(this),options:[],viewCategoryInfo:{},categorySuperiorObj:{val:[],id:[]}}},props:{categoryInfo:{type:Object,default:{}}},created:function(){},methods:{onChangeCategoryName:function(e){console.log(e)},onSubmit:function(e){e.preventDefault(),this.getFormData(null,b)},onSave:function(e){e.preventDefault(),this.getFormData(this.viewCategoryInfo.id,C)},isDisabled:function(e){var t=this,a=new T[\"Promise\"](function(a){t.disabled=!e,t.isLabelColor=!t.isLabelColor,a()});a.then(function(){t.disabled&&t.setFormData()})},isDelete:function(e){var t=this;w.call(this,this.viewCategoryInfo.id).then(function(){t.$emit(\"isDrawer\",e)})},getFormData:function(){var e=Object(d[\"a\"])(regeneratorRuntime.mark(function e(t,a){var i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.cateGoryInfo.validateFields(function(e,o){if(!e){i.loading=!0;var n={catType:1,id:t,name:o.categoryClassName||\"\",pid:o.categorySuperior?o.categorySuperior.slice(-1).join(\"\"):0,remark:o.categoryRemark||\"\"};a.call(i,n)}});case 1:case\"end\":return e.stop()}},e,this)}));function t(t,a){return e.apply(this,arguments)}return t}(),setFormData:function(){this.cateGoryInfo.setFieldsValue({categoryClassName:this.viewCategoryInfo.name,categorySuperior:1===this.categorySuperiorObj.id.length?[]:Object(l[\"a\"])(this.categorySuperiorObj.id).splice(0,this.categorySuperiorObj.id.length-1),categoryRemark:this.viewCategoryInfo.remark})}},computed:{getDetailPermission:function(){return this.$store.state.detailPermission}},watch:{categoryInfo:{handler:function(e){var t=this;this.viewCategoryInfo=c()({},e),v.call(this).then(function(){t.categorySuperiorObj.val=Object(h[\"c\"])(e.id,t.options,\"name\"),t.categorySuperiorObj.id=Object(h[\"c\"])(e.id,t.options,\"id\")})},deep:!0,immediate:!0}},components:{\"prompt-title\":u[\"a\"]}},P=x,E=(a(\"85de\"),a(\"2877\")),$=Object(E[\"a\"])(P,n,r,!1,null,\"62eda328\",null),S=$.exports,_=[{title:\"分类名称\",dataIndex:\"name\",width:\"25%\",scopedSlots:{customRender:\"name\"}},{title:\"分类编码\",width:\"25%\",dataIndex:\"code\"},{title:\"创建时间\",width:\"25%\",dataIndex:\"createTime\",scopedSlots:{customRender:\"createTime\"}},{title:\"状态\",width:\"25%\",dataIndex:\"status\"}],I={name:\"Category\",mixins:[m[\"a\"],m[\"b\"]],data:function(){return{data:[],columns:_,categoryInfo:{}}},created:function(){g.call(this)},methods:{onHandleInfo:function(e){var t=this;if(this.getMenuPermission.includes(\"DETAIL\"))return y.call(this,e.id).then(function(){t.visible=!0}),void this.$store.commit(\"setPromptTitle\",{title:\"产品分类详情\",isEdit:!0});this.$message.error(\"权限不足\")},isDrawer:function(e){var t=this;this.visible=e,this.timer=Object(D[\"setTimeout\"])(function(){g.call(t)},100)},showDrawer:function(){this.visible=!0,this.$store.commit(\"setPromptTitle\",{title:\"新建产品分类\",isEdit:!1})}},watch:{\"$store.state.menuPermission\":{handler:function(e){console.log(e)},deep:!0,immediate:!0}},computed:{getMenuPermission:function(){return this.$store.state.menuPermission}},components:{\"category-info\":S}},O=I,j=(a(\"129a\"),Object(E[\"a\"])(O,i,o,!1,null,\"232e9418\",null));t[\"default\"]=j.exports},\"9defa\":function(e,t,a){},a1ab:function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"prompt-title\"},[a(\"a-row\",[a(\"a-col\",{attrs:{span:18}},[a(\"h3\",{staticClass:\"prompt-h3\"},[e._v(e._s(e.getPromptTitle.title))])]),e.getPromptTitle.isEdit?a(\"a-col\",{staticClass:\"prompt-wrapper\",attrs:{span:6}},[a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"UPDATE\"),expression:\"getDetailPermission.includes('UPDATE')\"}],staticClass:\"prompt-edit\",on:{click:e.onHandlePromptEdit}},[a(\"a-icon\",{staticClass:\"eidt-icon\",attrs:{type:\"edit\"}}),a(\"span\",[e._v(e._s(e.editTitle))])],1),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.getDetailPermission.includes(\"DELETE\"),expression:\"getDetailPermission.includes('DELETE')\"}],staticClass:\"prompt-delete\",on:{click:e.onHandlePromptDelete}},[a(\"a-icon\",{staticClass:\"delete-icon\",attrs:{type:\"delete\"}}),a(\"span\",[e._v(\"删除\")])],1)]):e._e()],1)],1)},o=[],n={name:\"prompt-title\",data:function(){return{editTitle:\"编辑\"}},methods:{onHandlePromptEdit:function(){if(\"编辑\"===this.editTitle)return this.editTitle=\"取消\",void this.$emit(\"isDisabled\",!1);this.$emit(\"isDisabled\",!0),this.editTitle=\"编辑\"},onHandlePromptDelete:function(){var e=this;this.$confirm({title:\"删除\",content:\"您确认要删除？\",okText:\"删除\",okType:\"danger\",cancelText:\"取消\",onOk:function(){e.$emit(\"isDelete\",!1)},onCancel:function(){console.log(\"Cancel\")}})}},computed:{getPromptTitle:function(){return this.$store.state.promptTitle},getDetailPermission:function(){return this.$store.state.detailPermission}}},r=n,s=(a(\"80dd\"),a(\"2877\")),c=Object(s[\"a\"])(r,i,o,!1,null,\"a552123e\",null);t[\"a\"]=c.exports},a1ce:function(e,t,a){var i=a(\"63b6\"),o=a(\"25eb\"),n=a(\"294c\"),r=a(\"e692\"),s=\"[\"+r+\"]\",c=\"​\",l=RegExp(\"^\"+s+s+\"*\"),d=RegExp(s+s+\"*$\"),u=function(e,t,a){var o={},s=n(function(){return!!r[e]()||c[e]()!=c}),l=o[e]=s?t(m):r[e];a&&(o[a]=l),i(i.P+i.F*s,\"String\",o)},m=u.trim=function(e,t){return e=String(o(e)),1&t&&(e=e.replace(l,\"\")),2&t&&(e=e.replace(d,\"\")),e};e.exports=u},b788:function(e,t,a){},cd34:function(e,t,a){\"use strict\";a.d(t,\"a\",function(){return i}),a.d(t,\"b\",function(){return o}),a.d(t,\"c\",function(){return n});var i={data:function(){return{loading:!1,visible:!1,labelCol:{span:6},wrapperCol:{span:14},isEdit:!0,disabled:!0,isLabelColor:!1,timer:null}},beforeDestroy:function(){clearTimeout(this.timer)},methods:{onClose:function(){this.$emit(\"isDrawer\",!1)}}},o={methods:{closeDrawer:function(){this.visible=!1}}},n={watch:{\"$store.state.promptTitle.isEdit\":{handler:function(e){this.isEdit=!e,this.disabled=!e,this.isEdit?this.isLabelColor=!1:this.isLabelColor=!0},deep:!0,immediate:!0}}};Boolean},d2c8:function(e,t,a){var i=a(\"aae3\"),o=a(\"be13\");e.exports=function(e,t,a){if(i(t))throw TypeError(\"String#\"+a+\" doesn't accept regex!\");return String(o(e))}},e692:function(e,t){e.exports=\"\\t\\n\\v\\f\\r   ᠎             　\\u2028\\u2029\\ufeff\"}}]);","extractedComments":[]}