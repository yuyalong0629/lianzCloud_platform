{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-7f2e5d88\"],{\"0846\":function(t,e,a){\"use strict\";var r=a(\"d2dd\"),s=a.n(r);s.a},\"2fdb\":function(t,e,a){\"use strict\";var r=a(\"5ca1\"),s=a(\"d2c8\"),i=\"includes\";r(r.P+r.F*a(\"5147\")(i),\"String\",{includes:function(t){return!!~s(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},4467:function(t,e,a){\"use strict\";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"a-row\",[a(\"a-col\",{staticClass:\"purchase-right\",attrs:{span:24}},[a(\"inputSearch\",{attrs:{typeInput:t.typeInput},on:{dataChange:t.dataChange}}),a(\"a-table\",{attrs:{columns:t.columns,dataSource:t.data,pagination:t.pagination,rowSelection:t.rowSelection,loading:t.loading},on:{change:t.onChangePage},scopedSlots:t._u([t._l([\"odOrderNumber\",\"code\"],function(e,r){return{key:e,fn:function(s,i){return[a(\"a\",{key:r,attrs:{href:\"javascript:;\"},on:{click:function(a){return t.showDrawer(e,i)}}},[t._v(t._s(i[e]))])]}}}),{key:\"odRequireDueDate\",fn:function(e){return a(\"span\",{},[t._v(t._s(e?t.moment(e).format(\"YYYY-MM-DD\"):\"\"))])}},{key:\"status\",fn:function(t,e){return[a(\"statusStep\",{attrs:{current:e.num,status:e.status}})]}}],null,!0)})],1)],1),a(\"a-drawer\",{attrs:{destroyOnClose:!0,placement:\"right\",closable:!1,visible:t.visible,width:1040,wrapStyle:{height:\"100%\",overflow:\"auto\",paddingBottom:\"108px\"}},on:{close:t.closeDrawer}},[a(\"purchaseInfo\",{attrs:{factoryProductionOrderId:t.factoryProductionOrderId,purchaseId:t.purchaseId,prchaseDetial:t.prchaseDetial},on:{isDrawer:t.isDrawer}})],1)],1)},s=[],i=(a(\"c5f6\"),a(\"6762\"),a(\"2fdb\"),a(\"cebc\")),n=a(\"365c\"),o=a(\"0d5e\"),c=a(\"cd34\"),l=[{title:\"订单编号\",dataIndex:\"odOrderNumber\",scopedSlots:{customRender:\"odOrderNumber\"}},{title:\"产品编码\",dataIndex:\"code\"},{title:\"产品名称\",dataIndex:\"name\"},{title:\"规格\",dataIndex:\"spec\"},{title:\"材质\",dataIndex:\"cz\"},{title:\"单位\",dataIndex:\"unit\"},{title:\"数量\",dataIndex:\"number\"},{title:\"交期\",dataIndex:\"odRequireDueDate\",scopedSlots:{customRender:\"odRequireDueDate\"}},{title:\"状态\",dataIndex:\"statusNum\",scopedSlots:{customRender:\"status\"},width:\"5%\"}],d=[{title:\"销售单号\",dataIndex:\"relateOrderCode\"},{title:\"客户名称\",dataIndex:\"relateCustName\"},{title:\"数量\",dataIndex:\"odNumber\"},{title:\"收货方式\",dataIndex:\"receiveWay\",scopedSlots:{customRender:\"receiveWay\"}}],u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"purchase-info\"},[a(\"div\",{staticClass:\"prompt-title\"},[a(\"a-row\",[a(\"a-col\",{attrs:{span:16}},[a(\"h3\",{staticClass:\"prompt-h3\"},[t._v(\"工单详情\")])]),a(\"a-col\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.getDetailPermission.includes(\"UPDATE\"),expression:\"getDetailPermission.includes('UPDATE')\"}],staticClass:\"prompt-wrapper\",attrs:{span:8}},[a(\"span\",{staticClass:\"prompt-delete\",on:{click:t.printProductOrder}},[a(\"a-icon\",{attrs:{type:\"printer\"}}),a(\"span\",[t._v(\"打印\")])],1),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:-1===t.prchaseDetial.num,expression:\"prchaseDetial.num === -1\"}],staticClass:\"prompt-edit\",on:{click:function(e){return t.orderPick(\"RECEIVED\")}}},[a(\"i\",{staticClass:\"iconfont iconyijiedan\",staticStyle:{color:\"#F0BB2E\",\"margin-right\":\"4px\"}}),a(\"span\",[t._v(\"接单\")])]),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"RECEIVED\"===t.prchaseDetial.status,expression:\"prchaseDetial.status === 'RECEIVED'\"}],staticClass:\"prompt-delete\",on:{click:function(e){return t.orderPick(\"IN_PRODUCTION\")}}},[a(\"a-icon\",{staticStyle:{color:\"#017600\",\"margin-right\":\"4px\"},attrs:{type:\"file-protect\"}}),a(\"span\",[t._v(\"生产\")])],1),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"IN_PRODUCTION\"===t.prchaseDetial.status,expression:\"prchaseDetial.status === 'IN_PRODUCTION'\"}],staticClass:\"prompt-delete\",on:{click:function(e){return t.orderPick(\"COMPLETED\")}}},[a(\"a-icon\",{staticStyle:{color:\"#1890ff\",\"margin-right\":\"4px\"},attrs:{type:\"file-done\"}}),a(\"span\",[t._v(\"完成\")])],1),a(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:-1===t.prchaseDetial.num||\"RECEIVED\"===t.prchaseDetial.status,expression:\"prchaseDetial.num === -1 || prchaseDetial.status === 'RECEIVED'\"}],staticClass:\"prompt-delete\",on:{click:function(e){return t.orderPick(\"CANCELLED\")}}},[a(\"i\",{staticClass:\"iconfont iconjujue\",staticStyle:{color:\"#D50304\",\"margin-right\":\"4px\"}}),a(\"span\",[t._v(\"取消\")])])])],1)],1),a(\"a-row\",[a(\"a-col\",{attrs:{span:24}},[a(\"h3\",{staticClass:\"purchase-info-title\"},[t._v(\"基本信息\")])])],1),a(\"a-row\",[a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"订单编码\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.odOrderNumber))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"产品名称\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.name))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"承诺交期\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.odRequireDueDate?t.moment(t.prchaseDetial.odRequireDueDate).format(\"YYYY-MM-DD\"):\"\"))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"产品规格\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.spec))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"当前版本\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.groupName))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"总数量\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[t._v(t._s(t.prchaseDetial.totalCount))]],2)],1),a(\"a-col\",{attrs:{span:8}},[a(\"a-form-item\",{attrs:{label:\"工艺确认\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[[a(\"a-switch\",{attrs:{checked:t.prchaseDetial.craft,disabled:\"\"}})]],2)],1)],1),a(\"a-row\",[a(\"a-col\",{attrs:{span:24}},[a(\"h3\",{staticClass:\"purchase-info-title\"},[t._v(\"工厂生产单详情\")])])],1),a(\"a-row\",[a(\"a-table\",{attrs:{columns:t.detailColumns,dataSource:t.prchaseDetial.list,pagination:!1},scopedSlots:t._u([{key:\"receiveWay\",fn:function(e){return[t._v(t._s(\"WAREHOUSE\"===e?\"共享仓\":\"\"))]}}])})],1),a(\"a-row\",[a(\"a-col\",{attrs:{span:24}},[a(\"h3\",{staticClass:\"purchase-info-title\"},[t._v(\"订单进度\")])])],1),a(\"a-row\",[a(\"a-col\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{span:12}},[t.prchaseDetial.orderProgress?a(\"a-steps\",{attrs:{progressDot:\"\",current:t.prchaseDetial.num}},[t._l(t.prchaseDetial.orderProgress.list,function(e,r){return[a(\"a-step\",{key:r,attrs:{title:t._f(\"stateFilter\")(e.state),status:\"REJECTED\"===e.state||\"CANCELLED\"===e.state?\"error\":\"\"}},[a(\"template\",{slot:\"description\"},[a(\"span\",{staticClass:\"stepC\"},[t._v(t._s(e.name))]),a(\"p\",{staticClass:\"stepC\"},[t._v(t._s(e.date))])])],2)]})],2):t._e()],1)],1),a(\"div\",{style:{position:\"absolute\",left:0,bottom:0,width:\"100%\",borderTop:\"1px solid #E9E9E9\",padding:\"10px 16px\",background:\"#FFF\",textAlign:\"right\"}},[a(\"a-button\",{style:{marginRight:\"8px\"},on:{click:t.onClose}},[t._v(\"取消\")]),a(\"a-button\",{attrs:{type:\"primary\",disabled:!t.edit},on:{click:t.onClose}},[t._v(\"保存\")])],1)],1)},p=[],h=a(\"75cd\"),m=a(\"bc3a\"),f=a.n(m),g=a(\"c1df\"),v=a.n(g),_={mixins:[c[\"a\"],c[\"c\"],h[\"e\"]],props:[\"purchaseId\",\"factoryProductionOrderId\",\"prchaseDetial\"],data:function(){return{edit:!1,detailColumns:d,actionOrder:!1}},computed:{getDetailPermission:function(){return this.$store.state.detailPermission}},methods:{moment:v.a,isDisabled:function(t){this.disabled=!t},isDelete:function(t){console.log(t)},orderPick:function(t){var e=this;if(this.actionOrder)this.$message.warning(\"请不要重复操作\");else{var a={};this.actionOrder=!0,a.id=this.purchaseId,a.status=t,Object(o[\"e\"])(n[\"a\"].updateFactoryPolicyStatus,a).then(function(t){0===t.data.code?(e.$message.success(\"操作成功\"),e.onClose()):(e.actionOrder=!1,e.$message.error(t.data.msg))}).catch(function(){e.$message.error(\"系统错误\"),e.actionOrder=!1})}},printProductOrder:function(){var t=this,e=new URLSearchParams;e.append(\"factoryProductionOrderId\",this.factoryProductionOrderId),f.a.get(n[\"a\"].printProductionOrder,{responseType:\"blob\",params:e}).then(function(e){t.download(e)})},download:function(t){if(t){var e=document.getElementsByTagName(\"iframe\")[0];e&&document.body.removeChild(e);var a=new Blob([t.data],{type:\"application/pdf;charset=utf-8\"}),r=window.URL.createObjectURL(a),s=document.createElement(\"iframe\");s.style.display=\"none\",s.id=\"rm\",s.src=r,document.body.appendChild(s);var i=document.getElementById(\"rm\");i.contentWindow.print()}}}},y=_,w=(a(\"7c3b\"),a(\"2877\")),D=Object(w[\"a\"])(y,u,p,!1,null,\"248278da\",null),b=D.exports,C=a(\"e734\"),O=a(\"62ae\"),S={mixins:[c[\"a\"],c[\"b\"]],components:{purchaseInfo:b,inputSearch:C[\"a\"],statusStep:O[\"a\"]},data:function(){return{typeInput:\"factory\",columns:l,data:[],selectedRowKeys:[],pagination:{total:0,pageSize:15,defaultCurrent:1,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:[\"10\",\"15\",\"30\",\"50\",\"100\"]},workshopOrdersPostBean:{},purchaseId:\"\",factoryProductionOrderId:\"\",prchaseDetial:{}}},created:function(){this.getFactoryPolicyOrderList()},computed:{rowSelection:function(){var t=this.selectedRowKeys;return{selectedRowKeys:t,onChange:this.onChangeTab,hideDefaultSelections:!1}},getMenuPermission:function(){return this.$store.state.menuPermission}},methods:{moment:v.a,dataChange:function(t){this.workshopOrdersPostBean=Object(i[\"a\"])({},t),this.getFactoryPolicyOrderList()},onChangePage:function(t,e,a){this.pagination.pageSize=t.pageSize,this.getFactoryPolicyOrderList(t.current)},showDrawer:function(t,e){switch(t){case\"odOrderNumber\":this.purchaseId=e.id,this.factoryProductionOrderId=e.factoryProductionOrderId,this.getProcurementDetial(e.id);break}},getProcurementDetial:function(t){var e=this;this.getMenuPermission.includes(\"DETAIL\")?Object(o[\"e\"])(n[\"a\"].getFactoryPolicyDetail,{id:t}).then(function(t){if(0===t.data.code){var a=t.data.data;a.list.forEach(function(t,e){t[\"key\"]=e}),e.prchaseDetial=a,e.visible=!0,e.$store.commit(\"setPromptTitle\",{title:\"采购详情\",isEdit:!1})}else e.$message.error(t.data.msg)}).catch(function(){e.$message.error(\"系统错误\")}):this.$message.error(\"权限不足\")},isDrawer:function(t){this.visible=t,this.getFactoryPolicyOrderList()},getFactoryPolicyOrderList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0;var a=this.workshopOrdersPostBean;a.currentPage=e,a.pageSize=this.pagination.pageSize,Object(o[\"e\"])(n[\"a\"].getFactoryPolicyOrderList,a).then(function(e){if(0===e.data.code){var a=e.data.data.records;a.forEach(function(t,e){t[\"key\"]=e}),t.pagination.total=Number(e.data.data.total),t.data=a}t.loading=!1})}}},P=S,I=(a(\"ed7f\"),Object(w[\"a\"])(P,r,s,!1,null,\"244a23c8\",null));e[\"default\"]=I.exports},5147:function(t,e,a){var r=a(\"2b4c\")(\"match\");t.exports=function(t){var e=/./;try{\"/./\"[t](e)}catch(a){try{return e[r]=!1,!\"/./\"[t](e)}catch(s){}}return!0}},\"5c3a\":function(t,e,a){(function(t,e){e(a(\"c1df\"))})(0,function(t){\"use strict\";var e=t.defineLocale(\"zh-cn\",{months:\"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月\".split(\"_\"),monthsShort:\"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月\".split(\"_\"),weekdays:\"星期日_星期一_星期二_星期三_星期四_星期五_星期六\".split(\"_\"),weekdaysShort:\"周日_周一_周二_周三_周四_周五_周六\".split(\"_\"),weekdaysMin:\"日_一_二_三_四_五_六\".split(\"_\"),longDateFormat:{LT:\"HH:mm\",LTS:\"HH:mm:ss\",L:\"YYYY/MM/DD\",LL:\"YYYY年M月D日\",LLL:\"YYYY年M月D日Ah点mm分\",LLLL:\"YYYY年M月D日ddddAh点mm分\",l:\"YYYY/M/D\",ll:\"YYYY年M月D日\",lll:\"YYYY年M月D日 HH:mm\",llll:\"YYYY年M月D日dddd HH:mm\"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(t,e){return 12===t&&(t=0),\"凌晨\"===e||\"早上\"===e||\"上午\"===e?t:\"下午\"===e||\"晚上\"===e?t+12:t>=11?t:t+12},meridiem:function(t,e,a){var r=100*t+e;return r<600?\"凌晨\":r<900?\"早上\":r<1130?\"上午\":r<1230?\"中午\":r<1800?\"下午\":\"晚上\"},calendar:{sameDay:\"[今天]LT\",nextDay:\"[明天]LT\",nextWeek:\"[下]ddddLT\",lastDay:\"[昨天]LT\",lastWeek:\"[上]ddddLT\",sameElse:\"L\"},dayOfMonthOrdinalParse:/\\d{1,2}(日|月|周)/,ordinal:function(t,e){switch(e){case\"d\":case\"D\":case\"DDD\":return t+\"日\";case\"M\":return t+\"月\";case\"w\":case\"W\":return t+\"周\";default:return t}},relativeTime:{future:\"%s内\",past:\"%s前\",s:\"几秒\",ss:\"%d 秒\",m:\"1 分钟\",mm:\"%d 分钟\",h:\"1 小时\",hh:\"%d 小时\",d:\"1 天\",dd:\"%d 天\",M:\"1 个月\",MM:\"%d 个月\",y:\"1 年\",yy:\"%d 年\"},week:{dow:1,doy:4}});return e})},\"62ae\":function(t,e,a){\"use strict\";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"list-about\"},[a(\"a-steps\",{attrs:{progressDot:\"\",current:t.current,size:\"small\",status:t.dotStatus}},[a(\"a-step\"),a(\"a-step\"),a(\"a-step\")],1)],1)},s=[],i={props:[\"current\",\"status\"],data:function(){return{stepStatus:this.status}},computed:{dotStatus:function(){var t=\"\";return t=\"REJECTED\"===this.status||\"CANCELLED\"===this.status?\"error\":\"WAITING\"===this.status?\"wait\":\"finish\",t}}},n=i,o=(a(\"0846\"),a(\"2877\")),c=Object(o[\"a\"])(n,r,s,!1,null,null,null);e[\"a\"]=c.exports},6762:function(t,e,a){\"use strict\";var r=a(\"5ca1\"),s=a(\"c366\")(!0);r(r.P,\"Array\",{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),a(\"9c6c\")(\"includes\")},\"7c3b\":function(t,e,a){\"use strict\";var r=a(\"ca99\"),s=a.n(r);s.a},\"99dc\":function(t,e,a){},a7bd:function(t,e,a){\"use strict\";var r=a(\"99dc\"),s=a.n(r);s.a},ca99:function(t,e,a){},d2c8:function(t,e,a){var r=a(\"aae3\"),s=a(\"be13\");t.exports=function(t,e,a){if(r(e))throw TypeError(\"String#\"+a+\" doesn't accept regex!\");return String(s(t))}},d2dd:function(t,e,a){},d3d5:function(t,e,a){},e734:function(t,e,a){\"use strict\";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"a-form\",{attrs:{layout:\"inline\"}},[a(\"a-row\",{staticStyle:{\"margin-bottom\":\"16px\"}},[a(\"a-form-item\",{attrs:{\"label-col\":{span:8},\"wrapper-col\":{span:16},label:\"订单编号\"}},[a(\"a-input\",{staticClass:\"inputWidth\",on:{change:function(e){t.inputChange(e.target.value,\"odOrderNumber\")}},model:{value:t.data.odOrderNumber,callback:function(e){t.$set(t.data,\"odOrderNumber\",e)},expression:\"data.odOrderNumber\"}})],1),a(\"a-form-item\",{attrs:{\"label-col\":{span:8},\"wrapper-col\":{span:16},label:\"产品规格\"}},[a(\"a-select\",{staticClass:\"inputWidth\",attrs:{showSearch:\"\",allowClear:\"\",showArrow:!1,filterOption:!1,defaultActiveFirstOption:!1},on:{search:t.handleSelectChange,change:function(e){return t.inputChange(e,\"spec\")},popupScroll:function(e){return t.currentPageChange(e)}},model:{value:t.data.spec,callback:function(e){t.$set(t.data,\"spec\",e)},expression:\"data.spec\"}},t._l(t.odSpecList,function(e){return a(\"a-select-option\",{key:e},[t._v(t._s(e))])}),1)],1),a(\"a-form-item\",{attrs:{\"label-col\":{span:8},\"wrapper-col\":{span:16},label:\"交期\"}},[a(\"a-range-picker\",{staticClass:\"inputWidth\",attrs:{format:\"YYYY-MM-DD\"},on:{change:function(e,a){return t.inputChange(a,\"date\")}},model:{value:t.dateArr,callback:function(e){t.dateArr=e},expression:\"dateArr\"}})],1)],1)],1)},s=[],i=(a(\"365c\"),a(\"c1df\")),n=a.n(i),o=(a(\"5c3a\"),a(\"75cd\"));n.a.locale(\"zh-cn\");var c={props:{typeInput:{type:String,default:\"\",required:!0}},mixins:[o[\"c\"],o[\"b\"]],data:function(){return{dateArr:[],timer:\"\",data:{},companyType:localStorage.getItem(\"companyType\")}},created:function(){this.getSpec()},methods:{inputChange:function(t,e){var a=this;\"date\"===e?(this.data.startTime=t[0],this.data.endTime=t[1]):this.data[e]=t,\"\"!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){a.$emit(\"dataChange\",a.data)},500)},searchReset:function(){this.data.odOrderNumber=\"\",this.data.spec=\"\",this.dateArr=[],this.data.endTime=\"\",this.data.startTime=\"\",this.$emit(\"dataChange\",this.data)},currentPageChange:function(t){var e=this.getCurrentPageChange(t);e&&this.getSpec(this.specCurrentPage)},handleSelectChange:function(t){var e=this;\"\"!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){e.searchConditions(t)},500)},searchConditions:function(t){this.odSpecList=[],this.odSpecListValue=t,this.getSpec()},getSpec:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;\"distributors\"===this.typeInput?this.getListCompanySpringSpecs(t):\"factory\"===this.typeInput?this.getFactoryPolicyOrderSpec(t):\"procurement\"===this.typeInput&&this.getFactoryMaterialRequireSpec(t)}}},l=c,d=(a(\"a7bd\"),a(\"2877\")),u=Object(d[\"a\"])(l,r,s,!1,null,\"04e45e62\",null);e[\"a\"]=u.exports},ed7f:function(t,e,a){\"use strict\";var r=a(\"d3d5\"),s=a.n(r);s.a}}]);","extractedComments":[]}