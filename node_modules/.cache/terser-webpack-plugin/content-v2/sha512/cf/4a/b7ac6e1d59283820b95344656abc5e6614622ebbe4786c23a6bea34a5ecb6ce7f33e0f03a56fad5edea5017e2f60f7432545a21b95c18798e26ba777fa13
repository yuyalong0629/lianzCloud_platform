{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-2616fffb\"],{\"06db\":function(e,a,t){\"use strict\";var o=t(\"23c6\"),n={};n[t(\"2b4c\")(\"toStringTag\")]=\"z\",n+\"\"!=\"[object z]\"&&t(\"2aba\")(Object.prototype,\"toString\",function(){return\"[object \"+o(this)+\"]\"},!0)},\"766e\":function(e,a,t){},\"7f7f\":function(e,a,t){var o=t(\"86cc\").f,n=Function.prototype,s=/^\\s*function ([^ (]*)/,r=\"name\";r in n||t(\"9e1e\")&&o(n,r,{configurable:!0,get:function(){try{return(\"\"+this).match(s)[1]}catch(e){return\"\"}}})},ac2a:function(e,a,t){\"use strict\";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t(\"div\",{staticClass:\"login\"},[t(\"div\",{staticClass:\"bg-color\"}),e.key?e._e():t(\"div\",{staticClass:\"login-wrapper\",staticStyle:{border:\"1px solid #F5F5F5\",\"box-shadow\":\"#666 0px 0px 10px\",background:\"#FFF\",padding:\"20px\",\"border-radius\":\"4px\"}},[t(\"div\",{staticClass:\"pwdLogin\"},[t(\"a-divider\",[e._v(\"密码登录\")]),t(\"a-form\",{staticClass:\"login-form\",attrs:{id:\"components-form-demo-normal-login\",form:e.loginInfo},on:{submit:e.handleSubmit}},[t(\"a-form-item\",[t(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"userName\",{rules:[{required:!0,pattern:/^1[34578]\\d{9}$/,message:\"请输入正确的手机号！\"}],validateTrigger:\"blur\"}],expression:\"[\\n        'userName',\\n        { rules: [{ required: true, pattern: /^1[34578]\\\\d{9}$/, message: '请输入正确的手机号！' }], validateTrigger: 'blur' }\\n      ]\"}],attrs:{placeholder:\"请输入手机号\"}},[t(\"a-icon\",{staticStyle:{color:\"rgba(0,0,0,.25)\"},attrs:{slot:\"prefix\",type:\"user\"},slot:\"prefix\"})],1)],1),t(\"a-form-item\",[t(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:[\"password\",{rules:[{required:!0,pattern:/^[\\w]{6,18}$/,message:\"请输入6~18位密码！\"}],validateTrigger:\"blur\"}],expression:\"[\\n        'password',\\n        { rules: [{ required: true, pattern: /^[\\\\w]{6,18}$/, message: '请输入6~18位密码！' }], validateTrigger: 'blur' }\\n      ]\"}],attrs:{type:\"password\",placeholder:\"请输入密码\"}},[t(\"a-icon\",{staticStyle:{color:\"rgba(0,0,0,.25)\"},attrs:{slot:\"prefix\",type:\"lock\"},slot:\"prefix\"})],1)],1),t(\"a-form-item\",[t(\"a-checkbox\",{attrs:{checked:e.remenberMe},on:{change:e.onRemenberMe}},[e._v(\"记住密码\")]),t(\"router-link\",{staticClass:\"login-form-forgot\",attrs:{to:\"/user/retrieve\"}},[e._v(\"忘记密码\")]),t(\"a-button\",{staticClass:\"login-form-button\",attrs:{type:\"primary\",\"html-type\":\"submit\",loading:e.loginBtn}},[e._v(\"登录\")]),t(\"router-link\",{attrs:{to:\"/user/register\"}},[e._v(\"跳转注册\")])],1)],1)],1)]),t(\"a-modal\",{attrs:{title:\"选择公司\",visible:e.visible,footer:null},on:{cancel:e.handleCancel}},[t(\"a-card\",e._l(this.selectCompanyData,function(a,o){return t(\"a-card-grid\",{key:o,staticClass:\"selectCompany\",staticStyle:{width:\"25%\",textAlign:\"'center'\"},on:{click:function(t){return e.selectCompanyOk(o,a)}}},[t(\"h3\",[e._v(e._s(a.companyName))]),t(\"img\",{attrs:{src:a.companyLogo,alt:a.companyName}})])}),1)],1)],1)},n=[],s=(t(\"7f7f\"),t(\"06db\"),t(\"f499\")),r=t.n(s),i=t(\"0d5e\"),c=t(\"365c\"),l=t(\"5118\"),m={name:\"Login\",data:function(){return{remenberMe:!1,visible:!1,selectCompanyData:\"\",loginBtn:!1,key:\"\"}},beforeCreate:function(){this.loginInfo=this.$form.createForm(this)},created:function(){var e=this.$route.query.key;this.key=e,e&&this.loginByAuthKey(e)},mounted:function(){},methods:{onRemenberMe:function(e){this.remenberMe=e.target.checked;var a=this.loginInfo.getFieldsValue([\"userName\",\"password\"]);this.remenberMe&&(console.log(a),localStorage.setItem(\"remenberLoginInfo\",r()(a)))},setRemenberLoginInfo:function(){var e=localStorage.getItem(\"remenberLoginInfo\");console.log(e),this.loginInfo.setFieldsValue({userName:e.userName,password:e.password})},handleSubmit:function(e){var a=this;e.preventDefault(),this.loginInfo.validateFields(function(e,t){if(a.loginBtn=!0,e)a.loginBtn=!1;else{var o={phone:t.userName,pwd:t.password};Object(i[\"d\"])(c[\"a\"].login,o).then(function(e){return 0===e.data.code&&0!==e.data.data.companys.length?(localStorage.setItem(\"NICK\",e.data.data.user.name),localStorage.setItem(\"ACCESS_TOKEN\",e.data.data[\"AUTH-TOKEN\"]),e.data.data.companys.length>1?(a.success(),a.selectCompanyData=e.data.data.companys,!1):(localStorage.setItem(\"userId\",e.data.data.user.id),localStorage.setItem(\"companyName\",e.data.data.companys[0].companyName),localStorage.setItem(\"companyType\",e.data.data.companys[0].companyType),localStorage.setItem(\"companyId\",e.data.data.companys[0].companyId+\"\"),Object(l[\"setTimeout\"])(function(){a.$message.success(\"登录成功\",1),a.$router.push(\"/permission\")},600),!1)):0!==e.data.code?(a.$message.error(e.data.msg,1.5),void(a.loginBtn=!1)):0===e.data.data.companys.length?(a.$message.error(\"请认证之后登陆管理控制台\",1),void(a.loginBtn=!1)):(a.$message.error(e.data.msg,1.5),void(a.loginBtn=!1))}).catch(function(e){console.log(e),a.loginBtn=!1}).finally(function(){})}})},handleCancel:function(){this.visible=!1},success:function(){var e=this;this.$message.success(\"登录成功\",1).then(function(){e.visible=!0})},selectCompanyOk:function(e,a){localStorage.setItem(\"companyId\",this.selectCompanyData[e].companyId+\"\"),localStorage.setItem(\"companyType\",this.selectCompanyData[e].companyType),localStorage.setItem(\"companyName\",this.selectCompanyData[e].companyName),this.visible=!1,this.$message.loading(\"欢迎回来\",1.5),this.$router.push(\"/permission\")},loginByAuthKey:function(e){var a=this;Object(i[\"d\"])(c[\"a\"].loginByAuthKey,{key:e}).then(function(e){if(0===e.data.code)if(0!==e.data.data.companys.length){if(localStorage.setItem(\"NICK\",e.data.data.user.name),localStorage.setItem(\"ACCESS_TOKEN\",e.data.data[\"AUTH-TOKEN\"]),e.data.data.companys.length>1)return a.success(),a.selectCompanyData=e.data.data.companys,!1;localStorage.setItem(\"userId\",e.data.data.user.id),localStorage.setItem(\"companyName\",e.data.data.companys[0].companyName),console.log(e.data.data.companys[0].companyId),localStorage.setItem(\"companyId\",e.data.data.companys[0].companyId+\"\"),a.$message.success(\"登录成功\",1),a.$router.push(\"/permission\")}else 0===e.data.data.companys.length&&a.$message.error(\"归属公司认证中\",1.5);else a.$message.error(e.data.msg,1.5)})}}},d=m,u=(t(\"f9ea\"),t(\"2877\")),p=Object(u[\"a\"])(d,o,n,!1,null,\"87574588\",null);a[\"default\"]=p.exports},f9ea:function(e,a,t){\"use strict\";var o=t(\"766e\"),n=t.n(o);n.a}}]);","extractedComments":[]}