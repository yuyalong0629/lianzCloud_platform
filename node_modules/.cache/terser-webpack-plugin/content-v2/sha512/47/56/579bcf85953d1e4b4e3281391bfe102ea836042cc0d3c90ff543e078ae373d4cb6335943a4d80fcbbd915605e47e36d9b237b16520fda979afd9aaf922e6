{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-253ce12c\"],{\"487a\":function(t,e,i){(function(e,i){t.exports=i()})(0,function(){\"use strict\";var t=\"@@InfiniteScroll\",e=function(t,e){var i,n,a,s,r,o=function(){t.apply(s,r),n=i};return function(){if(s=this,r=arguments,i=Date.now(),a&&(clearTimeout(a),a=null),n){var t=e-(i-n);t<0?o():a=setTimeout(function(){o()},t)}else o()}},i=function(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop},n=document.defaultView.getComputedStyle,a=function(t){var e=t;while(e&&\"HTML\"!==e.tagName&&\"BODY\"!==e.tagName&&1===e.nodeType){var i=n(e).overflowY;if(\"scroll\"===i||\"auto\"===i)return e;e=e.parentNode}return window},s=function(t){return t===window?document.documentElement.clientHeight:t.clientHeight},r=function(t){return t===window?i(window):t.getBoundingClientRect().top+i(window)},o=function(t){var e=t.parentNode;while(e){if(\"HTML\"===e.tagName)return!0;if(11===e.nodeType)return!1;e=e.parentNode}return!1},c=function(){if(!this.binded){this.binded=!0;var t=this,i=t.el,n=i.getAttribute(\"infinite-scroll-throttle-delay\"),s=200;n&&(s=Number(t.vm[n]||n),(isNaN(s)||s<0)&&(s=200)),t.throttleDelay=s,t.scrollEventTarget=a(i),t.scrollListener=e(l.bind(t),t.throttleDelay),t.scrollEventTarget.addEventListener(\"scroll\",t.scrollListener),this.vm.$on(\"hook:beforeDestroy\",function(){t.scrollEventTarget.removeEventListener(\"scroll\",t.scrollListener)});var r=i.getAttribute(\"infinite-scroll-disabled\"),o=!1;r&&(this.vm.$watch(r,function(e){t.disabled=e,!e&&t.immediateCheck&&l.call(t)}),o=Boolean(t.vm[r])),t.disabled=o;var c=i.getAttribute(\"infinite-scroll-distance\"),u=0;c&&(u=Number(t.vm[c]||c),isNaN(u)&&(u=0)),t.distance=u;var d=i.getAttribute(\"infinite-scroll-immediate-check\"),m=!0;d&&(m=Boolean(t.vm[d])),t.immediateCheck=m,m&&l.call(t);var p=i.getAttribute(\"infinite-scroll-listen-for-event\");p&&t.vm.$on(p,function(){l.call(t)})}},l=function(t){var e=this.scrollEventTarget,n=this.el,a=this.distance;if(!0===t||!this.disabled){var o=i(e),c=o+s(e),l=!1;if(e===n)l=e.scrollHeight-c<=a;else{var u=r(n)-r(e)+n.offsetHeight+o;l=c+a>=u}l&&this.expression&&this.expression()}},u={bind:function(e,i,n){e[t]={el:e,vm:n.context,expression:i.value};var a=arguments;e[t].vm.$on(\"hook:mounted\",function(){e[t].vm.$nextTick(function(){o(e)&&c.call(e[t],a),e[t].bindTryCount=0;var i=function i(){e[t].bindTryCount>10||(e[t].bindTryCount++,o(e)?c.call(e[t],a):setTimeout(i,50))};i()})})},unbind:function(e){e&&e[t]&&e[t].scrollEventTarget&&e[t].scrollEventTarget.removeEventListener(\"scroll\",e[t].scrollListener)}},d=function(t){t.directive(\"InfiniteScroll\",u)};return window.Vue&&(window.infiniteScroll=u,Vue.use(d)),u.install=d,u})},\"5b07\":function(t,e,i){\"use strict\";var n=i(\"a858\"),a=i.n(n);a.a},\"9d7b\":function(t,e,i){\"use strict\";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i(\"div\",{staticClass:\"dispatch\"},[i(\"a-row\",[i(\"a-col\",{staticClass:\"dispatch-left\",attrs:{span:12}},[i(\"a-row\",{staticClass:\"search\",attrs:{span:24}},[i(\"a-form\",{attrs:{layout:\"inline\"}},[i(\"a-form-item\",{attrs:{label:\"规格\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[i(\"a-select\",{staticClass:\"inputWidth\",attrs:{showSearch:\"\",allowClear:\"\",showArrow:!1,filterOption:!1,defaultActiveFirstOption:!1},on:{search:function(e){return t.handleSelectChange(e,\"spec\")},change:function(e){t.inputChange(e,\"spec\")},popupScroll:function(e){return t.currentPageChange(e,\"spec\")}}},t._l(t.odSpecList,function(e){return i(\"a-select-option\",{key:e},[t._v(t._s(e))])}),1)],1),i(\"a-form-item\",{attrs:{label:\"材质\",\"label-col\":t.labelCol,\"wrapper-col\":t.wrapperCol}},[i(\"a-select\",{staticClass:\"inputWidth\",attrs:{showSearch:\"\",allowClear:\"\",showArrow:!1,filterOption:!1,defaultActiveFirstOption:!1,getPopupContainer:function(t){return t.parentNode}},on:{search:function(e){return t.handleSelectChange(e,\"cz\")},change:function(e){t.inputChange(e,\"cz\")},popupScroll:function(e){return t.currentPageChange(e,\"cz\")}}},t._l(t.textures,function(e){return i(\"a-select-option\",{key:e},[t._v(t._s(e))])}),1)],1)],1)],1),i(\"a-row\",{staticClass:\"order-list\",attrs:{span:24}},[i(\"div\",{directives:[{name:\"infinite-scroll\",rawName:\"v-infinite-scroll\",value:t.handleInfiniteOnLoad,expression:\"handleInfiniteOnLoad\"}],staticClass:\"order-list-item demo-infinite-container\",attrs:{\"infinite-scroll-disabled\":t.busy,\"infinite-scroll-distance\":10}},[i(\"a-list\",{attrs:{dataSource:t.dataCompany},scopedSlots:t._u([{key:\"renderItem\",fn:function(e,n){return i(\"a-list-item\",{},[i(\"div\",{staticClass:\"list-item\",class:-1!==t.selectIndex.indexOf(n)?\"active\":\"\",on:{click:function(i){return t.addCompany(e.id,n)}}},[i(\"div\",{staticClass:\"item-left\"},[i(\"div\",{staticClass:\"item-left-top\"},[i(\"a\",{attrs:{href:\"javascript:;\"}},[t._v(t._s(e.name))]),i(\"span\",[t._v(t._s(e.odOrderNumber))])]),i(\"ul\",{staticClass:\"item-left-desc\"},[i(\"li\",[t._v(t._s(e.spec))]),i(\"li\",[t._v(t._s(e.cz))]),i(\"li\",[t._v(t._s(e.bmcl))]),i(\"li\",[t._v(t._s(e.odNumber))])])]),i(\"div\",{staticClass:\"item-right\"},[i(\"a-popover\",{attrs:{trigger:\"click\"},model:{value:e.clickedVisible,callback:function(i){t.$set(e,\"clickedVisible\",i)},expression:\"item.clickedVisible\"}},[i(\"template\",{slot:\"content\"},[i(\"a-form-item\",{attrs:{label:\"紧急程度\",\"label-col\":{span:12},\"wrapper-col\":{span:12}}},[i(\"a-switch\",{model:{value:t.requireLevel,callback:function(e){t.requireLevel=e},expression:\"requireLevel\"}})],1),i(\"a-form-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.getMenuPermission.includes(\"DELETE\"),expression:\"getMenuPermission.includes('DELETE')\"}],staticClass:\"mb\"},[i(\"a-button\",{attrs:{type:\"danger\"},on:{click:function(i){return t.removeItem(n,e.id)}}},[t._v(\"移除\")])],1)],1),i(\"a-icon\",{staticClass:\"item-right-edit\",attrs:{type:\"ellipsis\"},on:{click:function(e){return t.updataDes(e,n)}}})],2),i(\"a-button\",{attrs:{type:\"primary\",shape:\"circle\",icon:\"plus\"}})],1)])])}}])},[t.loadingCompony&&!t.busy?i(\"div\",{staticClass:\"demo-loading-container\"},[i(\"a-spin\")],1):t._e()])],1)])],1),i(\"a-col\",{staticClass:\"dispatch-right procurement\",attrs:{span:12}},[i(\"div\",{staticClass:\"title\"}),i(\"div\",{staticClass:\"order-list demo-infinite-container\"},[i(\"a-list\",{attrs:{dataSource:t.companyList},scopedSlots:t._u([{key:\"renderItem\",fn:function(e){return i(\"a-list-item\",{},[i(\"div\",{staticClass:\"list-item\"},[i(\"div\",{staticClass:\"item-left\"},[i(\"div\",{staticClass:\"item-left-top\"},[i(\"a\",{attrs:{href:\"javascript:;\"}},[t._v(t._s(e.channelName))]),i(\"span\",[t._v(t._s(e.relateOrderCode))])]),i(\"ul\",{staticClass:\"item-left-desc\"},[i(\"li\",[t._v(t._s(e.relateCustName))]),i(\"li\",[t._v(t._s(e.num))])])]),i(\"div\",{staticClass:\"item-right\"},[i(\"a-input-number\",{attrs:{min:0,max:e.num},model:{value:e.putNum,callback:function(i){t.$set(e,\"putNum\",i)},expression:\"item.putNum\"}})],1)])])}}])}),i(\"div\",{staticStyle:{height:\"40px\"}}),i(\"div\",{staticClass:\"dispatch-right-bottom\"},[i(\"a-button\",{on:{click:t.cancelSubmit}},[t._v(\"取消\")]),i(\"a-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.getMenuPermission.includes(\"ADD\"),expression:\"getMenuPermission.includes('ADD')\"}],attrs:{type:\"primary\",loading:t.submitLoading},on:{click:t.submit}},[t._v(\"入库\")])],1)],1)])],1)],1)},a=[],s=(i(\"c5f6\"),i(\"487a\")),r=i.n(s),o=i(\"0d5e\"),c=i(\"365c\"),l=i(\"cd34\"),u=i(\"75cd\"),d={directives:{infiniteScroll:r.a},mixins:[l[\"a\"],u[\"b\"],u[\"c\"]],data:function(){return{busy:!1,loadingCompony:!1,dataCompanySize:0,dataCompany:[],currentPage:1,pageSize:15,factoryOrderDetailPostBean:{cz:\"\",spec:\"\"},companyList:[],submitLoading:!1,timer:\"\",selectIndex:[],requireLevel:!1}},created:function(){this.getFactoryPolicyOrderCz(this.specCurrentPage),this.getFactoryPolicyOrderSpec(this.czCurrentPage)},computed:{getMenuPermission:function(){return this.$store.state.menuPermission}},methods:{inputChange:function(t,e){var i=this;this.dataCompany=[];var n=this.factoryOrderDetailPostBean;n.currentPage=1,n[e]=t,\"\"!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){i.getFactoryOrder()},500)},handleInfiniteOnLoad:function(){var t=this.dataCompany;this.loadingCompony=!0,t.length>=this.dataCompanySize&&0!==this.dataCompanySize?(this.$message.warning(\"暂时没有更多数据\"),this.busy=!0,this.loadingCompony=!1):(this.getFactoryOrder(this.currentPage),this.loadingCompony=!1)},removeItem:function(t,e){var i=this;this.$confirm({title:\"移除入库信息\",content:\"您确定要移除这条入库吗?\",zIndex:99999,onOk:function(){Object(o[\"e\"])(c[\"a\"].delWarehousing,{id:e}).then(function(e){0===e.data.code?(i.$message.success(\"移除成功\"),i.dataCompany.splice(t,1),i.dataCompanySize--):i.$message.error(e.data.msg)})},onCancel:function(){}})},addCompany:function(t,e){var i=this,n=this.selectIndex;if(0===n.length)n.push(e);else{if(-1!==n.indexOf(e))return!1;n.push(e)}Object(o[\"e\"])(c[\"a\"].getWarehousingOrderSale,{id:t}).then(function(e){if(0===e.data.code){var n=e.data.data;n.forEach(function(e){console.log(n),e.parentId=t,e.putNum=e.num}),i.companyList=i.companyList.concat(n)}})},getFactoryOrder:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=this.factoryOrderDetailPostBean;n.currentPage=e,n.pageSize=i,Object(o[\"e\"])(c[\"a\"].putWarehousing,n).then(function(e){if(0===e.data.code){var i=e.data.data.records;t.dataCompanySize=Number(e.data.data.total),i.length&&(i.forEach(function(t){t.clickedVisible=!1}),t.dataCompany=t.dataCompany.concat(i))}t.currentPage+=1})},updataDes:function(t,e){window.event?window.event.cancelBubble=!0:t.stopPropagation(),this.dataCompany[e].clickedVisible=!0},submit:function(){var t=this,e={};e.list=this.dataSplic(),e.requireLevel=this.requireLevel?\"LEVEL1\":\"LEVEL0\",0!==e.list.length&&(this.submitLoading=!0,Object(o[\"e\"])(c[\"a\"].applyWarehousing,e).then(function(e){0===e.data.code?(t.$message.success(\"入库成功\"),t.companyList=[],t.dataCompany=[],t.selectIndex=[],t.getFactoryOrder()):t.$message.error(e.data.msg),t.submitLoading=!1}).catch(function(){t.$message.error(\"系统错误\"),t.submitLoading=!1}))},dataSplic:function(){var t=this.companyList,e=[];return t.forEach(function(t){if(0!==t.putNum){var i=e.filter(function(e){return e.id===t.parentId});0===i.length?e.push({id:t.parentId,list:[{id:t.id,number:t.putNum}],number:t.putNum}):e.forEach(function(e){e.id===t.parentId&&(e.list.push({id:t.id,number:t.putNum}),e.number+=t.putNum)})}}),e},currentPageChange:function(t,e){var i=this.getCurrentPageChange(t);i&&(\"cz\"===e?this.getFactoryPolicyOrderCz(this.czCurrentPage):\"spec\"===e&&this.getFactoryPolicyOrderSpec(this.specCurrentPage))},handleSelectChange:function(t,e){var i=this;\"\"!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){\"cz\"===e?(i.textures=[],i.texturesValue=t,i.getFactoryPolicyOrderCz()):(i.odSpecList=[],i.odSpecListValue=t,i.getFactoryPolicyOrderSpec())},500)},cancelSubmit:function(){this.companyList=[],this.selectIndex=[]}}},m=d,p=(i(\"5b07\"),i(\"2877\")),h=Object(p[\"a\"])(m,n,a,!1,null,\"d1a85ca0\",null);e[\"default\"]=h.exports},a858:function(t,e,i){}}]);","extractedComments":[]}