{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/bom/bom_list/Material.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/bom/bom_list/Material.vue","mtime":1565252860537},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Goodsinfo from './child_info/GoodsInfo'\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin'\nimport { columns, springType } from './basic_lib/column'\nimport {\n  searchGoods,\n  custNamefetch,\n  bomNamefetch,\n  bomCodefetch,\n  getViewInfo,\n  bomDelete\n} from './basic_lib/index'\n\nexport default {\n  name: 'Goods',\n  mixins: [mixinBasic, mixinDrawer],\n  data() {\n    return {\n      data: [],\n      columns,\n      springType,\n      selectedRowKeys: [], // 删除勾选项\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showTotal: total => `共${total}条`,\n        showQuickJumper: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      // 客户名称模糊搜素\n      searchData: [],\n      searchValue: undefined,\n      // 产品编码下拉选中\n      selectCodeData: [],\n      selectCodeValue: undefined,\n      scrollPositionCode: 1,\n      // 产品名称下拉选中\n      selectData: [],\n      selectValue: undefined,\n      scrollPositionPro: 1,\n      // 弹簧种类\n      springValue: undefined,\n      // 详情INFO\n      goodsViewInfo: {}\n    }\n  },\n  created() {\n    searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n    // listCompanyGoodsName.call(this, 1) // 列表商家所有商品的商品名称\n    // listCompanyGoodsCode.call(this, 1) // 列表商家所有商品的商品编码\n  },\n  methods: {\n    // 查看详情\n    onHandleInfo(record) {\n      // console.log(record)\n      getViewInfo.call(this, record.id).then(() => {\n        this.visible = true\n      })\n      this.$store.commit('setPromptTitle', {\n        title: '产品信息详情',\n        isEdit: true\n      })\n    },\n    // 新建\n    showDrawer() {\n      this.visible = true\n      this.goodsViewInfo = {}\n      this.$store.commit('setPromptTitle', {\n        title: '新建产品信息',\n        isEdit: false\n      })\n    },\n    // $emit改变isvisible\n    isDrawer(val) {\n      this.visible = val\n      // 关闭抽屉主动初始化\n      this.timer = setTimeout(() => {\n        this.rest().then(() => {\n          searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n        })\n      }, 100)\n    },\n    // rest\n    async rest() {\n      this.selectValue = undefined\n      this.selectCodeValue = undefined\n    },\n    // 删除\n    processDelete() {\n      const that = this\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk() {\n            const params = that.selectedRowKeys.join('&skuIds=')\n            bomDelete.call(that, params).then(() => {\n              that.rest().then(() => {\n                searchGoods.call(that, {})\n                that.selectedRowKeys = []\n              })\n            })\n          },\n          onCancel() {\n            console.log('Cancel')\n          },\n          class: 'test'\n        })\n      }\n    },\n    // 分页\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      searchGoods.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize,\n        skuCode: this.selectCodeValue,\n        keywords: this.selectValue,\n        springType: this.springValue\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 产品编码\n    handleChangeCode(value) {\n      console.log(value)\n      this.selectCodeValue = value\n      searchGoods.call(this, { skuCode: value })\n    },\n    handleSearchCode(value) {\n      bomCodefetch.call(this, value, data => (this.selectCodeData = data))\n    },\n    // 产品名称\n    handleChangeCodeName(value) {\n      this.selectValue = value\n      searchGoods.call(this, { keywords: [value || ''] })\n    },\n    // scroll\n    handleScrollCodeName(value) {\n      bomNamefetch.call(this, value, data => (this.selectData = data))\n    },\n    // 点击客户列表更新Tab详情\n    custId(val) {\n      searchGoods.call(this, { custId: val })\n    },\n    // Tab 删除\n    onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys)\n      this.selectedRowKeys = selectedRowKeys\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getMenuPermission() {\n      return this.$store.state.menuPermission\n    }\n  },\n  components: {\n    'goods-info': Goodsinfo\n  }\n}\n",{"version":3,"sources":["Material.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Material.vue","sourceRoot":"src/views/product/bom/bom_list","sourcesContent":["<template>\n  <div class=\"goods\">\n    <a-row>\n      <!-- 编辑 -->\n      <div class=\"process-setup\">\n        <a-button\n          type=\"primary\"\n          @click=\"showDrawer\"\n          v-show=\"this.getMenuPermission.includes('ADD')\"\n        >\n          <a-icon type=\"plus\" />新建\n        </a-button>\n        <span\n          class=\"delete-btn\"\n          @click=\"processDelete\"\n          v-show=\"this.getMenuPermission.includes('DELETES')\"\n        >\n          <a-icon class=\"delete-icon\" type=\"delete\" />\n          <span>删除</span>\n        </span>\n        <a-dropdown>\n          <span class=\"derive-btn\">\n            <a-icon class=\"derive-icon\" type=\"check-circle\" />\n            <span>更多</span>\n          </span>\n          <a-menu slot=\"overlay\">\n            <a-menu-item key=\"0\" v-show=\"this.getMenuPermission.includes('IMPORT')\">\n              <span>导入</span>\n            </a-menu-item>\n            <a-menu-item key=\"1\" v-show=\"this.getMenuPermission.includes('EXPORT')\">\n              <span>导出</span>\n            </a-menu-item>\n          </a-menu>\n        </a-dropdown>\n      </div>\n    </a-row>\n    <a-row :gutter=\"20\">\n      <a-col :span=\"24\">\n        <a-row>\n          <a-col :span=\"24\" :style=\"{marginBottom: '16px'}\">\n            <a-form layout=\"inline\">\n              <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"产品编码\">\n                <a-select\n                  showSearch\n                  allowClear\n                  :value=\"selectCodeValue\"\n                  placeholder=\"请输入产品编码\"\n                  style=\"width: 200px\"\n                  :defaultActiveFirstOption=\"false\"\n                  :showArrow=\"false\"\n                  :filterOption=\"false\"\n                  @search=\"handleSearchCode\"\n                  @change=\"handleChangeCode\"\n                  :notFoundContent=\"null\"\n                >\n                  <a-select-option v-for=\"(d, i) in selectCodeData\" :key=\"d\">{{ d }}</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"产品名称\">\n                <a-select\n                  showSearch\n                  allowClear\n                  :value=\"selectValue\"\n                  placeholder=\"请输入产品编码\"\n                  style=\"width: 200px\"\n                  :defaultActiveFirstOption=\"false\"\n                  :showArrow=\"false\"\n                  :filterOption=\"false\"\n                  @search=\"handleScrollCodeName\"\n                  @change=\"handleChangeCodeName\"\n                  :notFoundContent=\"null\"\n                >\n                  <a-select-option v-for=\"(d, i) in selectData\" :key=\"d\">{{ d }}</a-select-option>\n                </a-select>\n                <!-- <a-select\n                  allowClear\n                  :value=\"selectValue\"\n                  placeholder=\"请输入产品名称\"\n                  style=\"width: 200px\"\n                  @change=\"handleChangeCodeName\"\n                  @popupScroll=\"e=>handleScrollCodeName(e)\"\n                >\n                  <a-select-option v-for=\"(d, i) in selectData\" :key=\"d\">{{d}}</a-select-option>\n                </a-select>-->\n              </a-form-item>\n            </a-form>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-table\n              :columns=\"columns\"\n              :dataSource=\"data\"\n              :loading=\"loading\"\n              @change=\"onChangePage\"\n              :pagination=\"pagination\"\n              :rowSelection=\"rowSelection\"\n              :scroll=\"{ y: '66vh' }\"\n            >\n              <template slot=\"code\" slot-scope=\"text, record\">\n                <a @click=\"onHandleInfo(record)\" href=\"javascript:;\">{{ text }}</a>\n              </template>\n              <template slot=\"time\" slot-scope=\"text, record\">\n                <span>{{ text | formatDate }}</span>\n              </template>\n              <template slot=\"status\" slot-scope=\"text\">\n                <a\n                  href=\"javascript\"\n                  :title=\"text\"\n                  class=\"status\"\n                  :class=\"text==='正常'?'grn':'error'\"\n                ></a>\n              </template>\n            </a-table>\n          </a-col>\n        </a-row>\n      </a-col>\n    </a-row>\n    <!-- 抽屉 -->\n    <a-drawer\n      :destroyOnClose=\"true\"\n      placement=\"right\"\n      :closable=\"false\"\n      @close=\"closeDrawer\"\n      :visible=\"visible\"\n      :width=\"1040\"\n      :zIndex=\"100\"\n      :wrapStyle=\"{height: '100%',overflow: 'auto',paddingBottom: '108px'}\"\n    >\n      <goods-info @isDrawer=\"isDrawer\" :goodsViewInfo=\"goodsViewInfo\" />\n    </a-drawer>\n  </div>\n</template>\n<script>\nimport Goodsinfo from './child_info/GoodsInfo'\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin'\nimport { columns, springType } from './basic_lib/column'\nimport {\n  searchGoods,\n  custNamefetch,\n  bomNamefetch,\n  bomCodefetch,\n  getViewInfo,\n  bomDelete\n} from './basic_lib/index'\n\nexport default {\n  name: 'Goods',\n  mixins: [mixinBasic, mixinDrawer],\n  data() {\n    return {\n      data: [],\n      columns,\n      springType,\n      selectedRowKeys: [], // 删除勾选项\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showTotal: total => `共${total}条`,\n        showQuickJumper: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      // 客户名称模糊搜素\n      searchData: [],\n      searchValue: undefined,\n      // 产品编码下拉选中\n      selectCodeData: [],\n      selectCodeValue: undefined,\n      scrollPositionCode: 1,\n      // 产品名称下拉选中\n      selectData: [],\n      selectValue: undefined,\n      scrollPositionPro: 1,\n      // 弹簧种类\n      springValue: undefined,\n      // 详情INFO\n      goodsViewInfo: {}\n    }\n  },\n  created() {\n    searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n    // listCompanyGoodsName.call(this, 1) // 列表商家所有商品的商品名称\n    // listCompanyGoodsCode.call(this, 1) // 列表商家所有商品的商品编码\n  },\n  methods: {\n    // 查看详情\n    onHandleInfo(record) {\n      // console.log(record)\n      getViewInfo.call(this, record.id).then(() => {\n        this.visible = true\n      })\n      this.$store.commit('setPromptTitle', {\n        title: '产品信息详情',\n        isEdit: true\n      })\n    },\n    // 新建\n    showDrawer() {\n      this.visible = true\n      this.goodsViewInfo = {}\n      this.$store.commit('setPromptTitle', {\n        title: '新建产品信息',\n        isEdit: false\n      })\n    },\n    // $emit改变isvisible\n    isDrawer(val) {\n      this.visible = val\n      // 关闭抽屉主动初始化\n      this.timer = setTimeout(() => {\n        this.rest().then(() => {\n          searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n        })\n      }, 100)\n    },\n    // rest\n    async rest() {\n      this.selectValue = undefined\n      this.selectCodeValue = undefined\n    },\n    // 删除\n    processDelete() {\n      const that = this\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk() {\n            const params = that.selectedRowKeys.join('&skuIds=')\n            bomDelete.call(that, params).then(() => {\n              that.rest().then(() => {\n                searchGoods.call(that, {})\n                that.selectedRowKeys = []\n              })\n            })\n          },\n          onCancel() {\n            console.log('Cancel')\n          },\n          class: 'test'\n        })\n      }\n    },\n    // 分页\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      searchGoods.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize,\n        skuCode: this.selectCodeValue,\n        keywords: this.selectValue,\n        springType: this.springValue\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 产品编码\n    handleChangeCode(value) {\n      console.log(value)\n      this.selectCodeValue = value\n      searchGoods.call(this, { skuCode: value })\n    },\n    handleSearchCode(value) {\n      bomCodefetch.call(this, value, data => (this.selectCodeData = data))\n    },\n    // 产品名称\n    handleChangeCodeName(value) {\n      this.selectValue = value\n      searchGoods.call(this, { keywords: [value || ''] })\n    },\n    // scroll\n    handleScrollCodeName(value) {\n      bomNamefetch.call(this, value, data => (this.selectData = data))\n    },\n    // 点击客户列表更新Tab详情\n    custId(val) {\n      searchGoods.call(this, { custId: val })\n    },\n    // Tab 删除\n    onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys)\n      this.selectedRowKeys = selectedRowKeys\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getMenuPermission() {\n      return this.$store.state.menuPermission\n    }\n  },\n  components: {\n    'goods-info': Goodsinfo\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import \"~styles/variable.less\";\n\n.process-setup {\n  margin-bottom: 20px;\n  .delete-btn {\n    margin-left: 20px;\n    cursor: pointer;\n    .delete-icon {\n      .delete();\n    }\n  }\n  .derive-btn {\n    cursor: pointer;\n    .derive-icon {\n      .more();\n      margin-left: 20px;\n    }\n  }\n}\n.status {\n  display: block;\n  width: 12px;\n  height: 12px;\n  border-radius: 6px;\n}\n.grn {\n  background-color: #6bc67b;\n}\n.error {\n  background: #f5222d;\n}\n</style>\n"]}]}