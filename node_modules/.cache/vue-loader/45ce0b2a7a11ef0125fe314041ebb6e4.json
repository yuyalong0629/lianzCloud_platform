{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/GoodsInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/GoodsInfo.vue","mtime":1561431499265},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Bus from '@/Bus.js'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport TabTitle from '../other/TabTitle'\nimport TabMallInfo from './tab_mallInfo/TabMallInfo'\n// 产品信息\nimport ProductInfoForm from './tab_goodsInfo/ProductInfoForm'\nimport ClassAttrForm from './tab_goodsInfo/ClassAttrForm'\nimport ProductUpload from '@/components/upload/Upload'\n// index\nimport { goodsSkuAdd } from '../basic_lib/index'\n\nexport default {\n  name: 'GoodsInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      isLabelColor: false,\n      getClassType: false,\n      classAttrVal: [],\n      // 产品详情data\n      skuData: {},\n      // Pic\n      pics: [],\n      // 客户详情\n      custInfo: {},\n      springInfo: {},\n      // 分类属性\n      attrVals: [],\n      // 产品详情回显\n      skuInfoData: {},\n      classCatObjId: [],\n      // 产品图片回显\n      picInfoData: [],\n      // 分类属性回显\n      classAttrInfoData: [],\n      classCatId: ''\n    }\n  },\n  props: {\n    goodsViewInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created() {\n    // 编辑 || 取消\n    Bus.$on('isDisabled', val => {\n      // Input选中\n      console.log(val)\n      const edit = new Promise(resolved => {\n        this.disabled = !val\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    })\n  },\n  destroyed() {\n    Bus.$off('isDisabled')\n  },\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName(value) {\n      // console.log(value)\n    },\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '添加成功')\n      })\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '更新成功')\n      })\n    },\n    // 删除\n    isDelete(val) {},\n    // 子组件分类属性 $emit\n    classAttrInfo(val) {\n      if (val.length) {\n        this.getClassType = true\n        this.classAttrVal = val\n        return\n      }\n      this.getClassType = false\n    },\n    // 子组件分类属性 接受data $emit\n    classData(val) {\n      // console.log(val)\n      this.attrVals = val\n    },\n    // Upload\n    propsFileList(val) {\n      this.pics = val\n    },\n    // 产品详情子组件接受分类属性ID数组\n    classCatObj(val) {\n      this.classCatObjId = val.id\n    },\n    // FormData\n    async getFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.validateFields((err, values) => {\n        if (!err) {\n          // console.log(values)\n          this.skuData = values\n        }\n      })\n      // 分类属性FormData\n      if (this.$refs.classAttrForm) {\n        this.$refs.classAttrForm.classAttrInfoForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n            }\n          }\n        )\n      }\n      // 弹簧属性FormData\n      if (this.$refs.productAttrForm) {\n        this.$refs.productAttrForm.productAttrForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n              this.springInfo = values\n            }\n          }\n        )\n      }\n    },\n    // Form详情\n    async setFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.setFieldsValue({\n        catId: this.classCatObjId,\n        name: this.skuInfoData.name,\n        drawNum: this.skuInfoData.drawNum,\n        drawVersion: this.skuInfoData.drawVersion,\n        spec: this.skuInfoData.spec,\n        unit: this.skuInfoData.unit,\n        unit: this.skuInfoData.unit,\n        gateway: this.skuInfoData.gateway,\n        standard: this.skuInfoData.standard,\n        weight: this.skuInfoData.weight + '',\n        bmcl: this.skuInfoData.bmcl,\n        remark: this.skuInfoData.remark,\n        price: this.skuInfoData.price\n      })\n    }\n  },\n  watch: {\n    goodsViewInfo: {\n      handler(val) {\n        console.log(val)\n        if (Object.keys(val).length) {\n          // sku\n          this.skuInfoData = val.sku\n          // PIC\n          this.picInfoData = val.pics\n          // 分类属性\n          this.classAttrInfoData = val.attrVals\n          this.classCatId = val.sku.catId\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'tab-title': TabTitle,\n    'tabMall-info': TabMallInfo,\n    'product-info': ProductInfoForm,\n    'class-attr': ClassAttrForm,\n    'product-upload': ProductUpload\n  }\n}\n",{"version":3,"sources":["GoodsInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GoodsInfo.vue","sourceRoot":"src/views/product/bom/bom_list/child_info","sourcesContent":["<template>\n  <div class=\"goods-info\">\n    <tab-title @isDelete=\"isDelete\">\n      <template v-slot:tabGoodsInfo>\n        <!-- 产品信息 -->\n        <a-row>\n          <a-col :span=\"24\">\n            <h3 class=\"categoryInfo-title\">产品详情</h3>\n          </a-col>\n          <a-col :span=\"24\">\n            <product-info\n              ref=\"goodsInfoForm\"\n              @classAttrInfo=\"classAttrInfo\"\n              @classCatObj=\"classCatObj\"\n              :skuInfoData=\"skuInfoData\"\n              :childDisabled=\"disabled\"\n            />\n          </a-col>\n          <a-col :span=\"24\" v-if=\"getClassType || classAttrInfoData.length\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">分类属性</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <class-attr\n                ref=\"classAttrForm\"\n                @classData=\"classData\"\n                :classAttrVal=\"classAttrVal\"\n                :childDisabled=\"disabled\"\n                :classAttrInfoData=\"classAttrInfoData\"\n                :classCatId=\"classCatId\"\n              />\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">产品图片</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <product-upload @propsFileList=\"propsFileList\" :picInfoData=\"picInfoData\"/>\n            </a-col>\n          </a-col>\n        </a-row>\n      </template>\n      <template v-slot:tabMallAttr>\n        <tabMall-info/>\n      </template>\n    </tab-title>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport Bus from '@/Bus.js'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport TabTitle from '../other/TabTitle'\nimport TabMallInfo from './tab_mallInfo/TabMallInfo'\n// 产品信息\nimport ProductInfoForm from './tab_goodsInfo/ProductInfoForm'\nimport ClassAttrForm from './tab_goodsInfo/ClassAttrForm'\nimport ProductUpload from '@/components/upload/Upload'\n// index\nimport { goodsSkuAdd } from '../basic_lib/index'\n\nexport default {\n  name: 'GoodsInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      isLabelColor: false,\n      getClassType: false,\n      classAttrVal: [],\n      // 产品详情data\n      skuData: {},\n      // Pic\n      pics: [],\n      // 客户详情\n      custInfo: {},\n      springInfo: {},\n      // 分类属性\n      attrVals: [],\n      // 产品详情回显\n      skuInfoData: {},\n      classCatObjId: [],\n      // 产品图片回显\n      picInfoData: [],\n      // 分类属性回显\n      classAttrInfoData: [],\n      classCatId: ''\n    }\n  },\n  props: {\n    goodsViewInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created() {\n    // 编辑 || 取消\n    Bus.$on('isDisabled', val => {\n      // Input选中\n      console.log(val)\n      const edit = new Promise(resolved => {\n        this.disabled = !val\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    })\n  },\n  destroyed() {\n    Bus.$off('isDisabled')\n  },\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName(value) {\n      // console.log(value)\n    },\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '添加成功')\n      })\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '更新成功')\n      })\n    },\n    // 删除\n    isDelete(val) {},\n    // 子组件分类属性 $emit\n    classAttrInfo(val) {\n      if (val.length) {\n        this.getClassType = true\n        this.classAttrVal = val\n        return\n      }\n      this.getClassType = false\n    },\n    // 子组件分类属性 接受data $emit\n    classData(val) {\n      // console.log(val)\n      this.attrVals = val\n    },\n    // Upload\n    propsFileList(val) {\n      this.pics = val\n    },\n    // 产品详情子组件接受分类属性ID数组\n    classCatObj(val) {\n      this.classCatObjId = val.id\n    },\n    // FormData\n    async getFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.validateFields((err, values) => {\n        if (!err) {\n          // console.log(values)\n          this.skuData = values\n        }\n      })\n      // 分类属性FormData\n      if (this.$refs.classAttrForm) {\n        this.$refs.classAttrForm.classAttrInfoForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n            }\n          }\n        )\n      }\n      // 弹簧属性FormData\n      if (this.$refs.productAttrForm) {\n        this.$refs.productAttrForm.productAttrForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n              this.springInfo = values\n            }\n          }\n        )\n      }\n    },\n    // Form详情\n    async setFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.setFieldsValue({\n        catId: this.classCatObjId,\n        name: this.skuInfoData.name,\n        drawNum: this.skuInfoData.drawNum,\n        drawVersion: this.skuInfoData.drawVersion,\n        spec: this.skuInfoData.spec,\n        unit: this.skuInfoData.unit,\n        unit: this.skuInfoData.unit,\n        gateway: this.skuInfoData.gateway,\n        standard: this.skuInfoData.standard,\n        weight: this.skuInfoData.weight + '',\n        bmcl: this.skuInfoData.bmcl,\n        remark: this.skuInfoData.remark,\n        price: this.skuInfoData.price\n      })\n    }\n  },\n  watch: {\n    goodsViewInfo: {\n      handler(val) {\n        console.log(val)\n        if (Object.keys(val).length) {\n          // sku\n          this.skuInfoData = val.sku\n          // PIC\n          this.picInfoData = val.pics\n          // 分类属性\n          this.classAttrInfoData = val.attrVals\n          this.classCatId = val.sku.catId\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'tab-title': TabTitle,\n    'tabMall-info': TabMallInfo,\n    'product-info': ProductInfoForm,\n    'class-attr': ClassAttrForm,\n    'product-upload': ProductUpload\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.goods-info {\n  .categoryInfo-title {\n    margin: 15px 0;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>"]}]}