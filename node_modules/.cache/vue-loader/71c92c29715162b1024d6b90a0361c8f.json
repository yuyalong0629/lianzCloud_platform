{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/sale/orderList/basic_lib/EditableCell.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/sale/orderList/basic_lib/EditableCell.vue","mtime":1560327748418},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { get } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport { mixinCurrentPage } from '@/views/sale/mixin/minxinSale'\nimport moment from 'moment'\nexport default {\n  mixins: [mixinCurrentPage],\n  props: {\n    custId: {\n      type: String\n    }\n  },\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      customerGoods: 1, // 列表商家对客户的定制商品基本信息\n      labelCol: { span: 6, offset: 0 },\n      wrapperCol: { span: 16 },\n      sku: {\n        skuId: '',\n        code: '',\n        odSkuName: '',\n        odSpec: '',\n        taxRate: 0,\n        odSkuCustPrice: 0,\n        odAmount: '',\n        odSkuCustCode: '' // 客户产品编码\n      },\n      listCustomerGoods: [] // 商品信息\n    }\n  },\n  created() {\n    this.getListCustomerGoods(this.customerGoods)\n  },\n  methods: {\n    moment,\n    inputChange(val) {\n      const listCustomerGoods = this.listCustomerGoods[val]\n      this.form.resetFields('sku.odNumber')\n      this.sku.odAmount = ''\n      get(api.getSkuPrice + `/${listCustomerGoods.id}/${this.custId}`).then(res => {\n        if (res.data.code === 0) {\n          const data = res.data.data\n          this.sku.odSkuName = data.name\n          this.sku.odSpec = data.spec\n          this.sku.taxRate = data.taxRate\n          this.sku.odSkuCustPrice = data.price\n          this.sku.code = data.code\n          this.sku.odSkuCustCode = data.skuCustInfo ? data.skuCustInfo.custSkuCode : ''\n          this.sku.skuId = data.id\n        }\n      })\n    },\n    inputnumChange(val) {\n      const price = this.sku.odSkuCustPrice\n      let total = 0\n      total = (price * val).toFixed(3)\n      this.sku.odAmount = total\n    },\n    handleEditableInfo(e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          const val = {\n            'odRequireDueDate': values.sku.odRequireDueDate ? values.sku.odRequireDueDate.format('YYYY-MM-DD') : '',\n            'odPromiseDueDate': values.sku.odPromiseDueDate ? values.sku.odPromiseDueDate.format('YYYY-MM-DD') : '',\n            'odAmount': values.sku.odAmount,\n            'odNumber': values.sku.odNumber,\n            'odPurchaseOrderno': values.sku.odPurchaseOrderno\n          }\n          const data = {}\n          const backData = { ...val, ...this.sku }\n          data.isAddContactInfo = false\n          data.sku = backData\n          this.$emit('showAddContactInfo', data)\n          for (const i in this.sku) {\n            this.sku[i] = ''\n          }\n          this.form.resetFields()\n        }\n      })\n    },\n    handleReset() {\n      var data = {}\n      data.isAddContactInfo = false\n      for (const i in this.sku) {\n        this.sku[i] = ''\n      }\n      this.form.resetFields()\n      this.$emit('showAddContactInfo', data)\n    },\n    currentPageChange(e) {\n      const resut = this.getCurrentPageChange(e)\n      if (resut) {\n        this.getListCustomerGoods(this.customerGoods)\n      }\n    },\n    // 列表商家商品基本信息\n    getListCustomerGoods(currentPage = 1, pageSize = 20) {\n      get(api.getListCompanyGoods, { currentPage, pageSize }).then(res => {\n        var listCustomerGoods = res.data.data.records\n        this.listCustomerGoods = this.listCustomerGoods.concat(listCustomerGoods)\n        if (this.customerGoods < Number(res.data.data.pages)) {\n          this.customerGoods += 1\n        }\n      })\n    },\n    odNumberRegx(rule, value, callback) {\n      if (value && value <= 0) {\n        callback('购买数量不能为0')\n      } else {\n        callback()\n      }\n    }\n  }\n}\n",{"version":3,"sources":["EditableCell.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditableCell.vue","sourceRoot":"src/views/sale/orderList/basic_lib","sourcesContent":["<template>\n  <a-form :form=\"form\">\n    <a-form-item label=\"产品编码\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-select\n        style=\"width:280px\"\n        showSearch\n        v-decorator=\"['sku.code',{rules: [{ required: true, message: '请选择产品编码' }],initialValue:sku.code}]\"\n        @change=\"(val)=>{inputChange(val)}\"\n        @popupScroll=\"e=>currentPageChange(e)\"\n        :getPopupContainer=\"triggerNode => triggerNode.parentNode\"\n      >\n        <a-select-option v-for=\"(item,index) in listCustomerGoods\" :key=\"index\">{{item.code}}</a-select-option>\n      </a-select>\n    </a-form-item>\n    <a-form-item label=\"订单数量\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-input\n        style=\"width:280px\"\n        placeholder=\"请输入订单数量\"\n        v-decorator=\"['sku.odNumber',{rules: [{ required: true, message: '请输入订单数量' }, {validator: odNumberRegx}],initialValue:sku.odNumber}]\"\n        @change=\"(e)=>{inputnumChange(e.target.value)}\"\n      />\n    </a-form-item>\n    <a-form-item label=\"订单总计\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-input\n        style=\"width:280px\"\n        v-decorator=\"['sku.odAmount',{initialValue:sku.odAmount}]\"\n        placeholder=\"请输入订单总计\"\n      />\n    </a-form-item>\n    <a-form-item label=\"采购单号：\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-input style=\"width:280px\" v-decorator=\"['sku.odPurchaseOrderno']\" placeholder=\"请输入采购单号\"/>\n    </a-form-item>\n    <a-form-item label=\"要求交期\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-date-picker\n        style=\"width:280px\"\n        placeholder=\"请选择要求交期\"\n        v-decorator=\"['sku.odRequireDueDate']\"\n      />\n    </a-form-item>\n    <a-form-item label=\"承诺交期\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n      <a-date-picker\n        style=\"width:280px\"\n        placeholder=\"请选择承诺交期\"\n        v-decorator=\"['sku.odPromiseDueDate']\"\n      />\n    </a-form-item>\n    <a-form-item :style=\"{ textAlign: 'center' }\">\n      <a-button :style=\"{ marginRight: '8px' }\" @click=\"handleReset\">取消</a-button>\n      <a-button type=\"primary\" @click=\"handleEditableInfo\">确认添加</a-button>\n    </a-form-item>\n  </a-form>\n</template>\n<script>\nimport { get } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport { mixinCurrentPage } from '@/views/sale/mixin/minxinSale'\nimport moment from 'moment'\nexport default {\n  mixins: [mixinCurrentPage],\n  props: {\n    custId: {\n      type: String\n    }\n  },\n  data() {\n    return {\n      form: this.$form.createForm(this),\n      customerGoods: 1, // 列表商家对客户的定制商品基本信息\n      labelCol: { span: 6, offset: 0 },\n      wrapperCol: { span: 16 },\n      sku: {\n        skuId: '',\n        code: '',\n        odSkuName: '',\n        odSpec: '',\n        taxRate: 0,\n        odSkuCustPrice: 0,\n        odAmount: '',\n        odSkuCustCode: '' // 客户产品编码\n      },\n      listCustomerGoods: [] // 商品信息\n    }\n  },\n  created() {\n    this.getListCustomerGoods(this.customerGoods)\n  },\n  methods: {\n    moment,\n    inputChange(val) {\n      const listCustomerGoods = this.listCustomerGoods[val]\n      this.form.resetFields('sku.odNumber')\n      this.sku.odAmount = ''\n      get(api.getSkuPrice + `/${listCustomerGoods.id}/${this.custId}`).then(res => {\n        if (res.data.code === 0) {\n          const data = res.data.data\n          this.sku.odSkuName = data.name\n          this.sku.odSpec = data.spec\n          this.sku.taxRate = data.taxRate\n          this.sku.odSkuCustPrice = data.price\n          this.sku.code = data.code\n          this.sku.odSkuCustCode = data.skuCustInfo ? data.skuCustInfo.custSkuCode : ''\n          this.sku.skuId = data.id\n        }\n      })\n    },\n    inputnumChange(val) {\n      const price = this.sku.odSkuCustPrice\n      let total = 0\n      total = (price * val).toFixed(3)\n      this.sku.odAmount = total\n    },\n    handleEditableInfo(e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          const val = {\n            'odRequireDueDate': values.sku.odRequireDueDate ? values.sku.odRequireDueDate.format('YYYY-MM-DD') : '',\n            'odPromiseDueDate': values.sku.odPromiseDueDate ? values.sku.odPromiseDueDate.format('YYYY-MM-DD') : '',\n            'odAmount': values.sku.odAmount,\n            'odNumber': values.sku.odNumber,\n            'odPurchaseOrderno': values.sku.odPurchaseOrderno\n          }\n          const data = {}\n          const backData = { ...val, ...this.sku }\n          data.isAddContactInfo = false\n          data.sku = backData\n          this.$emit('showAddContactInfo', data)\n          for (const i in this.sku) {\n            this.sku[i] = ''\n          }\n          this.form.resetFields()\n        }\n      })\n    },\n    handleReset() {\n      var data = {}\n      data.isAddContactInfo = false\n      for (const i in this.sku) {\n        this.sku[i] = ''\n      }\n      this.form.resetFields()\n      this.$emit('showAddContactInfo', data)\n    },\n    currentPageChange(e) {\n      const resut = this.getCurrentPageChange(e)\n      if (resut) {\n        this.getListCustomerGoods(this.customerGoods)\n      }\n    },\n    // 列表商家商品基本信息\n    getListCustomerGoods(currentPage = 1, pageSize = 20) {\n      get(api.getListCompanyGoods, { currentPage, pageSize }).then(res => {\n        var listCustomerGoods = res.data.data.records\n        this.listCustomerGoods = this.listCustomerGoods.concat(listCustomerGoods)\n        if (this.customerGoods < Number(res.data.data.pages)) {\n          this.customerGoods += 1\n        }\n      })\n    },\n    odNumberRegx(rule, value, callback) {\n      if (value && value <= 0) {\n        callback('购买数量不能为0')\n      } else {\n        callback()\n      }\n    }\n  }\n}\n</script>\n"]}]}