{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/sale/orderList/child_lib/orderInfo.vue?vue&type=style&index=1&lang=css&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/sale/orderList/child_lib/orderInfo.vue","mtime":1559611564026},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.ant-alert-with-description.ant-alert-no-icon {\n  padding: 8px 15px;\n}\n",{"version":3,"sources":["orderInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8qBA;AACA;AACA","file":"orderInfo.vue","sourceRoot":"src/views/sale/orderList/child_lib","sourcesContent":["<template>\n  <div>\n    <div class=\"add-order-list\">\n      <a-tabs defaultActiveKey=\"1\" @change=\"callback\">\n        <a-tab-pane key=\"0\" disabled>\n          <span slot=\"tab\" style=\"color:#666;font-size:16px;\">订单详情</span>\n        </a-tab-pane>\n        <a-tab-pane tab=\"销售订单信息\" key=\"1\">\n          <a-form layout=\"horizontal\">\n            <a-row :gutter=\"24\">\n              <a-col :span=\"24\">\n                <h3 class=\"addCustomer-title\">订单详情</h3>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"订单编码\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-input class=\"inputWidth\" :value=\"mallOrderIntactDto.oorderNumber\" disabled/>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"客户名称\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-select\n                    :disabled=\"editInfo\"\n                    class=\"inputWidth\"\n                    showSearch\n                    v-model=\"mallOrderIntactDto.ocustName\"\n                    @change=\"(val)=>{inputChange(val,'ocustName')}\"\n                    @popupScroll=\"e=>currentPageChange(e)\"\n                    :getPopupContainer=\"triggerNode => triggerNode.parentNode\"\n                  >\n                    <a-icon slot=\"suffixIcon\" type=\"down\" style=\"display:none\" v-if=\"editInfo\"/>\n                    <a-select-option\n                      v-for=\"(item,index) in listCompanyCusts\"\n                      :key=\"index\"\n                    >{{item.custName}}</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"客户单号\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-input\n                    class=\"inputWidth\"\n                    v-model=\"mallOrderIntactDto.opurchaseOrderno\"\n                    :disabled=\"editInfo && !editDetial\"\n                  />\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"订单类型\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-select\n                    :disabled=\"editInfo\"\n                    v-model=\"mallOrderIntactDto.otype\"\n                    class=\"inputWidth\"\n                    placeholder=\"请选择订单类型\"\n                  >\n                    <a-icon slot=\"suffixIcon\" type=\"down\" style=\"display:none\" v-if=\"editInfo\"/>\n                    <a-select-option value=\"0\">正式</a-select-option>\n                    <a-select-option value=\"1\">样品</a-select-option>\n                    <a-select-option value=\"2\">季度返点</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"总价\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-input\n                    class=\"inputWidth\"\n                    v-model=\"mallOrderIntactDto.ototalSum\"\n                    :disabled=\"editInfo && !editDetial\"\n                  />\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"预收款\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-input\n                    class=\"inputWidth\"\n                    v-model=\"mallOrderIntactDto.oprePayment\"\n                    :disabled=\"editInfo && !editDetial\"\n                  />\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\" v-if=\"editInfo\">\n                <a-form-item label=\"状态\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-select disabled :value=\"mallOrderIntactDto.ostatus\">\n                    <a-icon slot=\"suffixIcon\" type=\"down\" style=\"display:none\"/>\n                    <template v-for=\"(item,index) in orderStatus\">\n                      <a-select-option :value=\"item.value\" :key=\"index\">{{item.label}}</a-select-option>\n                    </template>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item label=\"备注\" :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\">\n                  <a-input\n                    class=\"inputWidth\"\n                    v-model=\"mallOrderIntactDto.oremarks\"\n                    :disabled=\"editInfo && !editDetial\"\n                  />\n                </a-form-item>\n              </a-col>\n            </a-row>\n            <!-- <a-row :gutter=\"24\" style=\"margin-top:20px\">\n              <a-col :span=\"24\">\n                <h3 class=\"addCustomer-title\">订单分配</h3>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item\n                  label=\"计划员：\"\n                  :label-col=\"labelCol\"\n                  :wrapper-col=\"wrapperCol\"\n                >\n                  <a-input class=\"inputWidth\" placeholder=\"请输入订单编号\"/>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item\n                  label=\"工厂厂长：\"\n                  :label-col=\"labelCol\"\n                  :wrapper-col=\"wrapperCol\"\n                >\n                  <a-input class=\"inputWidth\" placeholder=\"请输入净价总价\"/>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item\n                  label=\"生产基地：\"\n                  :label-col=\"labelCol\"\n                  :wrapper-col=\"wrapperCol\"\n                >\n                  <a-cascader\n                    :options=\"areas\"\n                    placeholder=\"请选择生产基地\"\n                    class=\"inputWidth\"\n                    :fieldNames=\"{label:'name',value:'id',children:'childrens'}\"\n                  />\n                </a-form-item>\n              </a-col>\n            </a-row>-->\n          </a-form>\n          <a-row :gutter=\"24\" style=\"margin-top:20px\">\n            <a-col :span=\"24\">\n              <h3 class=\"addCustomer-title\">产品详情</h3>\n            </a-col>\n            <a-table :columns=\"columns\" :dataSource=\"dataSource\" :pagination=\"false\">\n              <template slot=\"name\" slot-scope=\"text,record\">\n                <a\n                  href=\"javascript:;\"\n                  @click=\"getGoodsViews(record.skuId,record.odCustId)\"\n                >{{record.odSkuName}}-{{record.code || record.odSkuCode}}</a>\n              </template>\n              <template\n                v-for=\"col in ['odSkuCustPrice', 'odNumber', 'odAmount','odPurchaseOrderno','odRequireDueDate','odPromiseDueDate']\"\n                :slot=\"col\"\n                slot-scope=\"text, record\"\n              >\n                <div :key=\"col\">\n                  <a-input\n                    v-if=\"record.editable && col!=='odRequireDueDate' && col !== 'odPromiseDueDate'\"\n                    style=\"width:60px;\"\n                    :value=\"text\"\n                    @change=\"e => editCell(e.target.value, record.key, col)\"\n                  />\n                  <a-date-picker\n                    v-else-if=\"record.editable && (col ==='odRequireDueDate' || col === 'odPromiseDueDate')\"\n                    style=\"width:100px;\"\n                    :defaultValue=\"moment(text||new Date())\"\n                    @change=\"(value,dateString) => editCell(dateString, record.key, col)\"\n                  />\n                  <template v-else>\n                    <span\n                      v-if=\"col ==='odRequireDueDate' || col === 'odPromiseDueDate'\"\n                    >{{text?moment(text).format('YYYY-MM-DD'):''}}</span>\n                    <span v-else>{{text}}</span>\n                  </template>\n                </div>\n              </template>\n              <template slot=\"operation\" slot-scope=\"text, record\">\n                <div class=\"editable-row-operations\" v-show=\"!editInfo || editDetial\">\n                  <span v-if=\"record.editable\">\n                    <a @click=\"() => save(record.key)\">\n                      <a-button type=\"primary\" shape=\"circle\" icon=\"edit\" class=\"edit-btn\"></a-button>\n                    </a>\n                    <a-popconfirm title=\"确认删除吗?\" @confirm=\"() => cancel(record.key)\">\n                      <a-button type=\"danger\" shape=\"circle\" icon=\"delete\" class=\"edit-btn\"></a-button>\n                    </a-popconfirm>\n                  </span>\n                  <span v-else>\n                    <a @click=\"() => edit(record.key)\">编辑</a>\n                  </span>\n                </div>\n              </template>\n            </a-table>\n            <span\n              class=\"editable-add-btn\"\n              @click=\"onAddContact\"\n              v-show=\"!editInfo || editDetial\"\n            >+添加产品</span>\n            <a-modal\n              title=\"添加\"\n              cancelText=\"取消\"\n              okText=\"确认添加\"\n              :maskClosable=\"false\"\n              :footer=\"null\"\n              :visible=\"isAddContactInfo\"\n              @ok=\"handleOkContact\"\n              @cancel=\"handleCancelContact\"\n            >\n              <EditableCell\n                @showAddContactInfo=\"showAddContactInfo\"\n                :custId=\"mallOrderIntactDto.custId\"\n              ></EditableCell>\n            </a-modal>\n          </a-row>\n          <a-row :gutter=\"24\" style=\"margin-top:20px;margin-bottom:40px;\">\n            <a-col :span=\"24\">\n              <h3 class=\"addCustomer-title\">收货地址</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <div\n                class=\"address-list\"\n                v-for=\"(item,index) in addressList\"\n                :key=\"item.id\"\n                @click=\"choseAddress(index,item.id)\"\n              >\n                <div class=\"address-list-item\" :class=\"{'item-active':item.defaultGoodsAddr ==1}\">\n                  <div class=\"address-list-item-desc\">\n                    {{mallOrderIntactDto.ocustName}}\n                    <ul>\n                      <li>收件人：{{item.receiver}}</li>\n                      <li>联系方式：{{item.phone}}</li>\n                      <li>地址：{{item.cityStr}}{{item.provinceStr}}{{item.areaStr}}{{item.detailAddr}}</li>\n                    </ul>\n                  </div>\n                </div>\n              </div>\n              <span\n                class=\"editable-add-btn\"\n                style=\"margin:10px;\"\n                @click=\"addAddress\"\n                v-show=\"!editInfo || editDetial\"\n              >+添加地址</span>\n            </a-col>\n          </a-row>\n          <a-row :gutter=\"24\" style=\"margin-top:20px;margin-bottom:40px;\">\n            <a-col :span=\"24\">\n              <h3 class=\"addCustomer-title\">附件</h3>\n              <a-upload\n                :action=\"url\"\n                :data=\"{'bizType': 'ORDER'}\"\n                :headers=\"headers\"\n                listType=\"picture-card\"\n                :fileList=\"fileList\"\n                @preview=\"handlePreview\"\n                @change=\"handleChange\"\n                :disabled=\"editInfo && !editDetial\"\n              >\n                <div>\n                  <a-icon type=\"plus\"/>\n                  <div class=\"ant-upload-text\">Upload</div>\n                </div>\n                <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n                  <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\">\n                </a-modal>\n              </a-upload>\n            </a-col>\n          </a-row>\n        </a-tab-pane>\n        <!-- <a-tab-pane tab=\"生产信息\" key=\"2\" forceRender>生产信息</a-tab-pane>\n        <a-tab-pane tab=\"质检信息\" key=\"3\">质检信息</a-tab-pane>\n        <a-tab-pane tab=\"仓储信息\" key=\"4\">仓储信息</a-tab-pane>\n        <a-tab-pane tab=\"发货信息\" key=\"5\">发货信息</a-tab-pane>-->\n      </a-tabs>\n      <div class=\"edit\" v-if=\"editInfo\">\n        <span @click=\"orderDetialEdit\">{{!editDetial?'编辑':'取消编辑'}}</span>\n        <span @click=\"orderDetele\">删除</span>\n        <!-- <a-button>打印</a-button> -->\n        <!-- <a-button>更多</a-button> -->\n      </div>\n    </div>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #e9e9e9',\n          padding: '10px 16px',\n          background: '#fff',\n          textAlign: 'right',\n          zIndex:'999'\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"cancelHandle\">取消</a-button>\n      <a-button\n        type=\"primary\"\n        @click=\"orderSubmit\"\n        :loading=\"submitLoading\"\n        :disabled=\"editInfo && !editDetial\"\n      >提交</a-button>\n    </div>\n    <a-modal v-model=\"visible\" title=\"添加地址\" :footer=\"null\">\n      <addAddress :custId=\"mallOrderIntactDto.custId\" @addressCancel=\"addressCancel\"></addAddress>\n    </a-modal>\n    <!-- 查看商品详情 -->\n    <!-- <a-drawer\n      placement=\"right\"\n      :closable=\"false\"\n      @close=\"onClose\"\n      :visible=\"towVisible\"\n      :wrapStyle=\"{overflow: 'auto',paddingBottom: '108px'}\"\n      :width=\"1080\"\n    >\n      <GoodsInfo\n        @isVisible=\"isVisible\"\n        :setGoodsViews=\"setGoodsViews\"\n        :isCatId=\"isCatId\"\n        :isEdit=\"isEdit\"\n        :isCustId=\"isCustId\"\n      ></GoodsInfo>\n    </a-drawer>-->\n  </div>\n</template>\n\n<script>\nimport EditableCell from '../basic_lib/EditableCell'\nimport addAddress from '../basic_lib/addAddress'\nimport { areas } from 'utils/area.js'\nimport { postJson, get, put, deleted } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport GoodsInfo from '@/views/product/pdm/goods2/GoodsInfo'\nimport { columnsOrderInfo, orderStatus } from '../basic_lib/menu.js'\nimport { mixinUpload, mixinCurrentPage, getListCompanyCusts } from '@/views/sale/mixin/minxinSale'\nimport moment from 'moment'\nexport default {\n  props: {\n    editInfo: {\n      type: Boolean\n    },\n    detialList: {\n      type: String\n    }\n  },\n  mixins: [mixinUpload, mixinCurrentPage, getListCompanyCusts],\n  components: {\n    GoodsInfo,\n    EditableCell,\n    addAddress\n  },\n  data() {\n    return {\n      dateFormat: 'YYYY/MM/DD',\n      companyGoods: 1, // 列表商家所有商品基本信息\n      labelCol: { span: 6 },\n      wrapperCol: { span: 18 },\n      columns: columnsOrderInfo,\n      orderStatus: orderStatus,\n      mallOrderIntactDto: {\n        oorderNumber: '自动生成',\n        ocustName: '',\n        otype: '',\n        addrId: '', // 地址ID\n        opurchaseOrderno: '', // 客户单号\n        custId: '', // 商城客户id\n        ocustShortName: '', // 客户简称\n        ototalSum: '', // 总金额，订单总计（销售总计）\n        oattachment: '', // 上传附件 1\n        oprePayment: '', // 预收款\n        oremarks: '', // 备注\n        ostatus: ''\n      },\n      areas,\n      dataSource: [],\n      isAddContactInfo: false,\n      visible: false, // 添加地址\n      addressList: [],\n      // 订单详情\n      towVisible: false,\n      editDetial: false,\n      buttons: [],\n      submitLoading: false,\n      setGoodsViews: {},\n      isCatId: '',\n      isCustId: '',\n      isEdit: true\n    }\n  },\n  created() {\n    if (this.editInfo) {\n      this.getOrderDetail(this.detialList)\n    }\n  },\n  methods: {\n    moment,\n    callback(key) {\n      console.log(key)\n    },\n    // 总价计算\n    setOtotalSum(data) {\n      let ototalSum = 0\n      for (const i in data) {\n        ototalSum += parseFloat(data[i].odAmount)\n      }\n      this.mallOrderIntactDto.ototalSum = ototalSum\n    },\n    // 订单编辑\n    orderDetialEdit() {\n      const newData = [...this.dataSource]\n      if (!this.editDetial) {\n        this.editDetial = true\n      } else {\n        newData.forEach(item => {\n          delete item.editable\n        })\n        this.editDetial = false\n      }\n    },\n    // 删除订单\n    orderDetele() {\n      const _this = this\n      const idStr = this.mallOrderIntactDto.id\n      this.$confirm({\n        title: '您确定要删除订单信息吗？',\n        content: '当您点击确定过后将删除选中的订单信息',\n        cancelText: '取消',\n        okText: '确定',\n        onOk() {\n          deleted(api.deletedBatch + `?idStr=${idStr}`).then(res => {\n            if (res.data.code === 0) {\n              _this.$emit('orderDetialInfo', false)\n              _this.$message.success('删除成功')\n            }\n          })\n        }\n      })\n    },\n    // 选择框的下拉加载\n    currentPageChange(e) {\n      const result = this.getCurrentPageChange(e)\n      if (result) {\n        this.getListCompanyCusts(this.customerPage)\n      }\n    },\n    // 添加产品\n    onAddContact() {\n      if (this.mallOrderIntactDto.ocustName !== '') {\n        this.isAddContactInfo = true\n      } else {\n        this.$message.warning('请先选择客户名称')\n      }\n    },\n    // 关闭商品添加弹框\n    handleOkContact(e) {\n      setTimeout(() => {\n        this.isAddContactInfo = false\n      }, 2000)\n    },\n    handleCancelContact(e) {\n      this.isAddContactInfo = false\n    },\n    // 添加产品 && 计算总价\n    showAddContactInfo(data) {\n      this.isAddContactInfo = data.isAddContactInfo\n      const dataSource = this.dataSource\n      if (data.sku) {\n        data.sku.key = dataSource.length\n        dataSource.push(data.sku)\n        this.setOtotalSum(dataSource)\n        this.dataSource = dataSource\n      }\n    },\n    // input变化 赋值\n    inputChange(val, type) {\n      if (type === 'ocustName') {\n        this.mallOrderIntactDto.ocustShortName = this.listCompanyCusts[val].custShortName\n        this.mallOrderIntactDto.ocustName = this.listCompanyCusts[val].custName\n        const custId = this.listCompanyCusts[val].id\n        this.mallOrderIntactDto.custId = custId\n        this.getAddressList(custId)\n      }\n    },\n    // 关闭当前抽屉\n    cancelHandle() {\n      this.$emit('isVisible', false)\n    },\n    // 订单提交\n    orderSubmit() {\n      if (this.dataSource.length === 0) {\n        this.$message.warning('请添加购买商品')\n        return\n      }\n      this.submitLoading = true\n      this.mallOrderIntactDto.oattachment = this.uploadFile.join(',')\n      if (!this.editInfo) {\n        // 订单添加\n        this.mallOrderIntactDto.skuList = this.dataSource\n        postJson(api.orderSave, this.mallOrderIntactDto).then(res => {\n          if (res.data.code === 0) {\n            this.$message.success('订单添加成功')\n            this.$emit('isVisible', true)\n          } else {\n            this.$message.warning(res.data.msg)\n          }\n        })\n      } else {\n        // 订单修改\n        this.dataSource.forEach(item => {\n          delete item.sku\n        })\n        this.mallOrderIntactDto.orderDetails = this.dataSource\n        this.mallOrderIntactDto.oattachment = this.uploadFile.join(',')\n        delete this.mallOrderIntactDto.skuList\n        put(api.updateOrder, this.mallOrderIntactDto).then(res => {\n          if (res.data.code === 0) {\n            this.$message.success('订单修改成功')\n            this.$emit('isVisible', true)\n          } else {\n            this.$message.error(res.data.msg)\n          }\n          this.submitLoading = false\n        })\n      }\n    },\n    // 地址添加\n    addAddress() {\n      if (this.mallOrderIntactDto.ocustName !== '') {\n        this.visible = true\n      } else {\n        this.$message.warning('请先选择客户名称')\n      }\n    },\n    // 关闭地址新增\n    addressCancel(data) {\n      if (data) {\n        this.getAddressList(this.mallOrderIntactDto.custId)\n      }\n      this.visible = false\n    },\n    // 通过客户Id查询地址列表\n    getAddressList(id) {\n      get(api.getAddressList + `/${id}`).then(res => {\n        var data = res.data.data\n        data.forEach(item => {\n          if (item.defaultGoodsAddr === 1) {\n            this.mallOrderIntactDto.addrId = item.id\n          }\n        })\n        this.addressList = data\n      })\n    },\n    // 选择地址\n    choseAddress(index, id) {\n      if (this.editInfo && !this.editDetial) {\n        return\n      }\n      const addressList = this.addressList\n      addressList.forEach(item => {\n        item.defaultGoodsAddr = 0\n      })\n      addressList[index].defaultGoodsAddr = 1\n      this.mallOrderIntactDto.addrId = id\n    },\n    // 产品编辑\n    edit(key) {\n      const newData = [...this.dataSource]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target.editable = true\n        this.dataSource = newData\n      }\n    },\n    // 产品列表数据修改\n    editCell(value, key, column) {\n      const newData = [...this.dataSource]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target[column] = value\n        if (column === 'odNumber' || column === 'odSkuCustPrice') {\n          target['odAmount'] =\n            Number(target['odNumber']) * Number(target['odSkuCustPrice'])\n        }\n\n        this.dataSource = newData\n        this.setOtotalSum(newData)\n      }\n    },\n    // 保存修改\n    save(key) {\n      const newData = [...this.dataSource]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        delete target.editable\n        this.dataSource = newData\n        this.setOtotalSum(newData)\n      }\n    },\n    // 删除当前行\n    cancel(key) {\n      const newData = [...this.dataSource]\n      const target = newData.filter(item => key !== item.key)\n      this.dataSource = target\n      this.setOtotalSum(newData)\n    },\n    // 获取订单详情\n    getOrderDetail(id) {\n      get(api.getOrderDetail + `${id}`).then(res => {\n        this.mallOrderIntactDto = res.data.data\n        const skuList = res.data.data.skuList\n        const oattachment = res.data.data.oattachment\n        for (const i in skuList) {\n          skuList[i].key = i\n        }\n        this.dataSource = skuList\n        if (oattachment) {\n          const oattachmentObj = []\n          const oattachmentList = oattachment.split(',')\n          for (const i in oattachmentList) {\n            oattachmentObj.push({\n              uid: i,\n              name: `${i}`,\n              status: 'done',\n              url: oattachmentList[i]\n            })\n          }\n          this.fileList = oattachmentObj\n        }\n        this.getAddressList(res.data.data.custId)\n      })\n    },\n    // 获取产品详情\n    getGoodsViews(skuId, catId) {\n      console.log(skuId, catId)\n      return false\n      // this.isCatId = catId ? `${catId}` : ''\n      // get(api.goodsView, { skuId: skuId })\n      //   .then(res => {\n      //     if (res.data.code === 0) {\n      //       this.setGoodsViews = res.data.data\n      //     }\n      //   })\n      //   .catch(err => {\n      //     console.log(err)\n      //   })\n      // this.towVisible = true\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n@import \"~styles/variable.less\";\n.inputWidth {\n  .inputWidth();\n}\n\n.addCustomer-title {\n  border-left: 4px solid #1890ff;\n  padding-left: 6px;\n}\n.ant-upload-select-picture-card i {\n  font-size: 32px;\n  color: #999;\n}\n.ant-upload-select-picture-card .ant-upload-text {\n  margin-top: 8px;\n  color: #666;\n}\n.editable-add-btn {\n  cursor: pointer;\n  margin: 10px 20px;\n  display: block;\n  line-height: 30px;\n  text-align: center;\n  border: 1px dashed #ccc;\n}\n.add-order-list {\n  position: relative;\n  .edit {\n    position: absolute;\n    top: 10px;\n    right: 20px;\n    & > span {\n      margin-right: 5px;\n      cursor: pointer;\n    }\n  }\n}\n</style>\n<style>\n.ant-alert-with-description.ant-alert-no-icon {\n  padding: 8px 15px;\n}\n</style>\n"]}]}