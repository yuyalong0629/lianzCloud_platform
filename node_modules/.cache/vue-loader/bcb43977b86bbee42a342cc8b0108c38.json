{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/pdm/goods/child_info/GoodsInfo.vue?vue&type=style&index=0&id=428b347c&lang=less&scoped=true&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/pdm/goods/child_info/GoodsInfo.vue","mtime":1560909866879},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/less-loader/dist/cjs.js","mtime":1556420627437},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '~styles/variable.less';\n\n.goods-info {\n  .categoryInfo-title {\n    margin: 15px 0;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n",{"version":3,"sources":["GoodsInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkgBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GoodsInfo.vue","sourceRoot":"src/views/product/pdm/goods/child_info","sourcesContent":["<template>\n  <div class=\"goods-info\">\n    <tab-title @isDelete=\"isDelete\">\n      <template v-slot:tabGoodsInfo>\n        <!-- 产品信息 -->\n        <a-row>\n          <a-col :span=\"24\">\n            <h3 class=\"categoryInfo-title\">产品详情</h3>\n          </a-col>\n          <a-col :span=\"24\">\n            <product-info \n              ref=\"goodsInfoForm\"\n              @springType=\"springType\"\n              @changeSpringType=\"changeSpringType\" \n              @classAttrInfo=\"classAttrInfo\" \n              @classCatObj=\"classCatObj\"\n              :skuInfoData=\"skuInfoData\" \n              :childDisabled=\"disabled\" \n              :springInfoType=\"springInfoData.springType\"\n            />\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">客户详情</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <cust-info \n                ref=\"custInfoForm\"\n                :custInfoData=\"custInfoData\"\n                :childDisabled=\"disabled\"\n                :custName=\"custName\"\n              />\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\" v-if=\"getClassType || classAttrInfoData.length\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">分类属性</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <class-attr \n                ref=\"classAttrForm\" \n                @classData=\"classData\" \n                :classAttrVal=\"classAttrVal\"\n                :childDisabled=\"disabled\"\n                :classAttrInfoData=\"classAttrInfoData\"\n                :classCatId=\"classCatId\"\n              />\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\" v-if=\"getSpringType || springVal !== undefined\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">弹簧属性</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <spring-attr\n                ref=\"productAttrForm\"\n                :springVal=\"springVal\"\n                :childDisabled=\"disabled\"\n                :springInfoData=\"springInfoData\"\n              />\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">产品图片</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <product-upload @propsFileList=\"propsFileList\" :picInfoData=\"picInfoData\"/>\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">工艺详情</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <craft-info @lineData=\"lineData\" :craftsInfoData=\"craftsInfoData\"/>\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">BOM详情</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <bom-info @tabData=\"tabData\" :materialsGroupInfoData=\"materialsGroupInfoData\"/>\n              </bo>\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">价目表</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <sprice-info\n                :infoData=\"infoData\"\n                @spriceData=\"spriceData\"\n                @basicSprice=\"basicSprice\"\n                :spriceInfoData=\"spriceInfoData\"\n                :craftsInfoData=\"craftsInfoData\"\n                :materialsGroupInfoData=\"materialsGroupInfoData\"\n                :spriceInfoBasic=\"spriceInfoBasic\"\n              />\n              </bo>\n            </a-col>\n          </a-col>\n        </a-row>\n      </template>\n      <template v-slot:tabMallAttr>\n        <tabMall-info/>\n      </template>\n    </tab-title>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport Bus from '@/Bus.js'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport TabTitle from '../other/TabTitle'\nimport TabMallInfo from './tab_mallInfo/TabMallInfo'\n// 产品信息\nimport ProductInfoForm from './tab_goodsInfo/ProductInfoForm'\nimport CustInfoForm from './tab_goodsInfo/CustInfoForm'\nimport ClassAttrForm from './tab_goodsInfo/ClassAttrForm'\nimport SpringAttrForm from './tab_goodsInfo/SpringAttrForm'\nimport ProductUpload from '@/components/upload/Upload'\nimport CraftInfo from './tab_goodsInfo/craftInfo/CraftInfo'\nimport BomInfo from './tab_goodsInfo/bomInfo/BomInfo'\nimport SpriceInfo from './tab_goodsInfo/SpriceInfoForm'\n// index\nimport { goodsSkuAdd } from '../basic_lib/index'\n\n\nexport default {\n  name: 'GoodsInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      isLabelColor: false,\n      getSpringType: false,\n      getClassType: false,\n      springVal: undefined,\n      classAttrVal: [],\n      infoData: {\n        // 工艺详情\n        craftInfoData: [],\n        // BOM详情\n        bomInfoData: []\n      },\n      // 产品详情data\n      skuData: {},\n      // Pic\n      pics: [],\n      // 客户详情\n      custInfo: {},\n      springInfo: {},\n      // 分类属性\n      attrVals: [],\n      // 工艺详情\n      crafts: [],\n      // BOM详情\n      materialsGroup: [],\n      // 价目表\n      priceAndInventorys: [],\n      sprice: '',\n      // 产品详情回显\n      skuInfoData: {},\n      classCatObjId: [],\n      // 客户详情回显\n      custInfoData: {},\n      custName: '',\n      // 弹簧属性回显\n      springInfoData: {},\n      // 产品图片回显\n      picInfoData: [],\n      // 分类属性回显\n      classAttrInfoData: [],\n      classCatId: '',\n      // 工艺详情回显\n      craftsInfoData: [],\n      // 原材料详情回西显\n      materialsGroupInfoData: [],\n      // 价目详情\n      spriceInfoData: [],\n      spriceInfoBasic: ''\n    }\n  },\n  props: {\n    goodsViewInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created() {\n    // 编辑 || 取消\n    Bus.$on('isDisabled', val => {\n      // Input选中\n      console.log(val)\n      const edit = new Promise(resolved => {\n        this.disabled = !val\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    })\n  },\n  destroyed() {\n    Bus.$off('isDisabled')\n  },\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName(value) {\n      // console.log(value)\n    },\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId ? this.skuData.catId.slice(-1).join('') : '',\n            ...this.price\n          },\n          pics: [\n            ...this.pics\n          ],\n          custInfo: {\n            ...this.custInfo\n          },\n          springInfo: {\n            springType: this.springVal,\n            ...this.springInfo\n          },\n          attrVals: [\n            ...this.attrVals\n          ],\n          crafts: [\n            ...this.crafts\n          ],\n          materialsGroup: [\n            ...this.materialsGroup\n          ],\n          priceAndInventorys: [\n            ...this.priceAndInventorys\n          ]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd(params)\n      })\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n    },\n    // 删除\n    isDelete(val) {},\n    // 子组件分类属性 $emit\n    classAttrInfo(val) {\n      if (val.length) {\n        this.getClassType = true\n        this.classAttrVal = val\n        return\n      }\n      this.getClassType = false\n    },\n    // 子组件分类属性 接受data $emit\n    classData(val) {\n      // console.log(val)\n      this.attrVals = val\n    },\n    // 弹簧种类 $emit\n    springType(val) {\n      // console.log(val)\n      if (val === undefined) {\n        this.getSpringType = false\n        this.springVal = undefined\n        return\n      }\n      this.springVal = val\n      this.getSpringType = true\n    },\n    // Upload\n    propsFileList(val) {\n      this.pics = val\n    },\n    // 产品类别非0选中\n    changeSpringType(val) {\n      this.getSpringType = false\n      // console.log(val)\n    },\n    // 工艺详情Data\n    lineData(val) {\n      console.log(val)\n      this.infoData.craftInfoData = [...val]\n      this.crafts = []\n      this.infoData.craftInfoData.forEach((item, index) => {\n        this.crafts.push({\n          defaultCraft: item.defaultCraft,\n          productCraftCode: item.code,\n          productCraftName: item.inputVal,\n          productCraftId: item.productCraftId\n        })\n      })\n      console.log(this.crafts)\n    },\n    // BOM详情\n    tabData(val) {\n      this.infoData.bomInfoData = [...val]\n      // console.log(this.infoData)\n      this.materialsGroup = []\n      this.infoData.bomInfoData.forEach((item, index) => {\n        this.materialsGroup.push({\n          bomType: item.isModalActive === 1 ? 'MAKE' : 'CRAFT',\n          defaultMaterials: item.defaultCraft,\n          groupName: item.inputVal,\n          materials: []\n        })\n        item.dataSource.forEach(cItem => {\n          this.materialsGroup[index].materials.push({\n            cost: cItem.dosage,\n            materialId: cItem.key\n          })\n        })\n      })\n      // console.log(this.materialsGroup)\n    },\n    // 价目表\n    spriceData(val) {\n      // console.log(val)\n      this.priceAndInventorys = []\n      val.forEach(item => {\n        this.priceAndInventorys.push(item)\n      })\n    },\n    basicSprice(val) {\n      // console.log(val)\n      this.sprice = val\n    },\n    // 产品详情子组件接受分类属性ID数组\n    classCatObj(val) {\n      this.classCatObjId = val.id\n    },\n    // FormData\n    async getFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.validateFields((err, values) => {\n        if (!err) {\n          // console.log(values)\n          this.skuData = values\n        }\n      })\n      // 客户详情FormData\n      this.$refs.custInfoForm.custInfoForm.validateFields((err, values) => {\n        if (!err) {\n          // console.log(values)\n          this.custInfo = values\n        }\n      })\n      // 分类属性FormData\n      if (this.$refs.classAttrForm) {\n        this.$refs.classAttrForm.classAttrInfoForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n            }\n          }\n        )\n      }\n      // 弹簧属性FormData\n      if (this.$refs.productAttrForm) {\n        this.$refs.productAttrForm.productAttrForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n              this.springInfo = values\n            }\n          }\n        )\n      }\n    },\n    // Form详情\n    async setFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.setFieldsValue({\n        catId: this.classCatObjId,\n        name: this.skuInfoData.name,\n        drawNum: this.skuInfoData.drawNum,\n        drawVersion: this.skuInfoData.drawVersion,\n        spec: this.skuInfoData.spec,\n        unit: this.skuInfoData.unit,\n        unit: this.skuInfoData.unit,\n        gateway: this.skuInfoData.gateway,\n        standard: this.skuInfoData.standard,\n        weight: this.skuInfoData.weight,\n        remark: this.skuInfoData.remark,\n        skuType: this.skuInfoData.skuType\n      })\n       // 客户详情FormData\n      this.$refs.custInfoForm.custInfoForm.setFieldsValue({\n        custId: this.custInfoData.custId.split(),\n        custDrawNum: this.custInfoData.custDrawNum,\n        custDrawVersion: this.custInfoData.custDrawVersion,\n        custSkuCode: this.custInfoData.custSkuCode,\n        custMaterialNum: this.custInfoData.custMaterialNum,\n        custMaterialName: this.custInfoData.custMaterialName,\n        custCz: this.custInfoData.custCz,\n        custBmcl: this.custInfoData.custBmcl,\n        custSkuSpec: this.custInfoData.custSkuSpec,\n        custRemark: this.custInfoData.custRemark\n      })\n      // 弹簧属性FormData\n      if (this.$refs.productAttrForm) {\n        this.$refs.productAttrForm.productAttrForm.setFieldsValue({\n          gcdj: this.springInfoData.gcdj,\n          xj: this.springInfoData.xj,\n          wj: this.springInfoData.wj,\n          zygd: this.springInfoData.zygd,\n          zqs: this.springInfoData.zqs,\n          cz: this.springInfoData.cz,\n          bmcl: this.springInfoData.bmcl,\n          ybgd: this.springInfoData.ybgd,\n          gzgd: this.springInfoData.gzgd,\n          yxqs: this.springInfoData.yxqs,\n          lz: this.springInfoData.lz,\n          xx: this.springInfoData.xx,\n          lxj: this.springInfoData.lxj,\n          zkcd: this.springInfoData.zkcd,\n          nj: this.springInfoData.nj,\n          hd: this.springInfoData.hd,\n          bs: this.springInfoData.bs,\n          cs: this.springInfoData.cs,\n          yl: this.springInfoData.yl,\n          gd: this.springInfoData.gd,\n          zdbxl: this.springInfoData.zdbxl,\n          xrb: this.springInfoData.xrb\n        })\n      }\n    }\n  },\n  watch: {\n    goodsViewInfo: {\n      handler(val) {\n        console.log(val)\n        if (Object.keys(val).length) {\n          // sku\n          this.skuInfoData = val.sku\n          // cust\n          this.custInfoData = val.custInfo\n          // custName\n          this.custName = val.cust.custName\n          // spring\n          this.springInfoData = val.springInfo\n          // springType\n          this.springVal = val.springInfo.springType\n          // PIC\n          this.picInfoData = val.pics\n          // 分类属性\n          this.classAttrInfoData = val.attrVals\n          this.classCatId = val.sku.catId\n          // 工艺详情\n          this.craftsInfoData = val.crafts\n          // 原材料\n          this.materialsGroupInfoData = val.materialsGroup\n          // 价目\n          this.spriceInfoData = val.priceAndInventorys\n          // 基础报价\n          this.spriceInfoBasic = val.sku.price.toString()\n          console.log(this.spriceInfoBasic)\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'tab-title': TabTitle,\n    'tabMall-info': TabMallInfo,\n    'product-info': ProductInfoForm,\n    'cust-info': CustInfoForm,\n    'class-attr': ClassAttrForm,\n    'spring-attr': SpringAttrForm,\n    'product-upload': ProductUpload,\n    'craft-info': CraftInfo,\n    'bom-info': BomInfo,\n    'sprice-info': SpriceInfo\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.goods-info {\n  .categoryInfo-title {\n    margin: 15px 0;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>"]}]}