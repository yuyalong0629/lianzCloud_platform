{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/AddCustomerInfo.vue?vue&type=style&index=0&id=6419e0b6&lang=less&scoped=true&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/AddCustomerInfo.vue","mtime":1556420575737},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/less-loader/dist/cjs.js","mtime":1556420627437},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import '~styles/variable.less';\n\n.addCustomer-title {\n  .h3_title();\n}\n.custEdit {\n  float: right;\n}\n",{"version":3,"sources":["AddCustomerInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAw0BA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"AddCustomerInfo.vue","sourceRoot":"src/views/customer","sourcesContent":["<template>\n  <div class=\"addCustomerInfo\">\n    <a-form :form=\"customerInfo\" layout=\"horizontal\">\n      <a-row :gutter=\"16\">\n        <a-col :span=\"24\" class=\"categoryEdit-wrapper\" v-if=\"isCategoryEdit\">\n          <a-button\n            type=\"primary\"\n            size=\"small\"\n            @click=\"onHandleCustEdit\"\n            class=\"custEdit\"\n          >{{ custEdit }}</a-button>\n        </a-col>\n        <a-col :span=\"24\">\n          <h3 class=\"addCustomer-title\">客户信息</h3>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户编码\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input disabled v-decorator=\"['custCode']\" placeholder=\"客户编码自动生成\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户名称\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              v-decorator=\"['custName', {\n                  rules: [{ required: true, message: '请输入客户名称' }]\n                }]\"\n              :disabled=\"isDisabled\"\n              placeholder=\"请输入客户名称\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户电话\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              v-decorator=\"['custPhone', {\n                  rules: [{ required: true, message: '请输入客户电话' }]\n                }]\"\n              :disabled=\"isDisabled\"\n              placeholder=\"请输入客户电话\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户行业\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-select\n              :disabled=\"isDisabled\"\n              v-decorator=\"[\n          'custIndustry',\n          {rules: [{ required: true, message: '请输入客户行业' }]}\n        ]\"\n              placeholder=\"请输入客户行业\"\n              @change=\"onSelectCustIndustry\"\n            >\n              <a-select-option\n                :value=\"item.id\"\n                v-for=\"(item, index) in this.custIndustryArr\"\n                :key=\"index\"\n              >{{ item.displayValue }}</a-select-option>\n            </a-select>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户简称\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custAbbreviation', {\n                  rules: [{ required: true, message: '请输入客户简称' }]\n                }]\"\n              placeholder=\"客户简称\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户经理\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custManager', {\n                  rules: [{ required: true, message: '请输入客户经理' }]\n                }]\"\n              placeholder=\"客户经理\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"客户级别\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-select\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custLevel']\"\n              placeholder=\"请输入客户级别\"\n              @change=\"onSelectCustLevel\"\n            >\n              <a-select-option value=\"0\">普通</a-select-option>\n              <a-select-option value=\"1\">一般</a-select-option>\n              <a-select-option value=\"2\">重点</a-select-option>\n              <a-select-option value=\"3\">VIP</a-select-option>\n            </a-select>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"地址\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-cascader\n              :disabled=\"isDisabled\"\n              :fieldNames=\"{ label: 'name', value: 'id', children: 'childrens' }\"\n              v-decorator=\"['custAddress']\"\n              :options=\"options\"\n              @change=\"onSelectArea\"\n              placeholder=\"请选择地址\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"详细地址\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custDetailAddress']\"\n              placeholder=\"请输入详细地址\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"传真\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input :disabled=\"isDisabled\" v-decorator=\"['custFax']\" placeholder=\"请输入传真\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"网址\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input :disabled=\"isDisabled\" v-decorator=\"['custUrl']\" placeholder=\"请输入网址\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"来源\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-select\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custSource']\"\n              placeholder=\"请输入来源\"\n              @change=\"onSelectCustLevel\"\n            >\n              <a-select-option value=\"0\">线上注册</a-select-option>\n              <a-select-option value=\"1\">线下注册</a-select-option>\n            </a-select>\n          </a-form-item>\n        </a-col>\n      </a-row>\n    </a-form>\n    <a-row :gutter=\"16\">\n      <a-col :span=\"24\">\n        <h3 class=\"addCustomer-title\">联系人信息</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <a-table showHeader :dataSource=\"dataContact\" :columns=\"columns\" :pagination=\"false\">\n          <template\n            v-for=\"col in ['editName', 'editSex', 'editPhone', 'editDepartment', 'editMaill', 'editOther']\"\n            :slot=\"col\"\n            slot-scope=\"text, record\"\n          >\n            <div :key=\"col\">\n              <a-input\n                v-if=\"record.editable\"\n                style=\"margin: -5px 0\"\n                :value=\"text\"\n                @change=\"e => onChangeEdit(e.target.value, record.key, col)\"\n              />\n              <template v-else>{{text}}</template>\n            </div>\n          </template>\n          <!-- 编辑 -->\n          <template slot=\"operation\" slot-scope=\"text, record\">\n            <div class=\"editable-row-operations\">\n              <span v-if=\"record.editable\">\n                <a @click=\"() => save(record.key)\">保存</a> |\n                <a-popconfirm\n                  okText=\"确认\"\n                  cancelText=\"取消\"\n                  title=\"确定取消这项业务吗?\"\n                  @confirm=\"() => removeCancel(record.key)\"\n                >\n                  <a>删除</a>\n                </a-popconfirm>\n              </span>\n              <span v-else>\n                <a @click=\"() => edit(record.key)\">编辑</a>\n              </span>\n            </div>\n          </template>\n        </a-table>\n        <a-button\n          class=\"editable-add-btn\"\n          style=\"margin: 10px 0; float: right;\"\n          @click=\"onAddContact\"\n          :disabled=\"isDisabled\"\n        >添加</a-button>\n        <!-- 添加新信息 -->\n        <a-modal\n          title=\"添加\"\n          cancelText=\"取消\"\n          okText=\"确认添加\"\n          :maskClosable=\"false\"\n          :footer=\"null\"\n          :afterClose=\"closeAddInfo\"\n          :visible=\"isAddContactInfo\"\n          @ok=\"handleOkContact\"\n          @cancel=\"handleCancelContact\"\n        >\n          <EditableCell @showAddContactInfo=\"showAddContactInfo\"></EditableCell>\n        </a-modal>\n      </a-col>\n    </a-row>\n    <a-form :form=\"customerInvoiceInfo\" layout=\"horizontal\" style=\"marginBottom: 50px;\">\n      <a-row :gutter=\"16\">\n        <a-col :span=\"24\">\n          <h3 class=\"addCustomer-title\">发票信息</h3>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"发票抬头\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input :disabled=\"isDisabled\" v-decorator=\"['custInvoiceUp']\" placeholder=\"发票抬头\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item label=\"纳税人识别号\" :label-col=\"{ span: 9 }\" :wrapper-col=\"{ span: 15 }\">\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custInvoiceNumber']\"\n              placeholder=\"纳税人识别号\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"开户行\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input :disabled=\"isDisabled\" v-decorator=\"['custInvoiceBank']\" placeholder=\"开户行\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"开户账号\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custInvoiceAccount']\"\n              placeholder=\"开户账号\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"开票内容\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custInvoiceContent']\"\n              placeholder=\"开票内容\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"8\">\n          <a-form-item\n            label=\"联系电话\"\n            :label-col=\"formItemLayout.labelCol\"\n            :wrapper-col=\"formItemLayout.wrapperCol\"\n          >\n            <a-input :disabled=\"isDisabled\" v-decorator=\"['custInvoicePhone']\" placeholder=\"联系电话\"/>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"16\">\n          <a-form-item label=\"发票地址\" :label-col=\"{ span: 3 }\" :wrapper-col=\"{ span: 21 }\">\n            <a-input\n              :disabled=\"isDisabled\"\n              v-decorator=\"['custInvoiceAddress']\"\n              placeholder=\"发票地址\"\n            />\n          </a-form-item>\n        </a-col>\n      </a-row>\n    </a-form>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #e9e9e9',\n          padding: '10px 16px',\n          background: '#fff',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" v-if=\"!isCategoryEdit\" type=\"primary\" :loading=\"loading\">提交</a-button>\n      <a-button\n        @click=\"onEditSave\"\n        type=\"primary\"\n        v-if=\"isCategoryEdit\"\n        :disabled=\"isDisabled\"\n        :loading=\"loading\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport EditableCell from './EditableCell'\nimport api from '@/api/index.js'\nimport { get } from '@/api/axios.js'\nimport { areas } from './area.js'\nimport { reduceObj, subAddCust, uploadCustomerAndMallUser } from './getPage.js'\nimport { setTimeout, clearTimeout } from 'timers'\n\nconst formItemLayout = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 18 }\n}\n\nconst columns = [\n  {\n    title: '成员姓名',\n    dataIndex: 'editName',\n    scopedSlots: { customRender: 'editName' }\n  },\n  {\n    title: '性别',\n    dataIndex: 'editSex',\n    scopedSlots: { customRender: 'editSex' }\n  },\n  {\n    title: '手机号',\n    dataIndex: 'editPhone',\n    scopedSlots: { customRender: 'editPhone' }\n  },\n  {\n    title: '部门',\n    dataIndex: 'editDepartment',\n    scopedSlots: { customRender: 'editDepartment' }\n  },\n  {\n    title: '邮箱',\n    dataIndex: 'editMaill',\n    scopedSlots: { customRender: 'editMaill' }\n  },\n  {\n    title: '其他方式',\n    dataIndex: 'editOther',\n    scopedSlots: { customRender: 'editOther' }\n  },\n  {\n    title: '编辑 | 删除',\n    dataIndex: 'operation',\n    width: '12%',\n    scopedSlots: { customRender: 'operation' }\n  }\n]\n\nexport default {\n  name: 'AddCustomerInfo',\n  data() {\n    return {\n      customerInfo: this.$form.createForm(this),\n      customerInvoiceInfo: this.$form.createForm(this),\n      isVisible: true,\n      formItemLayout,\n      options: areas,\n      dataContact: [],\n      getDataContact: [],\n      custIndustryArr: [], // 行业字典表\n      columns,\n      // 编辑添加弹出层\n      isAddContactInfo: false,\n      timer: null,\n      // 表单提交\n      loading: false,\n      custFormData: {\n        mallUserNatureDtos: [], // 添加联系人数组\n        custInvoiceInfo: {\n          companyId: '', // 厂家ID\n          createTime: '', // 创建时间\n          custId: '', //  供应商ID\n          creatorId: '', // 创建人ID\n          deleted: '', // 已删除(0未删1已删)\n          id: '0', // 已删除(0未删1已删)\n          iiAccountName: '', // 账户名\n          iiAddress: '', // 收票地址\n          iiBank: '', // 开户行\n          iiCompanyName: '', // 发票抬头\n          iiContact: '', // 联系方式\n          iiLinkman: '', // 收票联系人\n          iiTaxContent: '', // 开票内容\n          iiTaxpayerId: '', // 纳税人识别号\n          iiType: 0, // 发票类型\n          modifierId: '', // 修改人\n          modifyTime: '' // 修改时间\n        },\n        customer: {\n          companyId: '', // 厂家ID\n          custArea: '', // 客户所属区\n          custCity: '', // 客户所属市\n          custCode: '', // 客户编码\n          custDetailAddr: '', // 客户详细地址,\n          custFax: '', // 公司传真\n          custFrom: '', // 来源0线上注册，1线下注册\n          custIndustry: '', // 客户行业(字典表选择)\n          custLevel: '', // 客户级别0普通，1一般，2重点，3vip\n          custManager: '', // 客户经理 （厂家为公司服务的人员从后台录入）\n          custName: '', // 客户名称\n          custPhone: '', // 客户电话\n          custProvince: '', // 客户所属省\n          custShortName: '', // 客户简称\n          custStatus: '', // 状态0无购买记录 1有\n          custType: 0, // 类型0正常1虚拟添加\n          custWebsite: '', // 公司网址\n          id: '0' // 已删除(0未删1已删)\n        }\n      },\n      getCustDetailInfo: '',\n      custEdit: '点击编辑',\n      isDisabled: false\n    }\n  },\n  props: {\n    isEdit: {\n      type: Boolean,\n      default: false\n    },\n    setCustomerAndMallUser: {\n      type: Object,\n      required: true\n    }\n  },\n  created() {\n    this.getCustIndustry()\n  },\n  destroyed() {\n    clearTimeout(this.timer)\n  },\n  watch: {\n    setCustomerAndMallUser: {\n      // immediate: true,\n      handler(val) {\n        this.getCustDetailInfo = val\n        this.getCustInfo()\n      },\n      deep: true\n    }\n  },\n  computed: {\n    isCategoryEdit() {\n      return this.isEdit\n    }\n  },\n  methods: {\n    // 客户详情\n    getCustInfo() {\n      this.isDisabled = true\n      console.log(this.getCustDetailInfo)\n      this.timer = setTimeout(() => {\n        // 客户信息\n        this.customerInfo.setFieldsValue({\n          // custCode: getCustDetailInfo.customer.custCode, // 客户编码\n          custName: this.getCustDetailInfo.customer.custName, // 客户名称\n          custPhone: this.getCustDetailInfo.customer.custPhone, // 客户电话\n          custIndustry: this.getCustDetailInfo.customer.custIndustry, // 客户行业\n          custAbbreviation: this.getCustDetailInfo.customer.custShortName, // 简称\n          custManager: this.getCustDetailInfo.customer.custManager, // 客户经理\n          custLevel: this.getCustDetailInfo.customer.custLevel, // 客户级别\n          custAddress: [\n            this.getCustDetailInfo.customer.custProvince,\n            this.getCustDetailInfo.customer.custCity,\n            this.getCustDetailInfo.customer.custArea\n          ], // 地址\n          custDetailAddress: this.getCustDetailInfo.customer.custDetailAddr, // 详细地址\n          custFax: this.getCustDetailInfo.customer.custFax, // 传真\n          custUrl: this.getCustDetailInfo.customer.custWebsite, // 网址\n          custSource:\n            this.getCustDetailInfo.customer.custFrom === 0\n              ? '线上注册'\n              : '线下注册' // 来源\n        })\n        // 联系人信息\n        // this.dataContact = this.getCustDetailInfo.mallUserNatureDtos\n        this.getCustDetailInfo.mallUserNatureDtos.forEach(item => {\n          this.dataContact.push({\n            key: item.id,\n            editName: item.name,\n            editSex: item.sex === 1 ? '男' : '女',\n            editPhone: item.phone,\n            editDepartment: item.companyPosition,\n            editMaill: item.email,\n            editOther: item.contact\n          })\n        })\n        this.customerInvoiceInfo.setFieldsValue({\n          custInvoiceAccount:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiAccountName, // 账户名\n          custInvoiceAddress:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiAddress, // 收票地址\n          custInvoiceBank:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiBank, // 开户行\n          custInvoiceUp:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiCompanyName, // 发票抬头\n          custInvoicePhone:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiContact, // 联系方式\n          custInvoiceContent:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiTaxContent, // 开票内容\n          custInvoiceNumber:\n            this.getCustDetailInfo.custInvoiceInfo === null\n              ? ''\n              : this.getCustDetailInfo.custInvoiceInfo.iiTaxpayerId // 纳税人识别号\n        })\n        console.log(this.dataContact)\n      }, 400)\n    },\n    // 行业字典表\n    getCustIndustry() {\n      get(api.custIndustry + 'INDUSTRY')\n        .then(res => {\n          this.custIndustryArr = []\n          res.data.data.forEach(item => {\n            this.custIndustryArr.push({\n              id: item.id,\n              displayValue: item.displayValue\n            })\n          })\n          console.log(this.custIndustryArr)\n        })\n        .catch(err => {\n          console.log(err)\n        })\n    },\n    // 一级新建列表遮罩显示\n    onClose() {\n      this.isVisible = false\n      this.$emit('isVisible', this.isVisible)\n    },\n    onSubmit() {\n      this.$emit('isVisible', this.isVisible)\n      // 客户信息\n      const asyncSubmit = new Promise(resolve => {\n        this.getFormData()\n        resolve()\n      })\n      asyncSubmit.then(() => {\n        subAddCust.call(this)\n      })\n    },\n    // 获取表单参数\n    getFormData() {\n      this.customerInfo.validateFields((err, value) => {\n        if (!err) {\n          console.info(value)\n          // this.custFormData.custCode = value.custCode // 客户编码\n          this.custFormData.customer.custName = value.custName // 客户名称\n          this.custFormData.customer.custPhone = value.custPhone // 客户电话\n          this.custFormData.customer.custProvince = value.custAddress[0] // 省\n          this.custFormData.customer.custCity = value.custAddress[1] // 市\n          this.custFormData.customer.custArea = value.custAddress[2] // 区\n          this.custFormData.customer.custShortName = value.custAbbreviation\n            ? value.custAbbreviation\n            : '' // 客户简称\n          this.custFormData.customer.custManager = value.custManager\n            ? value.custManager\n            : '' // 客户经理\n          this.custFormData.customer.custDetailAddr = value.custDetailAddress\n            ? value.custDetailAddress\n            : '' // 详细地址\n          this.custFormData.customer.custFax = value.custFax\n            ? value.custFax\n            : '' // 传真\n          this.custFormData.customer.custWebsite = value.custUrl\n            ? value.custUrl\n            : '' // 网址\n          this.custFormData.customer.custFrom = value.custSource === '线上注册' ? '0' : '1' // 来源\n\n          // this.dataContact 联系人数组\n          this.custFormData.mallUserNatureDtos = []\n          this.dataContact.forEach(item => {\n            console.log(item)\n            this.custFormData.mallUserNatureDtos.push({\n              id: '0',\n              companyPosition: item.editDepartment,\n              contact: item.editOther,\n              email: item.editMaill,\n              name: item.editName,\n              phone: item.editPhone,\n              sex: item.editSex === '男' ? 1 : 0\n            })\n          })\n        }\n      })\n      // 发票信息\n      this.customerInvoiceInfo.validateFields((err, value) => {\n        if (!err) {\n          this.custFormData.custInvoiceInfo.iiCompanyName = value.custInvoiceUp\n            ? value.custInvoiceUp\n            : '' // 发票抬头\n          this.custFormData.custInvoiceInfo.iiTaxpayerId = value.custInvoiceNumber\n            ? value.custInvoiceNumber\n            : '' // 纳税人识别号\n          this.custFormData.custInvoiceInfo.iiBank = value.custInvoiceBank\n            ? value.custInvoiceBank\n            : '' // 开户行\n          this.custFormData.custInvoiceInfo.iiAccountName = value.custInvoiceAccount\n            ? value.custInvoiceAccount\n            : '' // 开户账号\n          this.custFormData.custInvoiceInfo.iiTaxContent = value.custInvoiceContent\n            ? value.custInvoiceContent\n            : '' // 开票内容\n          this.custFormData.custInvoiceInfo.iiContact = value.custInvoicePhone\n            ? value.custInvoicePhone\n            : '' // 联系电话\n          this.custFormData.custInvoiceInfo.iiAddress = value.custInvoiceAddress\n            ? value.custInvoiceAddress\n            : '' // 发票地址\n          console.info(value)\n        }\n      })\n    },\n    // 客户行业\n    onSelectCustIndustry(value) {\n      console.log(value)\n      this.custFormData.customer.custIndustry = value // 客户行业\n    },\n    // 客户级别\n    onSelectCustLevel(value) {\n      console.log(value)\n      this.custFormData.customer.custLevel = value // 客户行业\n    },\n    // 地址选择\n    onSelectArea(value, selectedOptions) {\n      console.log(value)\n      this.custFormData.customer.custProvince = ''\n      this.custFormData.customer.custCity = ''\n      this.custFormData.customer.custArea = ''\n      if (value.length === 1) {\n        this.custFormData.customer.custProvince = value[0]\n        console.log(this.custFormData)\n        return false\n      }\n      if (value.length === 2) {\n        this.custFormData.customer.custProvince = value[0]\n        this.custFormData.customer.custCity = value[1]\n        console.log(this.custFormData)\n        return false\n      }\n      if (value.length === 3) {\n        this.custFormData.customer.custProvince = value[0]\n        this.custFormData.customer.custCity = value[1]\n        this.custFormData.customer.custArea = value[2]\n        console.log(this.custFormData)\n        return false\n      }\n    },\n    // 联系人信息\n    onDeleteContact(key) {\n      const dataSource = [...this.dataSource]\n      this.dataSource = dataSource.filter(item => {\n        console.log(item)\n        return item.key !== key\n      })\n    },\n    onEditContact(key) {\n      console.log(key)\n    },\n    // 监听table修改状态\n    onChangeEdit(value, key, column) {\n      console.log(value, key, column)\n      const newData = [...this.dataContact]\n      const target = this.dataContact.filter(item => key === item.key)[0]\n      console.log(target)\n      if (target) {\n        target[column] = value\n        this.Contact = newData\n      }\n    },\n    // 编辑\n    edit(key) {\n      const newData = [...this.dataContact]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target.editable = true\n        this.dataContact = newData\n      }\n    },\n    // 保存\n    save(key) {\n      const newData = [...this.dataContact]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        delete target.editable\n        this.dataContact = newData\n        console.log(this.dataContact)\n      }\n    },\n    // 删除\n    removeCancel(key) {\n      const newData = [...this.dataContact]\n      this.dataContact = newData.filter(item => item.key !== key)\n    },\n    // 联系人添加遮罩\n    onAddContact() {\n      this.isAddContactInfo = true\n    },\n    handleOkContact(e) {\n      setTimeout(() => {\n        this.isAddContactInfo = false\n      }, 2000)\n    },\n    handleCancelContact(e) {\n      console.log('Clicked cancel button')\n      this.isAddContactInfo = false\n    },\n    // 添加信息详情关闭回调\n    closeAddInfo() {\n      if (this.$store.state.custEditableInfo) {\n        this.getDataContact.push(this.$store.state.custEditableInfo)\n        const repeatArr = reduceObj.call(this, this.getDataContact)\n        // 防止同步加载阻塞\n        this.$nextTick(() => {\n          this.dataContact = []\n          for (let i = 0; i < repeatArr.length; i++) {\n            this.dataContact.push({\n              key: i.toString(),\n              editName: repeatArr[i].name,\n              editSex: repeatArr[i].sex === 1 ? '男' : '女',\n              editPhone: repeatArr[i].phone,\n              editDepartment: repeatArr[i].companyPosition,\n              editMaill: repeatArr[i].email,\n              editOther: repeatArr[i].contact\n            })\n          }\n        })\n        return false\n      }\n    },\n    // $emit 监听遮罩\n    showAddContactInfo(data) {\n      this.isAddContactInfo = data\n    },\n    // 详情编辑\n    onHandleCustEdit() {\n      if (this.custEdit === '点击编辑') {\n        this.custEdit = '取消编辑'\n        this.isDisabled = false\n        return\n      }\n      this.custEdit = '点击编辑'\n      this.isDisabled = true\n    },\n    // 保存修改\n    onEditSave() {\n      // 客户信息\n      const asyncSubmit = new Promise(resolve => {\n        // 设置CUSTID\n        this.custFormData.customer.id = this.getCustDetailInfo.customer.id\n        this.custFormData.customer.companyId = this.getCustDetailInfo.customer.companyId\n        this.custFormData.custInvoiceInfo.custId = this.getCustDetailInfo.customer.id\n        this.custFormData.custInvoiceInfo.id = this.getCustDetailInfo.custInvoiceInfo === null ? '0' : this.getCustDetailInfo.custInvoiceInfo.id\n        this.custFormData.custInvoiceInfo.companyId = this.getCustDetailInfo.custInvoiceInfo === null ? this.getCustDetailInfo.customer.companyId : this.getCustDetailInfo.custInvoiceInfo.companyId\n        this.getFormData()\n        resolve()\n      })\n      asyncSubmit.then(() => {\n        console.log(this.custFormData)\n        uploadCustomerAndMallUser.call(this)\n      })\n    }\n  },\n  components: {\n    EditableCell\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.addCustomer-title {\n  .h3_title();\n}\n.custEdit {\n  float: right;\n}\n</style>\n"]}]}