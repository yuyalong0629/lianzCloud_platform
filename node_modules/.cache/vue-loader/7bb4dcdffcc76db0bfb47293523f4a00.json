{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/user/Retrieve.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/user/Retrieve.vue","mtime":1557891132373},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { post } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport { factorySendCode } from 'utils/utils.js'\n\nexport default {\n  name: 'Retrieve',\n  data() {\n    return {\n      btnType: 'primary',\n      btnText: '发送验证码',\n      remaining: 5,\n      disabled: false,\n      registerInfo: this.$form.createForm(this),\n      checkAgree: false\n    }\n  },\n  methods: {\n    // 自定义用户名验证\n    validateUsername(rule, value, callback) {\n      const regex = /^1[34578]\\d{9}$/\n      if (!value) {\n        callback(new Error('用户名不能为空'))\n        return false\n      }\n      if (!regex.test(value)) {\n        callback(new Error('请输入正确的手机号'))\n        return false\n      }\n      callback()\n    },\n    validatePassword(rule, value, callback) {\n      const regex = /[^0-9a-zA-Z_]/\n      if (!value) {\n        callback(new Error('密码不能为空'))\n        return false\n      }\n      if (value.length < 6 || value.length > 18) {\n        callback(new Error('密码请在6～18位数之间'))\n        return false\n      }\n      if (regex.test(value)) {\n        callback(new Error('密码不能有特殊字符'))\n        return false\n      }\n      callback()\n    },\n    validateRePassword(rule, value, callback) {\n      const password = this.registerInfo.getFieldValue('password')\n      if (value === undefined) {\n        callback(new Error('请输入密码'))\n      }\n      if (value && password && value.trim() !== password.trim()) {\n        callback(new Error('两次密码不一致'))\n      }\n      callback()\n    },\n    // senCode\n    sendCode() {\n      this.registerInfo.validateFields(['username'], (err, value, callback) => {\n        if (!err) {\n          post(api.reSendCode, { phone: value.username }).then(res => {\n            factorySendCode.call(this, 5)\n          })\n        } else {\n          callback(new Error('手机号验证不正确'))\n        }\n      })\n    },\n    // 重置提交\n    handleRegister(e) {\n      e.preventDefault()\n      this.registerInfo.validateFields((err, values) => {\n        if (!err) {\n          const registerObj = {\n            phone: values.username,\n            pwd: values.password,\n            yzm: values.verificationCode\n          }\n          post(api.retrieve, registerObj)\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.error(res.data.msg)\n                return false\n              }\n              if (res.data.code === 0) {\n                this.success()\n                return false\n              }\n            })\n            .catch(err => {\n              console.log(err)\n            })\n          return false\n        }\n        this.$message.error('重置失败')\n      })\n    },\n    handleReset() {\n      this.registerInfo.resetFields()\n    },\n    // 注册成功回调\n    success() {\n      this.$message\n        .success('重置成功', 1)\n        .then(() => {\n          this.$message.loading('跳转登录页面', 1.5)\n        })\n        .then(() => {\n          this.$router.push('/login')\n        })\n    }\n  }\n}\n",{"version":3,"sources":["Retrieve.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Retrieve.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"retrieve\">\n    <div class=\"bg-color\"></div>\n    <div class=\"retrieve-wrapper\" style=\"border: 1px solid #F5F5F5; background: #FFF; box-shadow: #666 0px 0px 10px; padding: 20px; border-radius: 4px;\">\n      <a-divider>找回密码</a-divider>\n      <a-form :form=\"registerInfo\" @submit=\"handleRegister\">\n        <a-form-item>\n          <a-row :gutter=\"14\">\n            <a-col :span=\"16\">\n              <a-input\n                placeholder=\"请输入手机号\"\n                v-decorator=\"[\n              'username',\n              {rules: [{ validator: validateUsername }], validateTrigger: ['change', 'blur']}\n            ]\"\n              >\n                <a-icon slot=\"prefix\" type=\"user\" style=\"color:rgba(0,0,0,.25)\"/>\n              </a-input>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-button\n                :type=\"btnType\"\n                :disabled=\"disabled\"\n                @click=\"sendCode\"\n                class=\"register-sendcode\"\n              >{{ btnText }}</a-button>\n            </a-col>\n          </a-row>\n        </a-form-item>\n\n        <a-form-item>\n          <a-row>\n            <a-col :span=\"24\">\n              <a-input\n                placeholder=\"请输入验证码\"\n                v-decorator=\"[\n              'verificationCode',\n              {rules: [{ required: true, message: '请输入验证码' }], validateTrigger: ['change', 'blur']}\n            ]\"\n              >\n                <a-icon slot=\"prefix\" type=\"safety-certificate\" style=\"color:rgba(0,0,0,.25)\"/>\n              </a-input>\n            </a-col>\n          </a-row>\n        </a-form-item>\n\n        <a-form-item>\n          <a-row>\n            <a-col :span=\"24\">\n              <a-input\n                placeholder=\"请输入重置密码\"\n                type=\"password\"\n                v-decorator=\"[\n              'password',\n              {rules: [{ validator: validatePassword }], validateTrigger: ['blur']}\n            ]\"\n              >\n                <a-icon slot=\"prefix\" type=\"lock\" style=\"color:rgba(0,0,0,.25)\"/>\n              </a-input>\n            </a-col>\n          </a-row>\n        </a-form-item>\n\n        <a-form-item>\n          <a-row>\n            <a-col :span=\"24\">\n              <a-input\n                placeholder=\"请确认密码\"\n                type=\"password\"\n                v-decorator=\"[\n              'rePassword',\n              {rules: [{ required: true, message: '请再次输入密码' }, { validator: validateRePassword }], validateTrigger: ['blur']}\n            ]\"\n              >\n                <a-icon slot=\"prefix\" type=\"lock\" style=\"color:rgba(0,0,0,.25)\"/>\n              </a-input>\n            </a-col>\n          </a-row>\n        </a-form-item>\n\n        <a-form-item :wrapper-col=\"{ span: 24 }\">\n          <a-row :gutter=\"16\">\n            <a-col class=\"gutter-row\" :span=\"24\">\n              <router-link to=\"/user/register\" class=\"login-form-register\">去注册</router-link>\n              <router-link to=\"/user/login\" class=\"login-form-forgot\">返回登录</router-link>\n            </a-col>\n          </a-row>\n        </a-form-item>\n\n        <a-form-item :wrapper-col=\"{ span: 12, offset: 5 }\">\n          <a-button type=\"primary\" html-type=\"submit\">重置密码</a-button>\n          <a-button :style=\"{ marginLeft: '8px' }\" @click=\"handleReset\">清除</a-button>\n        </a-form-item>\n      </a-form>\n    </div>\n  </div>\n</template>\n<script>\nimport { post } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport { factorySendCode } from 'utils/utils.js'\n\nexport default {\n  name: 'Retrieve',\n  data() {\n    return {\n      btnType: 'primary',\n      btnText: '发送验证码',\n      remaining: 5,\n      disabled: false,\n      registerInfo: this.$form.createForm(this),\n      checkAgree: false\n    }\n  },\n  methods: {\n    // 自定义用户名验证\n    validateUsername(rule, value, callback) {\n      const regex = /^1[34578]\\d{9}$/\n      if (!value) {\n        callback(new Error('用户名不能为空'))\n        return false\n      }\n      if (!regex.test(value)) {\n        callback(new Error('请输入正确的手机号'))\n        return false\n      }\n      callback()\n    },\n    validatePassword(rule, value, callback) {\n      const regex = /[^0-9a-zA-Z_]/\n      if (!value) {\n        callback(new Error('密码不能为空'))\n        return false\n      }\n      if (value.length < 6 || value.length > 18) {\n        callback(new Error('密码请在6～18位数之间'))\n        return false\n      }\n      if (regex.test(value)) {\n        callback(new Error('密码不能有特殊字符'))\n        return false\n      }\n      callback()\n    },\n    validateRePassword(rule, value, callback) {\n      const password = this.registerInfo.getFieldValue('password')\n      if (value === undefined) {\n        callback(new Error('请输入密码'))\n      }\n      if (value && password && value.trim() !== password.trim()) {\n        callback(new Error('两次密码不一致'))\n      }\n      callback()\n    },\n    // senCode\n    sendCode() {\n      this.registerInfo.validateFields(['username'], (err, value, callback) => {\n        if (!err) {\n          post(api.reSendCode, { phone: value.username }).then(res => {\n            factorySendCode.call(this, 5)\n          })\n        } else {\n          callback(new Error('手机号验证不正确'))\n        }\n      })\n    },\n    // 重置提交\n    handleRegister(e) {\n      e.preventDefault()\n      this.registerInfo.validateFields((err, values) => {\n        if (!err) {\n          const registerObj = {\n            phone: values.username,\n            pwd: values.password,\n            yzm: values.verificationCode\n          }\n          post(api.retrieve, registerObj)\n            .then(res => {\n              if (res.data.code === 1) {\n                this.$message.error(res.data.msg)\n                return false\n              }\n              if (res.data.code === 0) {\n                this.success()\n                return false\n              }\n            })\n            .catch(err => {\n              console.log(err)\n            })\n          return false\n        }\n        this.$message.error('重置失败')\n      })\n    },\n    handleReset() {\n      this.registerInfo.resetFields()\n    },\n    // 注册成功回调\n    success() {\n      this.$message\n        .success('重置成功', 1)\n        .then(() => {\n          this.$message.loading('跳转登录页面', 1.5)\n        })\n        .then(() => {\n          this.$router.push('/login')\n        })\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.retrieve {\n  position: fixed;\n  width: 400px;\n  min-height: 300px;\n  left: 50%;\n  top: 50%;\n  margin-left: 100px;\n  margin-top: -240px;\n  .bg-color {\n    position: fixed;\n    z-index: -100;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background: url('../../assets/loginBg.png') no-repeat center;\n    background-size: cover;\n  }\n  .register-sendcode {\n    width: 100%;\n  }\n  .register-to-login {\n    float: right;\n    color: #8f939a;\n    font-size: 12px;\n  }\n  .register-to-haslogin {\n    color: #8f939a;\n    font-size: 12px;\n  }\n}\n#components-form-demo-normal-re g .login-form {\n  max-width: 300px;\n}\n.login-form-forgot {\n  float: right;\n}\n#components-form-demo-normal-login .login-form-button {\n  width: 100%;\n}\n</style>\n"]}]}