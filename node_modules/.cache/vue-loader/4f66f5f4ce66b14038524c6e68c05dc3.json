{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/procurement/purchasList/other/newMaterial.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/procurement/purchasList/other/newMaterial.vue","mtime":1563524989354},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport infiniteScroll from 'vue-infinite-scroll'\nimport api from '@/api/index'\nimport { get, post, postJson } from '@/api/axios'\nexport default {\n  directives: { infiniteScroll },\n  data() {\n    return {\n      expandedKeys: [],\n      autoExpandParent: true,\n      gData: [],\n      busy: false,\n      loading: false,\n      currentPage: 1,\n      pages: 1,\n      data: []\n    }\n  },\n  created() {\n    this.getCategoryBomTree()\n  },\n  methods: {\n    onExpand(val) {\n      if (val.length) {\n        this.expandedKeys = val\n        this.data = []\n        this.currentPage = 1\n        this.getQueryMaterialBaseInfo()\n      }\n    },\n    handleInfiniteOnLoad() {\n      this.busy = true\n      this.loading = true\n      if (this.expandedKeys.length) {\n        if (this.currentPage > this.pages) {\n          return\n        } else {\n          this.getQueryMaterialBaseInfo(this.currentPage)\n        }\n        this.busy = false\n        this.loading = false\n      }\n    },\n    // 获取公司所有原材料分类\n    getCategoryBomTree() {\n      get(api.bomCategoryTree).then(res => {\n        if (res.data.code === 0) {\n          const mapObj = {\n            name: 'title',\n            id: 'key',\n            childrens: 'children'\n          }\n          // 全局替换字段名\n          const conversion = JSON.parse(JSON.stringify(res.data.data).replace(/name|id|childrens/gi, function (matched) {\n            return mapObj[matched]\n          }))\n          this.gData = Array.from(conversion)\n        }\n      })\n    },\n    // 获取原材料基本信息\n    getQueryMaterialBaseInfo(currentPage = 1) {\n      const data = {}\n      data.catId = this.expandedKeys[0]\n      data.pageSize = 15\n      data.currentPage = currentPage\n      post(api.getQueryMaterialBaseInfo, data).then(res => {\n        if (res.data.code === 0) {\n          this.currentPage += 1\n          this.data = this.data.concat(res.data.data.records)\n          this.pages = Number(res.data.data.pages)\n        }\n      })\n    },\n    // 添加新材料\n    addMaterial(id, unit) {\n      console.log(1)\n      postJson(api.addMaterialOrderMateriala, { materialId: id, unit: unit }).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success('添加成功')\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["newMaterial.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"newMaterial.vue","sourceRoot":"src/views/procurement/purchasList/other","sourcesContent":["<template>\n  <a-row class=\"material\">\n    <a-col :span=\"12\" class=\"new-material\">\n      <a-tree :treeData=\"gData\" @select=\"onExpand\" :autoExpandParent=\"autoExpandParent\"></a-tree>\n    </a-col>\n    <a-col :span=\"12\" style=\"padding:0 10px\">\n      <div\n        class=\"order-list order-list-item demo-infinite-container\"\n        v-infinite-scroll=\"handleInfiniteOnLoad\"\n        :infinite-scroll-disabled=\"busy\"\n        :infinite-scroll-distance=\"10\"\n      >\n        <a-list :dataSource=\"data\">\n          <a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\n            <div class=\"list-item\" @click=\"addMaterial(item.id,item.unit)\">\n              <div class=\"item-left\">\n                <div class=\"item-left-top\">\n                  <a href=\"javascript:;\">{{item.name}} {{item.code}}</a>\n                </div>\n                <ul class=\"item-left-desc\">\n                  <li>{{item.spec}}</li>\n                  <li>{{item.cz}}</li>\n                  <li>{{item.standard}}</li>\n                </ul>\n              </div>\n              <div class=\"item-right\">\n                <a-button type=\"primary\" shape=\"circle\" icon=\"plus\"></a-button>\n              </div>\n            </div>\n          </a-list-item>\n          <div v-if=\"loading && !busy\" class=\"demo-loading-container\">\n            <a-spin />\n          </div>\n        </a-list>\n      </div>\n    </a-col>\n  </a-row>\n</template>\n\n<script>\nimport infiniteScroll from 'vue-infinite-scroll'\nimport api from '@/api/index'\nimport { get, post, postJson } from '@/api/axios'\nexport default {\n  directives: { infiniteScroll },\n  data() {\n    return {\n      expandedKeys: [],\n      autoExpandParent: true,\n      gData: [],\n      busy: false,\n      loading: false,\n      currentPage: 1,\n      pages: 1,\n      data: []\n    }\n  },\n  created() {\n    this.getCategoryBomTree()\n  },\n  methods: {\n    onExpand(val) {\n      if (val.length) {\n        this.expandedKeys = val\n        this.data = []\n        this.currentPage = 1\n        this.getQueryMaterialBaseInfo()\n      }\n    },\n    handleInfiniteOnLoad() {\n      this.busy = true\n      this.loading = true\n      if (this.expandedKeys.length) {\n        if (this.currentPage > this.pages) {\n          return\n        } else {\n          this.getQueryMaterialBaseInfo(this.currentPage)\n        }\n        this.busy = false\n        this.loading = false\n      }\n    },\n    // 获取公司所有原材料分类\n    getCategoryBomTree() {\n      get(api.bomCategoryTree).then(res => {\n        if (res.data.code === 0) {\n          const mapObj = {\n            name: 'title',\n            id: 'key',\n            childrens: 'children'\n          }\n          // 全局替换字段名\n          const conversion = JSON.parse(JSON.stringify(res.data.data).replace(/name|id|childrens/gi, function (matched) {\n            return mapObj[matched]\n          }))\n          this.gData = Array.from(conversion)\n        }\n      })\n    },\n    // 获取原材料基本信息\n    getQueryMaterialBaseInfo(currentPage = 1) {\n      const data = {}\n      data.catId = this.expandedKeys[0]\n      data.pageSize = 15\n      data.currentPage = currentPage\n      post(api.getQueryMaterialBaseInfo, data).then(res => {\n        if (res.data.code === 0) {\n          this.currentPage += 1\n          this.data = this.data.concat(res.data.data.records)\n          this.pages = Number(res.data.data.pages)\n        }\n      })\n    },\n    // 添加新材料\n    addMaterial(id, unit) {\n      console.log(1)\n      postJson(api.addMaterialOrderMateriala, { materialId: id, unit: unit }).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success('添加成功')\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import \"~styles/dispach.less\";\n.material {\n  overflow: auto;\n  min-height: 60vh;\n  max-height: 60vh;\n}\n.new-material {\n  padding: 0 10px;\n  min-height: 60vh;\n}\n\n.demo-infinite-container {\n  border-left: 1px solid #ccc;\n  min-height: 60vh;\n}\n</style>\n"]}]}