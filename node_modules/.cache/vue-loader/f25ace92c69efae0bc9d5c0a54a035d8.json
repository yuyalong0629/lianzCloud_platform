{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/approval/child_lib/approvalInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/approval/child_lib/approvalInfo.vue","mtime":1563844816523},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport orderInfo from '@/views/sale/orderList/child_lib/orderInfo'\nimport api from '@/api/index'\nimport { get } from '@/api/axios'\nimport Bus from '@/Bus.js'\nexport default {\n  props: ['detial', 'showAction'],\n  components: {\n    orderInfo\n  },\n  data() {\n    return {\n      labelCol: { span: 6 },\n      wrapperCol: { span: 14 },\n      detialList: '',\n      approvalData: [],\n      auditComment: '',\n      approvalStep: 0\n    }\n  },\n  created() {\n    this.getRunProcessDetial()\n  },\n  methods: {\n    onClose() {\n      this.$emit('onClose')\n    },\n    // 获取流程\n    getRunProcessDetial() {\n      const detial = this.detial\n      const data = {}\n      data.defProcessId = detial.foRunProcess.processId\n      data.procesState = detial.foRunProcess.processState\n      data.runProcessId = detial.foRunProcess.id\n      data.version = detial.foRunProcess.version\n      get(api.getRunProcessDetial, data).then(res => {\n        if (res.data.code === 0) {\n          const data = res.data.data\n          this.approvalData = data\n          data.forEach((item, index) => {\n            if (item.approveResultStatus === 'PASS' || item.approveResultStatus === 'NOPASS') {\n              this.approvalStep = index\n            }\n          })\n        }\n      })\n    },\n    // 审核通过/不通过\n    auditApproval(auditResult) {\n      const data = {}\n      data.auditComment = this.auditComment ? this.auditComment : (auditResult === 'PASS' ? '通过' : '不通过')\n      data.auditResult = auditResult\n      data.runProcessId = this.detial.foRunProcess.id\n      data.userId = localStorage.getItem('userId')\n      get(api.setAudit, data).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success('操作成功')\n          this.$emit('onClose')\n          Bus.$emit('ToObtain', true)\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["approvalInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"approvalInfo.vue","sourceRoot":"src/views/approval/child_lib","sourcesContent":["<template>\n  <div class=\"purchase-info\">\n    <div class=\"prompt-title\">\n      <a-row>\n        <a-col :span=\"18\">\n          <h3 class=\"prompt-h3\">流水详情</h3>\n        </a-col>\n        <a-col :span=\"6\" class=\"prompt-wrapper\" v-if=\"!showAction\">\n          <span class=\"prompt-edit\" @click=\"auditApproval('PASS')\" v-if=\"!showAction\">\n            <a-icon type=\"check-circle\" style=\"color:#F0BB2E;margin-right:2px\" />\n            <span>通过</span>\n          </span>\n          <span class=\"prompt-delete\" @click=\"auditApproval('NOPASS')\">\n            <a-icon type=\"close-circle\" style=\"color:#D50304;margin-right:2px\" />\n            <span>不通过</span>\n          </span>\n          <span class=\"prompt-close\" @click=\"onClose\">\n            <a-icon type=\"close\" />\n          </span>\n        </a-col>\n      </a-row>\n    </div>\n    <orderInfo\n      v-if=\"detial.foRunProcess.bizType === 'CHANNEL_SALE_ORDER'\"\n      :approval=\"true\"\n      :editInfo=\"true\"\n      :detialList=\"detial.foRunProcess.bizId\"\n    ></orderInfo>\n    <!-- 审批意见 -->\n    <a-row v-if=\"!showAction\">\n      <a-col :span=\"24\">\n        <h3 class=\"purchase-info-title\">审批意见</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <a-textarea placeholder=\"审批意见\" v-model=\"auditComment\" :rows=\"4\" />\n      </a-col>\n    </a-row>\n    <!-- 审批结果 -->\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"purchase-info-title\">审批流程</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <a-steps :current=\"approvalStep\">\n          <a-step\n            v-for=\"(item,index) in approvalData\"\n            :key=\"index\"\n            :status=\"item.approveResultStatus==='PASS'?'finish':item.approveResultStatus==='NOPASS'?'error':'wait'\"\n          >\n            <span\n              slot=\"title\"\n              class=\"approval-sure\"\n            >{{item.approveResultStatus==='PASS'?'通过':item.approveResultStatus==='NOPASS'?'不通过':'待审'}}</span>\n            <a-icon type=\"user\" slot=\"icon\" style=\"display:none\" />\n            <template slot=\"description\">\n              <div class=\"approval-description\">\n                <p>{{item.names.join('/')}}</p>\n                <template v-if=\"item.taskAuditRecords\">\n                  <template v-if=\"item.names.length == 1\">\n                    <p>{{item.taskAuditRecords[0].auditComment}}</p>\n                    <p>{{item.taskAuditRecords[0].auditorTime | formatDate}}</p>\n                  </template>\n                  <template v-else>\n                    <p\n                      v-for=\"(item,index) in item.taskAuditRecords\"\n                      :key=\"index\"\n                    >{{item.auditorName}} {{item.auditComment}} {{item.auditorTime | formatDate}}</p>\n                  </template>\n                </template>\n              </div>\n            </template>\n          </a-step>\n        </a-steps>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n\n<script>\nimport orderInfo from '@/views/sale/orderList/child_lib/orderInfo'\nimport api from '@/api/index'\nimport { get } from '@/api/axios'\nimport Bus from '@/Bus.js'\nexport default {\n  props: ['detial', 'showAction'],\n  components: {\n    orderInfo\n  },\n  data() {\n    return {\n      labelCol: { span: 6 },\n      wrapperCol: { span: 14 },\n      detialList: '',\n      approvalData: [],\n      auditComment: '',\n      approvalStep: 0\n    }\n  },\n  created() {\n    this.getRunProcessDetial()\n  },\n  methods: {\n    onClose() {\n      this.$emit('onClose')\n    },\n    // 获取流程\n    getRunProcessDetial() {\n      const detial = this.detial\n      const data = {}\n      data.defProcessId = detial.foRunProcess.processId\n      data.procesState = detial.foRunProcess.processState\n      data.runProcessId = detial.foRunProcess.id\n      data.version = detial.foRunProcess.version\n      get(api.getRunProcessDetial, data).then(res => {\n        if (res.data.code === 0) {\n          const data = res.data.data\n          this.approvalData = data\n          data.forEach((item, index) => {\n            if (item.approveResultStatus === 'PASS' || item.approveResultStatus === 'NOPASS') {\n              this.approvalStep = index\n            }\n          })\n        }\n      })\n    },\n    // 审核通过/不通过\n    auditApproval(auditResult) {\n      const data = {}\n      data.auditComment = this.auditComment ? this.auditComment : (auditResult === 'PASS' ? '通过' : '不通过')\n      data.auditResult = auditResult\n      data.runProcessId = this.detial.foRunProcess.id\n      data.userId = localStorage.getItem('userId')\n      get(api.setAudit, data).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success('操作成功')\n          this.$emit('onClose')\n          Bus.$emit('ToObtain', true)\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n@import \"~styles/variable.less\";\n.prompt-title {\n  border-bottom: 1px solid #ebedf0;\n  min-height: 40px;\n  margin-bottom: 10px;\n  .prompt-wrapper {\n    display: flex;\n    justify-content: flex-end;\n    .prompt-edit {\n      margin: 0 10px;\n      cursor: pointer;\n    }\n    .prompt-delete {\n      cursor: pointer;\n      margin-right: 10px;\n    }\n    .prompt-close {\n      cursor: pointer;\n      padding: 0 10px;\n      border-left: 1px solid #d8d8d8;\n    }\n  }\n}\n\n.purchase-info {\n  .purchase-info-title {\n    .h3_title();\n    margin: 20px 0;\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n/deep/.ant-steps-item-title:after {\n  top: 25px;\n}\n.approval-sure {\n  display: block;\n  background: #5077d1;\n  border-radius: 50%;\n  width: 50px;\n  height: 50px;\n  font-size: 14px;\n  text-align: center;\n  line-height: 50px;\n  color: #fff;\n}\n.approval-description {\n  font-size: 12px;\n  margin-top: 5px;\n  p {\n    line-height: 1.2;\n    margin-bottom: 5px;\n    &:first-child {\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n}\n/deep/.ant-steps-item-finish {\n  .approval-description {\n    p {\n      &:first-child {\n        color: #333;\n      }\n    }\n  }\n}\n</style>\n"]}]}