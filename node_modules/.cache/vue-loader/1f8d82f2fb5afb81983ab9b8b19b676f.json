{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/src/views/product/catattr/CatattrInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/src/views/product/catattr/CatattrInfo.vue","mtime":1556420575742},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/platformtmp/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  getListCompanyCustsAndCompanySelf,\n  catattrForm,\n  getCustList,\n  onSave\n} from './catattr.js'\nimport { setTimeout } from 'timers'\n// import { setTimeout } from 'timers'\n\nexport default {\n  name: 'CatattrInfo',\n  data() {\n    return {\n      loading: false,\n      catattrInfo: this.$form.createForm(this),\n      categoryEdit: '点击编辑',\n      isDisabled: false,\n      catattrCustData: [],\n      getcatattrCustData: {\n        key: '',\n        label: ''\n      },\n      getcatattrCustDataID: '',\n      cataattrCustClass: [],\n      options: [],\n      isOptional: false,\n      searchProp: false,\n      listProp: false,\n      required: false,\n      inputType: 'INPUT',\n      valType: 'STRING',\n      catattrOptional: '',\n      labelList: [],\n      getViewCatattrInfo: null,\n      timer: null\n    }\n  },\n  props: {\n    isEdit: {\n      type: Boolean,\n      default: false\n    },\n    viewCatattrInfo: {\n      type: Object,\n      default: function() {\n        return {}\n      }\n    }\n  },\n  created() {\n    // 获取所有客户和公司\n    getListCompanyCustsAndCompanySelf\n      .call(this)\n      .then(() => {\n        // 设置所有客户/公司默认值\n        this.getcatattrCustData.label = this.catattrCustData[0].custShortName\n        this.getcatattrCustData.key = this.catattrCustData[0].id\n        // 拿到默认ID\n        this.getcatattrCustDataID = this.catattrCustData[0].id\n        // console.log(this.getcatattrCustDataID)\n      })\n      .then(() => {\n        // 设置客户分类初始化选中状态\n        getCustList.call(this, this.getcatattrCustDataID).then(() => {\n          this.cataattrCustClass = [this.options[0].id]\n        })\n      })\n  },\n  mounted() {\n    if (this.isCategoryEdit) {\n      this.isDisabled = false\n      return false\n    }\n    this.isDisabled = true\n  },\n  beforeDestroy() {\n    // 清空定时器\n    // clearTimeout(this.timer)\n  },\n  watch: {\n    viewCatattrInfo: {\n      handler: function(val) {\n        this.getViewCatattrInfo = val\n        this.showViewCatattrInfo()\n      },\n      deep: true\n    }\n  },\n  computed: {\n    isCategoryEdit() {\n      return this.isEdit\n    }\n  },\n  methods: {\n    // 产品分类详情信息展示watch\n    showViewCatattrInfo() {\n      // console.log(this.getViewCatattrInfo)\n      // console.log(this.catattrCustData)\n      this.timer = setTimeout(() => {\n        // 根据客户ID查找对应客户名称\n        const getCatattrCustName = this.catattrCustData.filter(item => {\n          return item.id === this.getViewCatattrInfo.custId\n        })\n        this.getcatattrCustData.label = getCatattrCustName[0].custShortName\n        // 所属分类显示\n        const option1 = '7804932389592379392'\n        const option2 = '7804932787992539136'\n        const option3 = '7804932964346245120'\n        this.cataattrCustClass = [option1, option2, option3]\n        this.catattrInfo.setFieldsValue({\n          // 属性名称\n          catattrName: this.getViewCatattrInfo.name,\n          // 计量单位\n          catattrUnit: this.getViewCatattrInfo.unit,\n          // 备注\n          catattrRemark: this.getViewCatattrInfo.remark\n        })\n        // 输入类型\n        if (this.getViewCatattrInfo.inputType === 'INPUT') {\n          this.inputType = 'RADIO'\n          this.isOptional = true\n        }\n        if (this.getViewCatattrInfo.inputType === 'RADIO') {\n          this.inputType = 'CHECKBOX'\n          this.isOptional = true\n        }\n        if (this.getViewCatattrInfo.inputType === 'CHECKBOX') {\n          this.inputType = 'INPUT'\n          this.isOptional = false\n        }\n        // 值的类型\n        if (this.getViewCatattrInfo.valType === 'STRING') {\n          this.inputType = 'RADIO'\n        }\n        if (this.getViewCatattrInfo.inputType === 'NUMBER') {\n          this.inputType = 'CHECKBOX'\n        }\n        if (this.getViewCatattrInfo.inputType === 'DECIMAL') {\n          this.inputType = 'INPUT'\n        }\n        // 可选项\n        this.labelList.concat(this.getViewCatattrInfo.optionList)\n        // 是否搜索属性\n        this.searchProp = this.getViewCatattrInfo.searchProp\n        // 是否列表属性\n        this.listProp = this.getViewCatattrInfo.listProp\n        // 是否必填\n        this.required = this.getViewCatattrInfo.required\n      }, 500)\n    },\n    // 一级新建列表遮罩显示\n    onClose() {\n      this.isVisible = false\n      this.$emit('isVisible', this.isVisible)\n    },\n    // 所属客户二级联动\n    handleProvinceChange(value) {\n      console.log(value)\n      this.getcatattrCustData.label = value.label\n      this.getcatattrCustData.key = value.key\n      getCustList.call(this, value.key).then(() => {\n        // 判断分类是否存在\n        const firstClass = this.options.length === 0 ? '' : this.options[0].id\n        // const secondClass =\n        //   this.options.length !== 0 && this.options[0].childrens !== null\n        //     ? this.options[0].childrens[0].id\n        //     : ''\n        // const thirdClass =\n        //   this.options.length !== 0 &&\n        //   this.options[0].childrens !== null &&\n        //   this.options[0].childrens[0].childrens !== null\n        //     ? this.options[0].childrens[0].childrens[0].id\n        //     : ''\n        this.cataattrCustClass = [firstClass]\n      })\n    },\n    // 所属分类级联选择\n    onChangeCataattrName(value) {\n      console.log(value)\n      this.cataattrCustClass = value\n    },\n    // 输入类型\n    handleChangeInputType(value) {\n      console.log(value)\n      this.inputType = value\n      if (value === 'RADIO' || value === 'CHECKBOX') {\n        this.isOptional = true\n        return false\n      }\n      // 手动输入清空数组\n      this.labelList = []\n      this.isOptional = false\n    },\n    // 值的类型\n    handleChangeInputValue(value) {\n      this.valType = value\n    },\n    // 是否搜索属性\n    onChangeSearch(checked) {\n      console.log(checked)\n      this.searchProp = checked\n    },\n    // 是否列表属性\n    onChangeListAttr(checked) {\n      console.log(checked)\n      this.listProp = checked\n    },\n    // 是否必填\n    onChangeDefault(checked) {\n      console.log(checked)\n      this.required = checked\n    },\n    // 新增信息提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.catattrInfo.validateFields((err, values) => {\n        if (!err) {\n          this.loading = true\n          const params = {\n            custId: this.getcatattrCustData.key, // 所属客户\n            catId: Array.from(this.cataattrCustClass)\n              .slice(-1)\n              .join(''), // 所属类目\n            name: values.catattrName, // 属性名称\n            searchProp: this.searchProp, // 是否搜索属性\n            listProp: this.listProp, // 是否列表属性\n            required: this.required, // 是否必填\n            inputType: this.inputType.toString(), // 输入类型\n            valType: this.valType.toString(), // 值类型\n            unit: values.catattrUnit, // 计量单位\n            optionList: Array.from(this.labelList), // 可选项\n            attrType: '', // 属性类型\n            remark: values.catattrRemark // 属性类型\n          }\n          console.log(params)\n          catattrForm.call(this, params)\n        }\n      })\n    },\n    // 详情页编辑\n    onHandleCategoryEdit() {\n      // 上级分类隐藏域\n      if (this.categoryEdit === '点击编辑') {\n        this.isDisabled = true\n        this.categoryEdit = '取消编辑'\n        return false\n      }\n      this.isDisabled = false\n      this.categoryEdit = '点击编辑'\n    },\n    // 删除\n    onhandleDeleteCategoty() {\n      // const that = this\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          console.log('ok')\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 保存修改\n    onEditSave(e) {\n      e.preventDefault()\n      this.catattrInfo.validateFields((err, values) => {\n        if (!err) {\n          this.loading = true\n          const params = {\n            id: this.getViewCatattrInfo.id,\n            custId: this.getcatattrCustData.key, // 所属客户\n            catId: Array.from(this.cataattrCustClass)\n              .slice(-1)\n              .join(''), // 所属类目\n            name: values.catattrName, // 属性名称\n            searchProp: this.searchProp, // 是否搜索属性\n            listProp: this.listProp, // 是否列表属性\n            required: this.required, // 是否必填\n            inputType: this.inputType.toString(), // 输入类型\n            valType: this.valType.toString(), // 值类型\n            unit: values.catattrUnit, // 计量单位\n            optionList: Array.from(this.labelList), // 可选项\n            attrType: '', // 属性类型\n            remark: values.catattrRemark // 属性类型\n          }\n          console.log(params)\n          onSave.call(this, params)\n        }\n      })\n    },\n    // 可选项键盘添加标签\n    onAddLabel() {\n      if (this.catattrOptional !== '') {\n        this.labelList.push({\n          val: this.catattrOptional\n        })\n        console.log(this.labelList)\n        this.catattrOptional = ''\n      }\n    },\n    // 删除标签\n    closeLabel(index) {\n      console.log(index)\n      this.labelList.splice(index, 1)\n      console.log(this.labelList)\n    }\n  }\n}\n",{"version":3,"sources":["CatattrInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CatattrInfo.vue","sourceRoot":"src/views/product/catattr","sourcesContent":["<template>\n  <div class=\"catattrInfo\">\n    <a-form :form=\"catattrInfo\" layout=\"horizontal\">\n      <a-row :gutter=\"16\">\n        <a-col :span=\"24\" class=\"categoryEdit-wrapper\" v-if=\"isCategoryEdit\">\n          <a-button\n            type=\"danger\"\n            size=\"small\"\n            @click=\"onhandleDeleteCategoty\"\n            class=\"categoryDetele\"\n          >删除</a-button>\n          <a-button\n            type=\"primary\"\n            size=\"small\"\n            @click=\"onHandleCategoryEdit\"\n            class=\"categoryEdit\"\n          >{{ categoryEdit }}</a-button>\n        </a-col>\n        <a-col :span=\"24\">\n          <h3 class=\"cateGoryInfo-title\">基本信息</h3>\n        </a-col>\n        <a-col :span=\"24\">\n          <a-row>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"所属客户\"\n                :label-col=\"{ span: 8, offset: 4 }\"\n                :wrapper-col=\"{ span: 12 }\"\n              >\n                <a-select\n                  :value=\"{ key: getcatattrCustData.label }\"\n                  labelInValue\n                  :disabled=\"!isDisabled\"\n                  style=\"width: 160px\"\n                  @change=\"handleProvinceChange\"\n                >\n                  <a-select-option\n                    v-for=\"(item) of catattrCustData\"\n                    :key=\"item.id\"\n                  >{{ item.custShortName }}</a-select-option>\n                </a-select>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"12\">\n              <a-form-item label=\"所属分类\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 18 }\">\n                <a-cascader\n                  :value=\"cataattrCustClass\"\n                  :options=\"options\"\n                  :disabled=\"!isDisabled\"\n                  :fieldNames=\"{ label: 'name', value: 'id', children: 'childrens' }\"\n                  @change=\"onChangeCataattrName\"\n                  placeholder=\"请输入分类名称\"\n                  changeOnSelect\n                />\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-col>\n        <a-col :span=\"24\">\n          <a-form-item label=\"属性名称\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 10 }\">\n            <a-input\n              v-decorator=\"[\n                  'catattrName',\n                  {rules: [{ required: true, message: '请输入属性名称' }]}\n                ]\"\n              placeholder=\"请输入属性名称\"\n              :disabled=\"!isDisabled\"\n            />\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"24\">\n          <a-row>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"输入类型\"\n                :label-col=\"{ span: 8, offset: 4 }\"\n                :wrapper-col=\"{ span: 12 }\"\n              >\n                <a-select\n                  :disabled=\"!isDisabled\"\n                  defaultValue=\"INPUT\"\n                  style=\"width: 160px\"\n                  @change=\"handleChangeInputType\"\n                >\n                  <a-select-option value=\"INPUT\">手输</a-select-option>\n                  <a-select-option value=\"RADIO\">单选</a-select-option>\n                  <a-select-option value=\"CHECKBOX\">多选</a-select-option>\n                </a-select>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item label=\"值的类型\" :label-col=\"{ span: 6 }\" :wrapper-col=\"{ span: 10 }\">\n                <a-select\n                  :disabled=\"!isDisabled\"\n                  defaultValue=\"STRING\"\n                  style=\"width: 160px\"\n                  @change=\"handleChangeInputValue\"\n                >\n                  <a-select-option value=\"STRING\">字符串</a-select-option>\n                  <a-select-option value=\"NUMBER\">整数</a-select-option>\n                  <a-select-option value=\"DECIMAL\">浮点数</a-select-option>\n                </a-select>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"6\" style=\"marginLeft: -80px;\">\n              <a-form-item label=\"计量单位\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 12 }\">\n                <a-input\n                  :disabled=\"!isDisabled\"\n                  v-decorator=\"['catattrUnit']\"\n                  placeholder=\"请输入计量单位\"\n                />\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-col>\n        <a-col :span=\"24\" v-if=\"isOptional\">\n          <a-form-item label=\"可选项\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 10 }\">\n            <a-input\n              v-model.trim=\"catattrOptional\"\n              @keyup.space=\"onAddLabel\"\n              placeholder=\"请按空格键生成标签\"\n              :disabled=\"!isDisabled\"\n            />\n            <ul class=\"label-box\">\n              <li v-for=\"(item, index) in labelList\" :key=\"index\" class=\"create-label\">\n                <span>{{ item.val }}</span>\n                <a-icon type=\"close\" @click=\"closeLabel(index)\"/>\n              </li>\n            </ul>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"24\">\n          <a-row>\n            <a-col :span=\"6\">\n              <a-form-item\n                label=\"是否搜索属性\"\n                :label-col=\"{ span: 10, offset: 6 }\"\n                :wrapper-col=\"{ span: 8 }\"\n              >\n                <a-switch :disabled=\"!isDisabled\" @change=\"onChangeSearch\"/>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"6\">\n              <a-form-item\n                label=\"是否列表属性\"\n                :label-col=\"{ span: 10, offset: 3 }\"\n                :wrapper-col=\"{ span: 8 }\"\n              >\n                <a-switch :disabled=\"!isDisabled\" @change=\"onChangeListAttr\"/>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"6\">\n              <a-form-item label=\"是否必填\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 4 }\">\n                <a-switch :disabled=\"!isDisabled\" @change=\"onChangeDefault\"/>\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-col>\n        <a-col :span=\"24\">\n          <a-form-item label=\"备注\" :label-col=\"{ span: 4 }\" :wrapper-col=\"{ span: 10 }\">\n            <a-input :disabled=\"!isDisabled\" v-decorator=\"['catattrRemark']\" placeholder=\"请输入备注\"/>\n          </a-form-item>\n        </a-col>\n      </a-row>\n    </a-form>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #e9e9e9',\n          padding: '10px 16px',\n          background: '#fff',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" v-if=\"!isCategoryEdit\" :loading=\"loading\">提交</a-button>\n      <a-button\n        @click=\"onEditSave\"\n        type=\"primary\"\n        v-if=\"isCategoryEdit\"\n        :disabled=\"!isDisabled\"\n        :loading=\"loading\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport {\n  getListCompanyCustsAndCompanySelf,\n  catattrForm,\n  getCustList,\n  onSave\n} from './catattr.js'\nimport { setTimeout } from 'timers'\n// import { setTimeout } from 'timers'\n\nexport default {\n  name: 'CatattrInfo',\n  data() {\n    return {\n      loading: false,\n      catattrInfo: this.$form.createForm(this),\n      categoryEdit: '点击编辑',\n      isDisabled: false,\n      catattrCustData: [],\n      getcatattrCustData: {\n        key: '',\n        label: ''\n      },\n      getcatattrCustDataID: '',\n      cataattrCustClass: [],\n      options: [],\n      isOptional: false,\n      searchProp: false,\n      listProp: false,\n      required: false,\n      inputType: 'INPUT',\n      valType: 'STRING',\n      catattrOptional: '',\n      labelList: [],\n      getViewCatattrInfo: null,\n      timer: null\n    }\n  },\n  props: {\n    isEdit: {\n      type: Boolean,\n      default: false\n    },\n    viewCatattrInfo: {\n      type: Object,\n      default: function() {\n        return {}\n      }\n    }\n  },\n  created() {\n    // 获取所有客户和公司\n    getListCompanyCustsAndCompanySelf\n      .call(this)\n      .then(() => {\n        // 设置所有客户/公司默认值\n        this.getcatattrCustData.label = this.catattrCustData[0].custShortName\n        this.getcatattrCustData.key = this.catattrCustData[0].id\n        // 拿到默认ID\n        this.getcatattrCustDataID = this.catattrCustData[0].id\n        // console.log(this.getcatattrCustDataID)\n      })\n      .then(() => {\n        // 设置客户分类初始化选中状态\n        getCustList.call(this, this.getcatattrCustDataID).then(() => {\n          this.cataattrCustClass = [this.options[0].id]\n        })\n      })\n  },\n  mounted() {\n    if (this.isCategoryEdit) {\n      this.isDisabled = false\n      return false\n    }\n    this.isDisabled = true\n  },\n  beforeDestroy() {\n    // 清空定时器\n    // clearTimeout(this.timer)\n  },\n  watch: {\n    viewCatattrInfo: {\n      handler: function(val) {\n        this.getViewCatattrInfo = val\n        this.showViewCatattrInfo()\n      },\n      deep: true\n    }\n  },\n  computed: {\n    isCategoryEdit() {\n      return this.isEdit\n    }\n  },\n  methods: {\n    // 产品分类详情信息展示watch\n    showViewCatattrInfo() {\n      // console.log(this.getViewCatattrInfo)\n      // console.log(this.catattrCustData)\n      this.timer = setTimeout(() => {\n        // 根据客户ID查找对应客户名称\n        const getCatattrCustName = this.catattrCustData.filter(item => {\n          return item.id === this.getViewCatattrInfo.custId\n        })\n        this.getcatattrCustData.label = getCatattrCustName[0].custShortName\n        // 所属分类显示\n        const option1 = '7804932389592379392'\n        const option2 = '7804932787992539136'\n        const option3 = '7804932964346245120'\n        this.cataattrCustClass = [option1, option2, option3]\n        this.catattrInfo.setFieldsValue({\n          // 属性名称\n          catattrName: this.getViewCatattrInfo.name,\n          // 计量单位\n          catattrUnit: this.getViewCatattrInfo.unit,\n          // 备注\n          catattrRemark: this.getViewCatattrInfo.remark\n        })\n        // 输入类型\n        if (this.getViewCatattrInfo.inputType === 'INPUT') {\n          this.inputType = 'RADIO'\n          this.isOptional = true\n        }\n        if (this.getViewCatattrInfo.inputType === 'RADIO') {\n          this.inputType = 'CHECKBOX'\n          this.isOptional = true\n        }\n        if (this.getViewCatattrInfo.inputType === 'CHECKBOX') {\n          this.inputType = 'INPUT'\n          this.isOptional = false\n        }\n        // 值的类型\n        if (this.getViewCatattrInfo.valType === 'STRING') {\n          this.inputType = 'RADIO'\n        }\n        if (this.getViewCatattrInfo.inputType === 'NUMBER') {\n          this.inputType = 'CHECKBOX'\n        }\n        if (this.getViewCatattrInfo.inputType === 'DECIMAL') {\n          this.inputType = 'INPUT'\n        }\n        // 可选项\n        this.labelList.concat(this.getViewCatattrInfo.optionList)\n        // 是否搜索属性\n        this.searchProp = this.getViewCatattrInfo.searchProp\n        // 是否列表属性\n        this.listProp = this.getViewCatattrInfo.listProp\n        // 是否必填\n        this.required = this.getViewCatattrInfo.required\n      }, 500)\n    },\n    // 一级新建列表遮罩显示\n    onClose() {\n      this.isVisible = false\n      this.$emit('isVisible', this.isVisible)\n    },\n    // 所属客户二级联动\n    handleProvinceChange(value) {\n      console.log(value)\n      this.getcatattrCustData.label = value.label\n      this.getcatattrCustData.key = value.key\n      getCustList.call(this, value.key).then(() => {\n        // 判断分类是否存在\n        const firstClass = this.options.length === 0 ? '' : this.options[0].id\n        // const secondClass =\n        //   this.options.length !== 0 && this.options[0].childrens !== null\n        //     ? this.options[0].childrens[0].id\n        //     : ''\n        // const thirdClass =\n        //   this.options.length !== 0 &&\n        //   this.options[0].childrens !== null &&\n        //   this.options[0].childrens[0].childrens !== null\n        //     ? this.options[0].childrens[0].childrens[0].id\n        //     : ''\n        this.cataattrCustClass = [firstClass]\n      })\n    },\n    // 所属分类级联选择\n    onChangeCataattrName(value) {\n      console.log(value)\n      this.cataattrCustClass = value\n    },\n    // 输入类型\n    handleChangeInputType(value) {\n      console.log(value)\n      this.inputType = value\n      if (value === 'RADIO' || value === 'CHECKBOX') {\n        this.isOptional = true\n        return false\n      }\n      // 手动输入清空数组\n      this.labelList = []\n      this.isOptional = false\n    },\n    // 值的类型\n    handleChangeInputValue(value) {\n      this.valType = value\n    },\n    // 是否搜索属性\n    onChangeSearch(checked) {\n      console.log(checked)\n      this.searchProp = checked\n    },\n    // 是否列表属性\n    onChangeListAttr(checked) {\n      console.log(checked)\n      this.listProp = checked\n    },\n    // 是否必填\n    onChangeDefault(checked) {\n      console.log(checked)\n      this.required = checked\n    },\n    // 新增信息提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.catattrInfo.validateFields((err, values) => {\n        if (!err) {\n          this.loading = true\n          const params = {\n            custId: this.getcatattrCustData.key, // 所属客户\n            catId: Array.from(this.cataattrCustClass)\n              .slice(-1)\n              .join(''), // 所属类目\n            name: values.catattrName, // 属性名称\n            searchProp: this.searchProp, // 是否搜索属性\n            listProp: this.listProp, // 是否列表属性\n            required: this.required, // 是否必填\n            inputType: this.inputType.toString(), // 输入类型\n            valType: this.valType.toString(), // 值类型\n            unit: values.catattrUnit, // 计量单位\n            optionList: Array.from(this.labelList), // 可选项\n            attrType: '', // 属性类型\n            remark: values.catattrRemark // 属性类型\n          }\n          console.log(params)\n          catattrForm.call(this, params)\n        }\n      })\n    },\n    // 详情页编辑\n    onHandleCategoryEdit() {\n      // 上级分类隐藏域\n      if (this.categoryEdit === '点击编辑') {\n        this.isDisabled = true\n        this.categoryEdit = '取消编辑'\n        return false\n      }\n      this.isDisabled = false\n      this.categoryEdit = '点击编辑'\n    },\n    // 删除\n    onhandleDeleteCategoty() {\n      // const that = this\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          console.log('ok')\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 保存修改\n    onEditSave(e) {\n      e.preventDefault()\n      this.catattrInfo.validateFields((err, values) => {\n        if (!err) {\n          this.loading = true\n          const params = {\n            id: this.getViewCatattrInfo.id,\n            custId: this.getcatattrCustData.key, // 所属客户\n            catId: Array.from(this.cataattrCustClass)\n              .slice(-1)\n              .join(''), // 所属类目\n            name: values.catattrName, // 属性名称\n            searchProp: this.searchProp, // 是否搜索属性\n            listProp: this.listProp, // 是否列表属性\n            required: this.required, // 是否必填\n            inputType: this.inputType.toString(), // 输入类型\n            valType: this.valType.toString(), // 值类型\n            unit: values.catattrUnit, // 计量单位\n            optionList: Array.from(this.labelList), // 可选项\n            attrType: '', // 属性类型\n            remark: values.catattrRemark // 属性类型\n          }\n          console.log(params)\n          onSave.call(this, params)\n        }\n      })\n    },\n    // 可选项键盘添加标签\n    onAddLabel() {\n      if (this.catattrOptional !== '') {\n        this.labelList.push({\n          val: this.catattrOptional\n        })\n        console.log(this.labelList)\n        this.catattrOptional = ''\n      }\n    },\n    // 删除标签\n    closeLabel(index) {\n      console.log(index)\n      this.labelList.splice(index, 1)\n      console.log(this.labelList)\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.catattrInfo {\n  margin-bottom: 50px;\n  .cateGoryInfo-title {\n    .h3_title();\n  }\n  .categoryDetele {\n    float: right;\n    margin-left: 10px;\n  }\n  .categoryEdit {\n    float: right;\n  }\n  .label-box {\n    margin-bottom: 0;\n    .create-label {\n      background: #1890ff;\n      color: #fff;\n      border-radius: 4px;\n      display: inline-block;\n      height: 24px;\n      line-height: 12px;\n      padding: 6px;\n      margin: 0 4px;\n      i {\n        font-size: 10px;\n        margin-left: 4px;\n      }\n    }\n  }\n}\n</style>\n"]}]}