{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/craft/process/child_info/ProcessInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/craft/process/child_info/ProcessInfo.vue","mtime":1563242200001},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport PromptTitle from '@/components/tools/prompt/PromptTitle'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport {\n  postProcessAdd,\n  processUpdate,\n  deProcessDelete\n} from '../basic_lib/index'\nimport { setTimeout } from 'timers'\n\nexport default {\n  name: 'ProcessInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      processFormInfo: this.$form.createForm(this),\n      previewVisible: false,\n      previewImage: '',\n      // url\n      fileList: [],\n      headers: {\n        'AUTH-TOKEN': localStorage.getItem('ACCESS_TOKEN'),\n        companyId: localStorage.getItem('companyId')\n      },\n      // Info接收\n      getProcessInfo: {}\n    }\n  },\n  props: {\n    processInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  methods: {\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData(\n        null,\n        this.fileList.length ? this.fileList[0].response.data : '',\n        postProcessAdd\n      )\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData(\n        this.getProcessInfo.id,\n        this.fileList.length ? this.fileList[0].url : '',\n        processUpdate\n      )\n    },\n    // 编辑 || 取消\n    isDisabled(val) {\n      const edit = new Promise(resolved => {\n        // Input选中\n        this.disabled = !val\n        // label color\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    },\n    // 删除\n    isDelete(val) {\n      deProcessDelete.call(this, [this.processInfo.id])\n    },\n    // upload\n    handleCancel() {\n      this.previewVisible = false\n    },\n    handlePreview(file) {\n      this.previewImage = file.url || file.thumbUrl\n      this.previewVisible = true\n    },\n    handleChange({ file, fileList }) {\n      this.fileList = fileList\n    },\n    // Form\n    getFormData(id, fileList, postFormData) {\n      this.processFormInfo.validateFields((err, values) => {\n        if (!err) {\n          console.log(this.fileList)\n          this.loading = true\n          const params = {\n            // code: '', // 工序编码\n            id,\n            name: values.processName, // 工序名称\n            optBook: this.fileList.length > 0 ? fileList : '',\n            // qc: values.processInspection, // 是否质检\n            remark: values.processRemark, // 备注\n            standardHours: values.processWorkHours, // 标准工时\n            timeBilling: values.processBilling // 工时计费\n          }\n          console.log(params)\n          postFormData.call(this, params)\n        }\n      })\n    },\n    // Info\n    setFormData() {\n      this.processFormInfo.setFieldsValue({\n        processName: this.getProcessInfo.name, // 工序名称\n        processInspection: this.getProcessInfo.qc, // 是否质检\n        processRemark: this.getProcessInfo.remark, // 备注\n        processWorkHours: this.getProcessInfo.standardHours, // 标准工时\n        processBilling: this.getProcessInfo.timeBilling // 工时计费\n      })\n    }\n  },\n  computed: {\n    getDetailPermission() {\n      return this.$store.state.detailPermission\n    }\n  },\n  watch: {\n    processInfo: {\n      handler(val) {\n        console.log(val)\n        this.getProcessInfo = val\n        // 判断是否有图片\n        if (val && val.optBook) {\n          this.fileList = [\n            {\n              url: val.optBook,\n              uid: '-1',\n              name: 'xxx.png'\n            }\n          ]\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n}\n",{"version":3,"sources":["ProcessInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ProcessInfo.vue","sourceRoot":"src/views/product/craft/process/child_info","sourcesContent":["<template>\n  <div class=\"process-info\">\n    <prompt-title @isDisabled=\"isDisabled\" @isDelete=\"isDelete\"></prompt-title>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"process-title\">基础信息</h3>\n      </a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <a-form :form=\"processFormInfo\" layout=\"horizontal\" hideRequiredMark>\n          <a-row>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工序编码\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input\n                  v-if=\"disabled\"\n                  disabled=\"disabled\"\n                  v-decorator=\"['processCode']\"\n                  placeholder=\"默认带出\"\n                />\n                <template v-else=\"disabled\">{{getProcessInfo.code}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工序名称\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input\n                  v-if=\"disabled\"\n                  v-decorator=\"['processName', {rules: [{ required: true, message: '请输入工序名称' }]}]\"\n                  placeholder=\"请输入工序名称\"\n                />\n                <template v-else=\"disabled\">{{getProcessInfo.name}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"标准工时\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processWorkHours']\" placeholder=\"请输入标准工时\" />\n                <template v-else=\"disabled\">{{getProcessInfo.standardHours}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工时计费\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processBilling']\" placeholder=\"请输入工时计费\" />\n                <template v-else=\"disabled\">{{getProcessInfo.timeBilling}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"备注\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processRemark']\" placeholder=\"请输入备注\" />\n                <template v-else=\"disabled\">{{getProcessInfo.remark}}</template>\n              </a-form-item>\n            </a-col>\n            <!-- <a-col :span=\"8\">\n              <a-form-item\n                label=\"是否质检\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-switch\n                  v-if=\"disabled\"\n                  v-decorator=\"['processInspection', { initialValue: false, valuePropName: 'checked' }]\"\n                />\n                <template v-else=\"disabled\">{{getProcessInfo.qc ? '屎' : '否'}}</template>\n              </a-form-item>\n            </a-col>-->\n          </a-row>\n        </a-form>\n      </a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"process-title\">文件</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <div class=\"clearfix\" style=\"marginLeft: 16px;\">\n          <a-upload\n            action=\"/api/ic/user/file/uploadFile\"\n            listType=\"picture-card\"\n            :data=\"{'bizType': 'GOODS'}\"\n            :headers=\"headers\"\n            :fileList=\"fileList\"\n            @preview=\"handlePreview\"\n            @change=\"handleChange\"\n          >\n            <div v-if=\"fileList.length < 1\">\n              <a-icon type=\"plus\" />\n              <div class=\"ant-upload-text\">Upload</div>\n            </div>\n          </a-upload>\n          <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n            <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\" />\n          </a-modal>\n        </div>\n      </a-col>\n    </a-row>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-show=\"getDetailPermission.includes('UPDATE')\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport PromptTitle from '@/components/tools/prompt/PromptTitle'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport {\n  postProcessAdd,\n  processUpdate,\n  deProcessDelete\n} from '../basic_lib/index'\nimport { setTimeout } from 'timers'\n\nexport default {\n  name: 'ProcessInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      processFormInfo: this.$form.createForm(this),\n      previewVisible: false,\n      previewImage: '',\n      // url\n      fileList: [],\n      headers: {\n        'AUTH-TOKEN': localStorage.getItem('ACCESS_TOKEN'),\n        companyId: localStorage.getItem('companyId')\n      },\n      // Info接收\n      getProcessInfo: {}\n    }\n  },\n  props: {\n    processInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  methods: {\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData(\n        null,\n        this.fileList.length ? this.fileList[0].response.data : '',\n        postProcessAdd\n      )\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData(\n        this.getProcessInfo.id,\n        this.fileList.length ? this.fileList[0].url : '',\n        processUpdate\n      )\n    },\n    // 编辑 || 取消\n    isDisabled(val) {\n      const edit = new Promise(resolved => {\n        // Input选中\n        this.disabled = !val\n        // label color\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    },\n    // 删除\n    isDelete(val) {\n      deProcessDelete.call(this, [this.processInfo.id])\n    },\n    // upload\n    handleCancel() {\n      this.previewVisible = false\n    },\n    handlePreview(file) {\n      this.previewImage = file.url || file.thumbUrl\n      this.previewVisible = true\n    },\n    handleChange({ file, fileList }) {\n      this.fileList = fileList\n    },\n    // Form\n    getFormData(id, fileList, postFormData) {\n      this.processFormInfo.validateFields((err, values) => {\n        if (!err) {\n          console.log(this.fileList)\n          this.loading = true\n          const params = {\n            // code: '', // 工序编码\n            id,\n            name: values.processName, // 工序名称\n            optBook: this.fileList.length > 0 ? fileList : '',\n            // qc: values.processInspection, // 是否质检\n            remark: values.processRemark, // 备注\n            standardHours: values.processWorkHours, // 标准工时\n            timeBilling: values.processBilling // 工时计费\n          }\n          console.log(params)\n          postFormData.call(this, params)\n        }\n      })\n    },\n    // Info\n    setFormData() {\n      this.processFormInfo.setFieldsValue({\n        processName: this.getProcessInfo.name, // 工序名称\n        processInspection: this.getProcessInfo.qc, // 是否质检\n        processRemark: this.getProcessInfo.remark, // 备注\n        processWorkHours: this.getProcessInfo.standardHours, // 标准工时\n        processBilling: this.getProcessInfo.timeBilling // 工时计费\n      })\n    }\n  },\n  computed: {\n    getDetailPermission() {\n      return this.$store.state.detailPermission\n    }\n  },\n  watch: {\n    processInfo: {\n      handler(val) {\n        console.log(val)\n        this.getProcessInfo = val\n        // 判断是否有图片\n        if (val && val.optBook) {\n          this.fileList = [\n            {\n              url: val.optBook,\n              uid: '-1',\n              name: 'xxx.png'\n            }\n          ]\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.process-info {\n  .process-title {\n    margin-bottom: 16px;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>\n"]}]}