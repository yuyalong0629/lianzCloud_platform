{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/sale/orderList/Order.vue?vue&type=style&index=0&id=7f0c31c2&lang=less&scoped=true&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/sale/orderList/Order.vue","mtime":1563524989357},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/less-loader/dist/cjs.js","mtime":1556420627437},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import \"~styles/variable.less\";\n\n.order {\n  .order-add {\n    .order-remove {\n      margin: 0 20px;\n    }\n    .order-derive {\n      color: #6bc67b;\n      margin-right: 5px;\n    }\n    .delete-btn {\n      margin: 0 20px;\n      cursor: pointer;\n      .delete-icon {\n        color: #f00;\n        margin-right: 3px;\n      }\n    }\n  }\n  .order-select {\n    margin: 20px 0 0;\n    .order-select-reset {\n      margin: 0 8px;\n    }\n  }\n}\n.status-color {\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  // text-align: center\n}\n.status-green {\n  background-color: #6bc67b;\n}\n.status-gray {\n  background-color: #d8d8d8;\n}\n.status-red {\n  background-color: #f5222d;\n}\n.status-yellow {\n  background-color: yellow;\n}\n",{"version":3,"sources":["Order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgQA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Order.vue","sourceRoot":"src/views/sale/orderList","sourcesContent":["<template>\n  <div class=\"order\">\n    <!-- 头部选择区 -->\n    <div class=\"order-add\">\n      <a-button type=\"primary\" @click=\"orderInfo('-1')\" v-show=\"getMenuPermission.includes('ADD')\">\n        <a-icon type=\"plus\" />新建\n      </a-button>\n      <span class=\"delete-btn\" @click=\"deleteOrder\" v-show=\"getMenuPermission.includes('DELETES')\">\n        <a-icon class=\"delete-icon\" type=\"delete\" />\n        <span>删除</span>\n      </span>\n      <a-dropdown>\n        <span>\n          <a-icon class=\"order-derive\" type=\"check-circle\" />\n          <span>更多</span>\n        </span>\n        <a-menu slot=\"overlay\">\n          <a-menu-item key=\"0\" v-show=\"getMenuPermission.includes('IMPORT')\">\n            <span>导入</span>\n          </a-menu-item>\n          <a-menu-item key=\"1\" v-show=\"getMenuPermission.includes('EXPORT')\">\n            <span>导出</span>\n          </a-menu-item>\n        </a-menu>\n      </a-dropdown>\n    </div>\n    <div class=\"order-select\">\n      <orderSearch @dataChange=\"dataChange\"></orderSearch>\n    </div>\n    <div class=\"order-table\">\n      <a-table\n        :columns=\"columns\"\n        @change=\"onChangePage\"\n        :dataSource=\"tabData\"\n        :pagination=\"pagination\"\n        :rowSelection=\"rowSelection\"\n        :loading=\"loading\"\n        :scroll=\"{ x: 2750,y:'68vh' }\"\n      >\n        <template slot=\"oorderNumber\" slot-scope=\"text,record\">\n          <a href=\"javascript:;\" @click=\"orderInfo(record.id)\">{{text}}</a>\n        </template>\n        <template slot=\"osource\" slot-scope=\"text\">\n          <span v-if=\"text === 'MALLONLINE'\">线上商城</span>\n          <span v-if=\"text === 'CUSTOMIZEDONLINE'\">线上定制</span>\n          <span v-if=\"text === 'CUSTOMIZEDUNDERLINE'\">线下定制</span>\n        </template>\n        <template slot=\"ostatus\" slot-scope=\"text\">\n          <template v-for=\"(item,index) in orderStatus\">\n            <a\n              href=\"javascript:;\"\n              :title=\"item.label\"\n              v-if=\"text === item.value\"\n              class=\"status-color\"\n              :class=\"(text === 'REJECTORDER')?'status-red':(text ==='PREORDER' || text === 'CANCEL')?'status-gray':'status-green'\"\n              :key=\"index\"\n            ></a>\n          </template>\n        </template>\n        <template\n          v-for=\"(col,index) in ['odSkuCode', 'odSkuName', 'odSpec','taxRate','odSkuCustPrice', 'odNumber', 'odAmount', 'odRequireDueDate','odPromiseDueDate','odSkuCustDrawNum','odOrderplacingTime']\"\n          :slot=\"col\"\n          slot-scope=\"text, record\"\n        >\n          <template>\n            <div v-for=\"(item,index) in record.skuList\" :key=\"index\">\n              <span v-if=\"col === 'taxRate'\">\n                <span v-if=\"item.sku\">{{item.sku[col]}}</span>\n              </span>\n              <span\n                v-else-if=\"col === 'odRequireDueDate' || col === 'odPromiseDueDate' || col === 'odOrderplacingTime'\"\n              >\n                <span v-if=\"item[col]\">{{item[col]| formatDate}}</span>\n              </span>\n              <span v-else>{{item[col]}}</span>\n            </div>\n          </template>\n        </template>\n      </a-table>\n    </div>\n    <!-- 弹出层 -->\n    <a-drawer\n      destroyOnClose\n      placement=\"right\"\n      :closable=\"false\"\n      :width=\"1040\"\n      @close=\"onCustomerInfo\"\n      :visible=\"visible\"\n      :wrapStyle=\"{height: '100%',overflow: 'auto',paddingBottom: '108px'}\"\n    >\n      <orderInfo @isVisible=\"isVisible\" :editInfo=\"editInfo\" :detialList=\"detialList\"></orderInfo>\n    </a-drawer>\n  </div>\n</template>\n\n<script>\nimport { postJson, deleted } from '@/api/axios.js'\nimport api from '@/api/index.js'\nimport orderInfo from './child_lib/orderDetail'\nimport { columns, orderStatus } from './basic_lib/menu.js'\nimport orderSearch from './other/orderSearch'\nexport default {\n  components: {\n    orderInfo,\n    orderSearch\n  },\n  data() {\n    return {\n      editInfo: false,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        pageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      columns,\n      orderStatus,\n      tabData: [],\n      selectedRowKeys: [],\n      selectedRows: [],\n      loading: true,\n      orderEncapsulation: {},\n      visible: false,\n      detialList: '',\n      buttons: [] // 页面显示的按钮\n    }\n  },\n  created() {\n    this.getOrderList()\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: false\n      }\n    },\n    getMenuPermission() {\n      return this.$store.state.menuPermission\n    }\n  },\n  methods: {\n    // 翻页时触发\n    onChangePage(pagination, filters, sorter) {\n      this.pagination.pageSize = pagination.pageSize\n      this.getOrderList(pagination.current)\n    },\n    // 获取列表数据\n    getOrderList(currentPage = 1) {\n      const pageSize = this.pagination.pageSize\n      this.loading = true\n      postJson(\n        api.getOrderList + `${currentPage}/${pageSize}`,\n        this.orderEncapsulation\n      ).then(res => {\n        if (res.data.code === 0) {\n          if (res.data.data.records) {\n            this.tabData = res.data.data.records\n            this.tabData.forEach((item, index) => {\n              item.key = index\n            })\n          } else {\n            this.tabData = []\n          }\n          this.pagination.total = res.data.data.total\n        } else {\n          this.$message.error(res.data.msg)\n        }\n        this.loading = false\n        this.selectedRowKeys = []\n      }).catch(() => {\n        this.loading = false\n      })\n    },\n    // 关闭新建订单/详情抽屉\n    isVisible(isVisible) {\n      this.visible = false\n      if (isVisible) {\n        this.getOrderList()\n      }\n    },\n    // 关闭新建/详情订单抽屉\n    onCustomerInfo() {\n      this.visible = false\n    },\n    // 打开新建/详情订单抽屉\n    orderInfo(id) {\n      if (id === '-1') {\n        this.editInfo = false\n        this.$store.commit('setPromptTitle', {\n          title: '新建销售订单',\n          isEdit: false\n        })\n        this.visible = true\n      } else {\n        if (this.getMenuPermission.includes('DETAIL')) {\n          this.detialList = id\n          this.editInfo = true\n          this.$store.commit('setPromptTitle', {\n            title: '销售订单详情',\n            isEdit: true\n          })\n          this.visible = true\n        } else {\n          this.$message.error('权限不足')\n        }\n      }\n    },\n    onChangeTab(selectedRowKeys, selectedRows) {\n      this.selectedRowKeys = selectedRowKeys\n      this.selectedRows = selectedRows\n    },\n    // 订单的批量删除\n    deleteOrder() {\n      var selectedRowKeys = this.selectedRowKeys\n      var selectedRows = this.selectedRows\n      var idStr = []\n      var _this = this\n      if (selectedRowKeys.length === 0) {\n        this.$message.error('请选择要删除的订单')\n      } else {\n        selectedRows.forEach((item, index) => {\n          idStr.push(item.id)\n        })\n        this.$confirm({\n          title: '您确定要删除订单信息吗？',\n          content: '当您点击确定过后将删除选中的订单信息',\n          cancelText: '取消',\n          okText: '确定',\n          onOk() {\n            deleted(api.deletedBatch + `?idStr=${idStr.join(',')}`).then(\n              res => {\n                if (res.data.code === 0) {\n                  _this.$message.success('删除成功')\n                  _this.getOrderList()\n                }\n              }\n            )\n          }\n        })\n      }\n    },\n    dataChange(val) {\n      this.orderEncapsulation = { ...val }\n      this.getOrderList()\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n@import \"~styles/variable.less\";\n\n.order {\n  .order-add {\n    .order-remove {\n      margin: 0 20px;\n    }\n    .order-derive {\n      color: #6bc67b;\n      margin-right: 5px;\n    }\n    .delete-btn {\n      margin: 0 20px;\n      cursor: pointer;\n      .delete-icon {\n        color: #f00;\n        margin-right: 3px;\n      }\n    }\n  }\n  .order-select {\n    margin: 20px 0 0;\n    .order-select-reset {\n      margin: 0 8px;\n    }\n  }\n}\n.status-color {\n  display: inline-block;\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  // text-align: center\n}\n.status-green {\n  background-color: #6bc67b;\n}\n.status-gray {\n  background-color: #d8d8d8;\n}\n.status-red {\n  background-color: #f5222d;\n}\n.status-yellow {\n  background-color: yellow;\n}\n</style>\n"]}]}