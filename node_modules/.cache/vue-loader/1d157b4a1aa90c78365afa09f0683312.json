{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/Customer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/Customer.vue","mtime":1557728970381},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Animation from '@/assets/utils/Animation'\nimport {\n  showCustomersPage,\n  removeCustomer,\n  getCustomerAndMallUser,\n  getCustIndustry,\n  custNamefetch,\n  custCodefetch,\n  custManagerfetch\n} from './getPage.js'\nimport { columnCust } from './columns.js'\nimport AddCustomerInfo from './AddCustomerInfo'\n\nexport default {\n  name: 'Customer',\n  data() {\n    return {\n      // 高级搜索 展开/关闭\n      advanced: false,\n      // 地域data\n      options: [\n        {\n          value: 'zhejiang',\n          label: 'Zhejiang',\n          children: [\n            {\n              value: 'hangzhou',\n              label: 'Hangzhou',\n              children: [\n                {\n                  value: 'xihu',\n                  label: 'West Lake'\n                }\n              ]\n            }\n          ]\n        },\n        {\n          value: 'jiangsu',\n          label: 'Jiangsu',\n          children: [\n            {\n              value: 'nanjing',\n              label: 'Nanjing',\n              children: [\n                {\n                  value: 'zhonghuamen',\n                  label: 'Zhong Hua Men'\n                }\n              ]\n            }\n          ]\n        }\n      ],\n      // table\n      tabData: [],\n      columnCust,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      loading: false,\n      selectedRowKeys: [], // Check here to configure the default column,\n      deleteCustomer: '',\n      visible: false,\n      setCustomerAndMallUser: {},\n      isEdit: false,\n      isShow: true,\n      isPermission: true, // 权限\n      // 客户搜索\n      custSearchInfo: {\n        custSearchLevel: '' // 客户等级\n      },\n      custIndustryArr: [],\n      defaultCustIndustry: '', // 客户行业\n      defaultStatus: '', // 客户状态\n      // 客户名称\n      custNameData: [],\n      custNameValue: {},\n      // 客户编码\n      custCodeData: [],\n      custCodeValue: {},\n      // 客户经理\n      custManagerData: [],\n      custManagerValue: {}\n    }\n  },\n  created() {\n    getCustIndustry.call(this, 'INDUSTRY')\n  },\n  mounted() {\n    // 初始化客户信息\n    showCustomersPage.call(this, {})\n  },\n  methods: {\n    // 客户名称搜索\n    handleCustNameSearch(value) {\n      custNamefetch.call(this, value, data => (this.custNameData = data))\n    },\n    handleCustNameChange(value) {\n      // this.custNameValue = Object.assign({}, value)\n      this.custNameValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 客户编码搜索\n    handleCustCodeSearch(value) {\n      custCodefetch.call(this, value, data => (this.custCodeData = data))\n    },\n    handleCustCodeChange(value) {\n      this.custCodeValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 客户经理搜索\n    handleCustManagerSearch(value) {\n      custManagerfetch.call(this, value, data => (this.custManagerData = data))\n    },\n    handleCustManagerChange(value) {\n      console.log(value)\n      this.custManagerValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 重置\n    custRest() {\n      this.custNameValue = {}\n      this.custCodeValue = {}\n      this.custManagerValue = {}\n      this.custSearchInfo.custSearchLevel = ''\n      this.defaultStatus = ''\n      this.defaultCustIndustry = ''\n      // 重置列表\n      showCustomersPage.call(this, {})\n    },\n    // 地域选择\n    onChangeArea(value) {\n      console.log(value)\n    },\n    // 客户等级\n    onleChangeRank(value) {\n      console.log(value)\n      this.custSearchInfo.custSearchLevel = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 行业\n    onleChangeindustry(value) {\n      console.log(value)\n      this.defaultCustIndustry = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    // 客户状态\n    onleChangeStatus(value) {\n      console.log(value)\n      this.defaultStatus = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // table 选择操作\n    onChangeTab(selectedRowKeys, selectedRows) {\n      console.log(selectedRowKeys)\n      console.log(selectedRows)\n      this.selectedRowKeys = selectedRowKeys\n      // 选中删除供应商数\n      this.deleteCustomer = ''\n      selectedRowKeys.forEach((item, index) => {\n        console.log(item)\n        this.deleteCustomer += `customerIds=${item}&`\n      })\n      console.log(this.deleteCustomer)\n    },\n    // 删除tab列表项\n    onDeleteCustomer() {\n      const that = this\n      if (that.selectedRowKeys.length === 0) {\n        that.$message.error('请先选择要删除的项')\n        return false\n      }\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          that.loading = true\n          removeCustomer.call(that)\n          setTimeout(() => {\n            showCustomersPage.call(that, {})\n          }, 200)\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 分页管理\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 新增客户信息\n    addCustomerInfo() {\n      this.visible = true\n      this.isEdit = false\n    },\n    // 取消客户信息\n    onCustomerInfo() {\n      this.visible = false\n    },\n    // 客户信息详情\n    onChangeCode(record) {\n      if (this.isPermission) {\n        this.visible = true\n        // 编辑按钮显示\n        this.isEdit = true\n        getCustomerAndMallUser.call(this, record.key)\n      }\n    },\n    // 客户状态\n    onChangeStatus(record) {\n      console.log(record)\n    },\n    // $emit改变isvisible\n    isVisible(isVisible) {\n      this.visible = isVisible\n    },\n    controlPermission(val) {\n      val.forEach(item => {\n        // console.log(item.btnOptType)\n        switch (item.btnOptType) {\n          case 'LIST':\n            // 客户搜索\n            this.isPermission = true\n            break\n          case 'IMPORT':\n            // 导入\n            this.isPermission = true\n            break\n          case 'EXPORT':\n            // 导出\n            this.isPermission = true\n            break\n          case 'DELETES':\n            // 删除\n            this.isPermission = true\n            break\n          case 'ADD':\n            // 新建\n            this.isPermission = true\n            break\n          case 'DETAIL':\n            // 详情\n            this.isPermission = true\n            break\n          default:\n            this.isPermission = false\n        }\n      })\n    },\n    // 分页\n    onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize)\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getNavPermission() {\n      return this.$store.getters.getNavPermission\n    }\n  },\n  watch: {\n    getNavPermission(val) {\n      // console.log(val)\n      this.controlPermission(val)\n    }\n  },\n  components: {\n    Animation,\n    AddCustomerInfo\n  }\n}\n",{"version":3,"sources":["Customer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Customer.vue","sourceRoot":"src/views/customer","sourcesContent":["<template>\n  <div class=\"client\">\n    <!-- 头部选择区 -->\n    <div class=\"client-add\">\n      <a-button type=\"primary\" v-show=\"isPermission\" @click=\"addCustomerInfo\">\n        <a-icon type=\"plus\"/>新建\n      </a-button>\n      <!-- 弹出层 -->\n      <a-drawer\n        destroyOnClose\n        placement=\"right\"\n        :closable=\"false\"\n        :width=\"1080\"\n        @close=\"onCustomerInfo\"\n        :visible=\"visible\"\n        :wrapStyle=\"{height: 'calc(100% - 108px)',overflow: 'auto',paddingBottom: '108px'}\"\n      >\n        <AddCustomerInfo\n          @isVisible=\"isVisible\"\n          :isEdit=\"isEdit\"\n          :setCustomerAndMallUser=\"setCustomerAndMallUser\"\n        ></AddCustomerInfo>\n      </a-drawer>\n      <span v-show=\"isPermission\" class=\"delete-btn\" @click=\"onDeleteCustomer\">\n        <a-icon class=\"delete-icon\" type=\"delete\"/>\n        <span>删除</span>\n      </span>\n      <a-dropdown>\n        <span>\n          <a-icon class=\"client-derive\" type=\"check-circle\"/>\n          <span>更多</span>\n        </span>\n        <a-menu slot=\"overlay\">\n          <a-menu-item key=\"0\">\n            <span v-show=\"isPermission\">导入</span>\n          </a-menu-item>\n          <a-menu-item key=\"1\">\n            <span v-show=\"isPermission\">导出</span>\n          </a-menu-item>\n        </a-menu>\n      </a-dropdown>\n    </div>\n    <!-- 客户选择 -->\n    <div class=\"client-select\" v-show=\"isPermission\">\n      <a-form layout=\"inline\">\n        <a-row>\n          <a-col :span=\"20\">\n            <a-row>\n              <a-col :span=\"24\" style=\"margin: 8px 0;\">\n                <a-form-item label=\"客户名称\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    showSearch\n                    labelInValue\n                    :value=\"custNameValue\"\n                    placeholder=\"请输入客户名称\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustNameSearch\"\n                    @change=\"handleCustNameChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option value>全部</a-select-option>\n                    <a-select-option v-for=\"(d, i) in custNameData\" :key=\"i\">{{ d }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户经理\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    showSearch\n                    labelInValue\n                    :value=\"custManagerValue\"\n                    placeholder=\"请输入客户经理\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustManagerSearch\"\n                    @change=\"handleCustManagerChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option class=\"defaultSelect\" value>全部</a-select-option>\n                    <a-select-option v-for=\"(d, i) in custManagerData\" :key=\"d.text\">{{ d.value }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户等级\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    placeholder=\"客户等级\"\n                    v-model=\"custSearchInfo.custSearchLevel\"\n                    @change=\"onleChangeRank\"\n                    class=\"inputWidth\"\n                  >\n                    <a-select-option value=\"all\">全部</a-select-option>\n                    <a-select-option value=\"0\">V1</a-select-option>\n                    <a-select-option value=\"1\">V2</a-select-option>\n                    <a-select-option value=\"2\">V3</a-select-option>\n                    <a-select-option value=\"3\">V4</a-select-option>\n                    <a-select-option value=\"4\">V5</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n            </a-row>\n            <Animation name=\"fadeIn\">\n              <a-row v-if=\"advanced\">\n                <a-col :span=\"24\">\n                  <a-form-item label=\"客户编码\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      showSearch\n                      labelInValue\n                      :value=\"custCodeValue\"\n                      placeholder\n                      style=\"width: 200px\"\n                      :defaultActiveFirstOption=\"false\"\n                      :showArrow=\"false\"\n                      :filterOption=\"false\"\n                      @search=\"handleCustCodeSearch\"\n                      @change=\"handleCustCodeChange\"\n                      :notFoundContent=\"null\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option v-for=\"(d, i) in custCodeData\" :key=\"i\">{{ d }}</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                  <a-form-item label=\"行业\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      :value=\"defaultCustIndustry\"\n                      @change=\"onleChangeindustry\"\n                      class=\"inputWidth\"\n                      placeholder=\"行业\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option\n                        v-for=\"item of custIndustryArr\"\n                        :key=\"item.id\"\n                        :value=\"item.id\"\n                      >{{ item.displayValue }}</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                  <a-form-item label=\"客户状态\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      :value=\"defaultStatus\"\n                      placeholder=\"客户状态\"\n                      class=\"inputWidth\"\n                      @change=\"onleChangeStatus\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option value=\"0\">已购买</a-select-option>\n                      <a-select-option value=\"1\">未购买</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                </a-col>\n              </a-row>\n            </Animation>\n          </a-col>\n          <a-col :span=\"4\">\n            <a-form-item>\n              <span class=\"client-select-reset\" @click=\"custRest\">重置</span>\n              <span @click=\"toggleAdvanced\" style=\"cursor: pointer;\">\n                {{ advanced ? '收起' : '展开' }}\n                <a-icon :type=\"advanced ? 'caret-up' : 'caret-down'\"/>\n              </span>\n            </a-form-item>\n          </a-col>\n        </a-row>\n      </a-form>\n    </div>\n    <!-- table -->\n    <div class=\"client-table\">\n      <a-table\n        :columns=\"columnCust\"\n        @change=\"onChangePage\"\n        :dataSource=\"tabData\"\n        :pagination=\"pagination\"\n        :rowSelection=\"rowSelection\"\n        :loading=\"loading\"\n        @showSizeChange=\"onShowSizeChange\"\n      >\n        <template slot=\"clientCode\" slot-scope=\"text, record\">\n          <a @click=\"onChangeCode(record)\" href=\"javascript:;\">{{text}}</a>\n        </template>\n        <template slot=\"clientStatus\" slot-scope=\"text, record\">\n          <a\n            @click=\"onChangeStatus(record)\"\n            href=\"javascript:;\"\n            class=\"client-status\"\n            :class=\"[`${text}` === '0' ? 'statusOk' : 'statusNo']\"\n            :title=\"[`${text}` === '0' ? '已购买' : '未购买']\"\n          ></a>\n        </template>\n      </a-table>\n    </div>\n  </div>\n</template>\n<script>\nimport Animation from '@/assets/utils/Animation'\nimport {\n  showCustomersPage,\n  removeCustomer,\n  getCustomerAndMallUser,\n  getCustIndustry,\n  custNamefetch,\n  custCodefetch,\n  custManagerfetch\n} from './getPage.js'\nimport { columnCust } from './columns.js'\nimport AddCustomerInfo from './AddCustomerInfo'\n\nexport default {\n  name: 'Customer',\n  data() {\n    return {\n      // 高级搜索 展开/关闭\n      advanced: false,\n      // 地域data\n      options: [\n        {\n          value: 'zhejiang',\n          label: 'Zhejiang',\n          children: [\n            {\n              value: 'hangzhou',\n              label: 'Hangzhou',\n              children: [\n                {\n                  value: 'xihu',\n                  label: 'West Lake'\n                }\n              ]\n            }\n          ]\n        },\n        {\n          value: 'jiangsu',\n          label: 'Jiangsu',\n          children: [\n            {\n              value: 'nanjing',\n              label: 'Nanjing',\n              children: [\n                {\n                  value: 'zhonghuamen',\n                  label: 'Zhong Hua Men'\n                }\n              ]\n            }\n          ]\n        }\n      ],\n      // table\n      tabData: [],\n      columnCust,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      loading: false,\n      selectedRowKeys: [], // Check here to configure the default column,\n      deleteCustomer: '',\n      visible: false,\n      setCustomerAndMallUser: {},\n      isEdit: false,\n      isShow: true,\n      isPermission: true, // 权限\n      // 客户搜索\n      custSearchInfo: {\n        custSearchLevel: '' // 客户等级\n      },\n      custIndustryArr: [],\n      defaultCustIndustry: '', // 客户行业\n      defaultStatus: '', // 客户状态\n      // 客户名称\n      custNameData: [],\n      custNameValue: {},\n      // 客户编码\n      custCodeData: [],\n      custCodeValue: {},\n      // 客户经理\n      custManagerData: [],\n      custManagerValue: {}\n    }\n  },\n  created() {\n    getCustIndustry.call(this, 'INDUSTRY')\n  },\n  mounted() {\n    // 初始化客户信息\n    showCustomersPage.call(this, {})\n  },\n  methods: {\n    // 客户名称搜索\n    handleCustNameSearch(value) {\n      custNamefetch.call(this, value, data => (this.custNameData = data))\n    },\n    handleCustNameChange(value) {\n      // this.custNameValue = Object.assign({}, value)\n      this.custNameValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 客户编码搜索\n    handleCustCodeSearch(value) {\n      custCodefetch.call(this, value, data => (this.custCodeData = data))\n    },\n    handleCustCodeChange(value) {\n      this.custCodeValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 客户经理搜索\n    handleCustManagerSearch(value) {\n      custManagerfetch.call(this, value, data => (this.custManagerData = data))\n    },\n    handleCustManagerChange(value) {\n      console.log(value)\n      this.custManagerValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 重置\n    custRest() {\n      this.custNameValue = {}\n      this.custCodeValue = {}\n      this.custManagerValue = {}\n      this.custSearchInfo.custSearchLevel = ''\n      this.defaultStatus = ''\n      this.defaultCustIndustry = ''\n      // 重置列表\n      showCustomersPage.call(this, {})\n    },\n    // 地域选择\n    onChangeArea(value) {\n      console.log(value)\n    },\n    // 客户等级\n    onleChangeRank(value) {\n      console.log(value)\n      this.custSearchInfo.custSearchLevel = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 行业\n    onleChangeindustry(value) {\n      console.log(value)\n      this.defaultCustIndustry = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    // 客户状态\n    onleChangeStatus(value) {\n      console.log(value)\n      this.defaultStatus = value\n      // 模糊查询分页显示\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // table 选择操作\n    onChangeTab(selectedRowKeys, selectedRows) {\n      console.log(selectedRowKeys)\n      console.log(selectedRows)\n      this.selectedRowKeys = selectedRowKeys\n      // 选中删除供应商数\n      this.deleteCustomer = ''\n      selectedRowKeys.forEach((item, index) => {\n        console.log(item)\n        this.deleteCustomer += `customerIds=${item}&`\n      })\n      console.log(this.deleteCustomer)\n    },\n    // 删除tab列表项\n    onDeleteCustomer() {\n      const that = this\n      if (that.selectedRowKeys.length === 0) {\n        that.$message.error('请先选择要删除的项')\n        return false\n      }\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          that.loading = true\n          removeCustomer.call(that)\n          setTimeout(() => {\n            showCustomersPage.call(that, {})\n          }, 200)\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 分页管理\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 新增客户信息\n    addCustomerInfo() {\n      this.visible = true\n      this.isEdit = false\n    },\n    // 取消客户信息\n    onCustomerInfo() {\n      this.visible = false\n    },\n    // 客户信息详情\n    onChangeCode(record) {\n      if (this.isPermission) {\n        this.visible = true\n        // 编辑按钮显示\n        this.isEdit = true\n        getCustomerAndMallUser.call(this, record.key)\n      }\n    },\n    // 客户状态\n    onChangeStatus(record) {\n      console.log(record)\n    },\n    // $emit改变isvisible\n    isVisible(isVisible) {\n      this.visible = isVisible\n    },\n    controlPermission(val) {\n      val.forEach(item => {\n        // console.log(item.btnOptType)\n        switch (item.btnOptType) {\n          case 'LIST':\n            // 客户搜索\n            this.isPermission = true\n            break\n          case 'IMPORT':\n            // 导入\n            this.isPermission = true\n            break\n          case 'EXPORT':\n            // 导出\n            this.isPermission = true\n            break\n          case 'DELETES':\n            // 删除\n            this.isPermission = true\n            break\n          case 'ADD':\n            // 新建\n            this.isPermission = true\n            break\n          case 'DETAIL':\n            // 详情\n            this.isPermission = true\n            break\n          default:\n            this.isPermission = false\n        }\n      })\n    },\n    // 分页\n    onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize)\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getNavPermission() {\n      return this.$store.getters.getNavPermission\n    }\n  },\n  watch: {\n    getNavPermission(val) {\n      // console.log(val)\n      this.controlPermission(val)\n    }\n  },\n  components: {\n    Animation,\n    AddCustomerInfo\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.client {\n  .client-add {\n    .delete-btn {\n      margin: 0 20px;\n      cursor: pointer;\n      .delete-icon {\n        color: #f00;\n        margin-right: 3px;\n      }\n    }\n    .client-derive {\n      color: #6bc67b;\n      margin-right: 5px;\n    }\n  }\n  .client-select {\n    margin: 20px 0;\n    .client-select-reset {\n      margin: 0 8px;\n      cursor: pointer;\n    }\n    /deep/ .ant-form-item-label {\n      .labelWidth();\n    }\n  }\n  .inputWidth {\n    .inputWidth();\n  }\n  .client-table {\n    .client-status {\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      display: inline-block;\n    }\n    .statusOk {\n      background: #6bc67b;\n    }\n    .statusNo {\n      background: #d8d8d8;\n    }\n  }\n}\n</style>\n"]}]}