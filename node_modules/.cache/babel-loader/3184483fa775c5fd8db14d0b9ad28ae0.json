{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/pdm/goods/child_info/tabGoodsInfo/bomInfo/BomInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/pdm/goods/child_info/tabGoodsInfo/bomInfo/BomInfo.vue","mtime":1559614673774},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { bomColumns } from 'goods/basic_lib/column';\nimport BomDrawer from './drawer/BomDrawer';\nexport default {\n  name: 'BomInfo',\n  data: function data() {\n    return {\n      childrenDrawer: false,\n      listData: [],\n      num: 1,\n      bomColumns: bomColumns,\n      keepKey: 0\n    };\n  },\n  methods: {\n    onChildrenDrawerClose: function onChildrenDrawerClose() {\n      this.childrenDrawer = false;\n    },\n    isChildrenDrawer: function isChildrenDrawer(val) {\n      this.childrenDrawer = val;\n    },\n    // PUSH\n    onClickAddList: function onClickAddList() {\n      this.listData.push({\n        id: this.num,\n        select: true,\n        right: true,\n        remove: false,\n        dataSource: []\n      });\n      this.num++;\n    },\n    // Emit接受值\n    bomInfo: function bomInfo(val) {\n      console.log(val);\n      this.listData[val.key].dataSource.push({\n        key: val.bomInfo.id,\n        index: val.key,\n        code: val.bomInfo.code,\n        name: val.bomInfo.name,\n        specification: val.bomInfo.spec,\n        unit: val.bomInfo.unit,\n        dosage: '',\n        way: val.bomInfo.gateway\n      });\n      console.log(this.listData);\n    },\n    // Select\n    selectList: function selectList(key) {\n      console.log(key);\n      this.listData[key].select = !this.listData[key].select;\n      this.listData[key].right = !this.listData[key].right;\n    },\n    // remove\n    removeList: function removeList(key) {\n      this.listData.splice(key, 1);\n    },\n    selectEnter: function selectEnter(key) {\n      this.listData[key].right = !this.listData[key].right;\n      this.listData[key].remove = !this.listData[key].remove;\n    },\n    selectLeave: function selectLeave(key) {\n      this.listData[key].right = !this.listData[key].right;\n      this.listData[key].remove = !this.listData[key].remove;\n    },\n    // Input框change事件\n    handleChange: function handleChange(value, record, column) {\n      console.log(value);\n\n      var newData = _toConsumableArray(this.listData[record.index].dataSource);\n\n      console.log(newData);\n      var target = newData.filter(function (item) {\n        return record.key === item.key;\n      })[0];\n      console.log(target);\n\n      if (target) {\n        target[column] = value; // this.listData[record.index].dataSource = newData\n      }\n    },\n    edit: function edit(record) {\n      var newData = _toConsumableArray(this.listData[record.index].dataSource);\n\n      var target = newData.filter(function (item) {\n        return record.key === item.key;\n      })[0];\n      console.log(target);\n\n      if (target) {\n        target.editable = false;\n        this.listData[record.index].dataSource = newData;\n      }\n    },\n    save: function save(record) {\n      var newData = _toConsumableArray(this.listData[record.index].dataSource);\n\n      var target = newData.filter(function (item) {\n        return record.key === item.key;\n      })[0];\n\n      if (target) {\n        delete target.editable;\n        target.editable = true;\n        this.listData[record.index].dataSource = newData; // this.cacheData = newData.map(item => ({ ...item }))\n      }\n    },\n    onDelete: function onDelete(record) {\n      var newData = _toConsumableArray(this.listData[record.index].dataSource);\n\n      this.listData[record.index].dataSource = newData.filter(function (item) {\n        return item.key !== record.key;\n      });\n    },\n    // cancel(record) {\n    //   const newData = [...this.listData[record.index].dataSource]\n    //   const target = newData.filter(item => record.key === item.key)[0]\n    //   console.log(target)\n    //   if (target) {\n    //     Object.assign(\n    //       target,\n    //       this.listData[record.index].dataSource.filter(\n    //         item => record.key === item.key\n    //       )[0]\n    //     )\n    //     delete target.editable\n    //     target.editable = true\n    //     this.listData[record.index].dataSource = newData\n    //   }\n    // },\n    // 弹出抽屉\n    handleAdd: function handleAdd(key) {\n      this.keepKey = key;\n      this.childrenDrawer = true;\n    }\n  },\n  components: {\n    'bom-drawer': BomDrawer\n  }\n};",{"version":3,"sources":["BomInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"craft-info\">\n    <div class=\"list-wrapper\" v-for=\"(item, key) in listData\" :key=\"key\">\n      <div\n        class=\"content\"\n        :class=\"{selectList: listData[key].select}\"\n        @click.stop=\"selectList(key)\"\n      >\n        <h3 class=\"title\">{{ `方案${item.id}` }}</h3>\n        <a-table :columns=\"bomColumns\" :dataSource=\"listData[key].dataSource\" :pagination=\"false\">\n          <template v-for=\"col in ['dosage']\" :slot=\"col\" slot-scope=\"text, record, index\">\n            <div :key=\"col\">\n              <a-input\n                v-if=\"!record.editable\"\n                style=\"margin: -5px 0\"\n                :value=\"text\"\n                @change=\"e => handleChange(e.target.value, record, col)\"\n              />\n              <template v-else>{{text}}</template>\n            </div>\n          </template>\n          <template slot=\"operation\" slot-scope=\"text, record, index\">\n            <div class=\"editable-row-operations\">\n              <span v-if=\"record.editable\">\n                <a @click.stop=\"() => edit(record)\">编辑</a>\n                <a-popconfirm title=\"确定要删除吗?\" @confirm=\"() => onDelete(record)\">\n                  <a>删除</a>\n                </a-popconfirm>\n              </span>\n              <span v-else=\"!record.editable\">\n                <a @click.stop=\"() => save(record)\">保存</a>\n                <!-- <a @click.stop=\"() => cancel(record)\">取消</a> -->\n              </span>\n            </div>\n          </template>\n        </a-table>\n        <a-button\n          style=\"width: 100%; margin-top: 16px; margin-bottom: 8px\"\n          type=\"dashed\"\n          icon=\"plus\"\n          @click.stop=\"handleAdd(key)\"\n        >添加编码</a-button>\n      </div>\n      <div class=\"icon-box icon-select\" v-if=\"listData[key].right\" @mouseenter=\"selectEnter(key)\">\n        <a-icon class=\"icon-right\" type=\"check\"/>\n      </div>\n      <div class=\"icon-box icon-delete\" v-if=\"listData[key].remove\" @mouseleave=\"selectLeave(key)\">\n        <a-icon class=\"icon-remove\" @click.stop=\"removeList(key)\" type=\"close\"/>\n      </div>\n    </div>\n    <a-button\n      style=\"width: 100%; margin-top: 16px; margin-bottom: 8px\"\n      type=\"dashed\"\n      icon=\"plus\"\n      @click=\"onClickAddList\"\n    >添加方案</a-button>\n    <a-drawer\n      :title=\"false\"\n      width=\"300\"\n      :closable=\"false\"\n      @close=\"onChildrenDrawerClose\"\n      :visible=\"childrenDrawer\"\n    >\n      <bom-drawer @isChildrenDrawer=\"isChildrenDrawer\" @bomInfo=\"bomInfo\" :keepKey=\"keepKey\"/>\n    </a-drawer>\n  </div>\n</template>\n<script>\nimport { bomColumns } from 'goods/basic_lib/column'\nimport BomDrawer from './drawer/BomDrawer'\n\nexport default {\n  name: 'BomInfo',\n  data() {\n    return {\n      childrenDrawer: false,\n      listData: [],\n      num: 1,\n      bomColumns,\n      keepKey: 0\n    }\n  },\n  methods: {\n    onChildrenDrawerClose() {\n      this.childrenDrawer = false\n    },\n    isChildrenDrawer(val) {\n      this.childrenDrawer = val\n    },\n    // PUSH\n    onClickAddList() {\n      this.listData.push({\n        id: this.num,\n        select: true,\n        right: true,\n        remove: false,\n        dataSource: []\n      })\n      this.num++\n    },\n    // Emit接受值\n    bomInfo(val) {\n      console.log(val)\n      this.listData[val.key].dataSource.push({\n        key: val.bomInfo.id,\n        index: val.key,\n        code: val.bomInfo.code,\n        name: val.bomInfo.name,\n        specification: val.bomInfo.spec,\n        unit: val.bomInfo.unit,\n        dosage: '',\n        way: val.bomInfo.gateway\n      })\n      console.log(this.listData)\n    },\n    // Select\n    selectList(key) {\n      console.log(key)\n      this.listData[key].select = !this.listData[key].select\n      this.listData[key].right = !this.listData[key].right\n    },\n    // remove\n    removeList(key) {\n      this.listData.splice(key, 1)\n    },\n    selectEnter(key) {\n      this.listData[key].right = !this.listData[key].right\n      this.listData[key].remove = !this.listData[key].remove\n    },\n    selectLeave(key) {\n      this.listData[key].right = !this.listData[key].right\n      this.listData[key].remove = !this.listData[key].remove\n    },\n    // Input框change事件\n    handleChange(value, record, column) {\n      console.log(value)\n      const newData = [...this.listData[record.index].dataSource]\n      console.log(newData)\n      const target = newData.filter(item => record.key === item.key)[0]\n      console.log(target)\n      if (target) {\n        target[column] = value\n        // this.listData[record.index].dataSource = newData\n      }\n    },\n    edit(record) {\n      const newData = [...this.listData[record.index].dataSource]\n      const target = newData.filter(item => record.key === item.key)[0]\n      console.log(target)\n      if (target) {\n        target.editable = false\n        this.listData[record.index].dataSource = newData\n      }\n    },\n    save(record) {\n      const newData = [...this.listData[record.index].dataSource]\n      const target = newData.filter(item => record.key === item.key)[0]\n      if (target) {\n        delete target.editable\n        target.editable = true\n        this.listData[record.index].dataSource = newData\n        // this.cacheData = newData.map(item => ({ ...item }))\n      }\n    },\n    onDelete(record) {\n      const newData = [...this.listData[record.index].dataSource]\n      this.listData[record.index].dataSource = newData.filter(\n        item => item.key !== record.key\n      )\n    },\n    // cancel(record) {\n    //   const newData = [...this.listData[record.index].dataSource]\n    //   const target = newData.filter(item => record.key === item.key)[0]\n    //   console.log(target)\n    //   if (target) {\n    //     Object.assign(\n    //       target,\n    //       this.listData[record.index].dataSource.filter(\n    //         item => record.key === item.key\n    //       )[0]\n    //     )\n    //     delete target.editable\n    //     target.editable = true\n    //     this.listData[record.index].dataSource = newData\n    //   }\n    // },\n    // 弹出抽屉\n    handleAdd(key) {\n      this.keepKey = key\n      this.childrenDrawer = true\n    }\n  },\n  components: {\n    'bom-drawer': BomDrawer\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.craft-info {\n  .title {\n    min-height: 35px;\n    line-height: 35px;\n    padding: 0 15px;\n  }\n  .list-wrapper {\n    margin: 10px 0;\n    min-height: 100px;\n    box-sizing: border-box;\n    border: 1px solid #d9d9d9;\n    border-radius: 4px;\n    position: relative;\n    .selectList {\n      border: 2px solid #69b412;\n    }\n    .content {\n      width: 100%;\n      border-radius: 4px;\n      min-height: 100px;\n      .editable-row-operations a {\n        margin-right: 8px;\n      }\n    }\n    .icon-box {\n      position: relative;\n      position: absolute;\n      top: 0;\n      right: 0;\n      z-index: 0;\n      border-left: 40px solid transparent;\n      .icon-remove {\n        position: absolute;\n        right: 5px;\n        top: -35px;\n        z-index: 10;\n        color: #fff;\n      }\n      .icon-right {\n        position: absolute;\n        right: 5px;\n        top: -35px;\n        z-index: 10;\n        color: #fff;\n      }\n    }\n    .icon-select {\n      border-top: 40px solid #69b412;\n    }\n    .icon-delete {\n      border-top: 40px solid #f00;\n    }\n  }\n}\n</style>"],"sourceRoot":"src/views/product/pdm/goods/child_info/tabGoodsInfo/bomInfo"}]}