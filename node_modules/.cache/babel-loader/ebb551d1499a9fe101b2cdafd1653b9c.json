{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/procurement/purchasList/other/newMaterial.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/procurement/purchasList/other/newMaterial.vue","mtime":1560598889418},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport _Array$from from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/array/from\";\nimport _JSON$stringify from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport infiniteScroll from 'vue-infinite-scroll';\nimport api from '@/api/index';\nimport { get, post, postJson } from '@/api/axios';\nexport default {\n  directives: {\n    infiniteScroll: infiniteScroll\n  },\n  data: function data() {\n    return {\n      expandedKeys: [],\n      autoExpandParent: true,\n      gData: [],\n      busy: false,\n      loading: false,\n      currentPage: 1,\n      pages: 1,\n      data: []\n    };\n  },\n  created: function created() {\n    this.getCategoryBomTree();\n  },\n  methods: {\n    onExpand: function onExpand(val) {\n      this.expandedKeys = val;\n      this.data = [];\n      this.currentPage = 1;\n      this.getQueryMaterialBaseInfo();\n    },\n    handleInfiniteOnLoad: function handleInfiniteOnLoad() {\n      this.busy = true;\n      this.loading = true;\n\n      if (this.expandedKeys.length) {\n        if (this.currentPage > this.pages) {\n          return;\n        } else {\n          this.getQueryMaterialBaseInfo(this.currentPage);\n        }\n\n        this.busy = false;\n        this.loading = false;\n      }\n    },\n    // 获取公司所有原材料分类\n    getCategoryBomTree: function getCategoryBomTree() {\n      var _this = this;\n\n      get(api.bomCategoryTree).then(function (res) {\n        if (res.data.code === 0) {\n          var mapObj = {\n            name: 'title',\n            id: 'key',\n            childrens: 'children' // 全局替换字段名\n\n          };\n          var conversion = JSON.parse(_JSON$stringify(res.data.data).replace(/name|id|childrens/gi, function (matched) {\n            return mapObj[matched];\n          }));\n          _this.gData = _Array$from(conversion);\n        }\n      });\n    },\n    // 获取原材料基本信息\n    getQueryMaterialBaseInfo: function getQueryMaterialBaseInfo() {\n      var _this2 = this;\n\n      var currentPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var data = {};\n      data.catId = this.expandedKeys[0];\n      data.pageSize = 15;\n      data.currentPage = currentPage;\n      post(api.getQueryMaterialBaseInfo, data).then(function (res) {\n        if (res.data.code === 0) {\n          _this2.currentPage += 1;\n          _this2.data = _this2.data.concat(res.data.data.records);\n          _this2.pages = Number(res.data.data.pages);\n        }\n      });\n    },\n    // 添加新材料\n    addMaterial: function addMaterial(id, unit) {\n      var _this3 = this;\n\n      console.log(1);\n      postJson(api.addMaterialOrderMateriala, {\n        materialId: id,\n        unit: unit\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          _this3.$message.success('添加成功');\n        } else {\n          _this3.$message.error(res.data.msg);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["newMaterial.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <a-row class=\"material\">\n    <a-col :span=\"12\" class=\"new-material\">\n      <a-tree :treeData=\"gData\" @select=\"onExpand\" :autoExpandParent=\"autoExpandParent\"></a-tree>\n    </a-col>\n    <a-col :span=\"12\" style=\"padding:0 10px\">\n      <div\n        class=\"order-list order-list-item demo-infinite-container\"\n        v-infinite-scroll=\"handleInfiniteOnLoad\"\n        :infinite-scroll-disabled=\"busy\"\n        :infinite-scroll-distance=\"10\"\n      >\n        <a-list :dataSource=\"data\">\n          <a-list-item slot=\"renderItem\" slot-scope=\"item, index\">\n            <div class=\"list-item\" @click=\"addMaterial(item.id,item.unit)\">\n              <div class=\"item-left\">\n                <div class=\"item-left-top\">\n                  <a href=\"javascript:;\">{{item.name}} {{item.code}}</a>\n                </div>\n                <ul class=\"item-left-desc\">\n                  <li>{{item.spec}}</li>\n                  <li>{{item.cz}}</li>\n                  <li>{{item.standard}}</li>\n                </ul>\n              </div>\n              <div class=\"item-right\">\n                <a-button type=\"primary\" shape=\"circle\" icon=\"plus\"></a-button>\n              </div>\n            </div>\n          </a-list-item>\n          <div v-if=\"loading && !busy\" class=\"demo-loading-container\">\n            <a-spin/>\n          </div>\n        </a-list>\n      </div>\n    </a-col>\n  </a-row>\n</template>\n\n<script>\nimport infiniteScroll from 'vue-infinite-scroll'\nimport api from '@/api/index'\nimport { get, post, postJson } from '@/api/axios'\nexport default {\n  directives: { infiniteScroll },\n  data() {\n    return {\n      expandedKeys: [],\n      autoExpandParent: true,\n      gData: [],\n      busy: false,\n      loading: false,\n      currentPage: 1,\n      pages: 1,\n      data: []\n    }\n  },\n  created() {\n    this.getCategoryBomTree()\n  },\n  methods: {\n    onExpand(val) {\n      this.expandedKeys = val\n      this.data = []\n      this.currentPage = 1\n      this.getQueryMaterialBaseInfo()\n    },\n    handleInfiniteOnLoad() {\n      this.busy = true\n      this.loading = true\n      if (this.expandedKeys.length) {\n        if (this.currentPage > this.pages) {\n          return\n        } else {\n          this.getQueryMaterialBaseInfo(this.currentPage)\n        }\n        this.busy = false\n        this.loading = false\n      }\n    },\n    // 获取公司所有原材料分类\n    getCategoryBomTree() {\n      get(api.bomCategoryTree).then(res => {\n        if (res.data.code === 0) {\n          const mapObj = {\n            name: 'title',\n            id: 'key',\n            childrens: 'children'\n          }\n          // 全局替换字段名\n          const conversion = JSON.parse(JSON.stringify(res.data.data).replace(/name|id|childrens/gi, function (matched) {\n            return mapObj[matched]\n          }))\n          this.gData = Array.from(conversion)\n        }\n      })\n    },\n    // 获取原材料基本信息\n    getQueryMaterialBaseInfo(currentPage = 1) {\n      const data = {}\n      data.catId = this.expandedKeys[0]\n      data.pageSize = 15\n      data.currentPage = currentPage\n      post(api.getQueryMaterialBaseInfo, data).then(res => {\n        if (res.data.code === 0) {\n          this.currentPage += 1\n          this.data = this.data.concat(res.data.data.records)\n          this.pages = Number(res.data.data.pages)\n        }\n      })\n    },\n    // 添加新材料\n    addMaterial(id, unit) {\n      console.log(1)\n      postJson(api.addMaterialOrderMateriala, { materialId: id, unit: unit }).then(res => {\n        if (res.data.code === 0) {\n          this.$message.success('添加成功')\n        } else {\n          this.$message.error(res.data.msg)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import \"~styles/dispach.less\";\n.material {\n  overflow: auto;\n  min-height: 60vh;\n  max-height: 60vh;\n}\n.new-material {\n  padding: 0 10px;\n  min-height: 60vh;\n}\n\n.demo-infinite-container {\n  border-left: 1px solid #ccc;\n  min-height: 60vh;\n}\n</style>\n"],"sourceRoot":"src/views/procurement/purchasList/other"}]}