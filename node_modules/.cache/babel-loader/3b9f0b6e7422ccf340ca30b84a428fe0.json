{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/user/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/user/Login.vue","mtime":1557731550952},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _JSON$stringify from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { post } from '@/api/axios.js';\nimport api from '@/api/index.js';\nexport default {\n  name: 'Login',\n  data: function data() {\n    return {\n      remenberMe: false,\n      visible: false,\n      selectCompanyData: ''\n    };\n  },\n  beforeCreate: function beforeCreate() {\n    this.loginInfo = this.$form.createForm(this);\n  },\n  mounted: function mounted() {// this.setRemenberLoginInfo()\n  },\n  methods: {\n    // 记住密码\n    onRemenberMe: function onRemenberMe(e) {\n      this.remenberMe = e.target.checked;\n      var remenberLoginInfo = this.loginInfo.getFieldsValue(['userName', 'password']);\n\n      if (this.remenberMe) {\n        console.log(remenberLoginInfo);\n        localStorage.setItem('remenberLoginInfo', _JSON$stringify(remenberLoginInfo));\n      }\n    },\n    setRemenberLoginInfo: function setRemenberLoginInfo() {\n      var getRemenberLoginInfo = localStorage.getItem('remenberLoginInfo');\n      console.log(getRemenberLoginInfo);\n      this.loginInfo.setFieldsValue({\n        userName: getRemenberLoginInfo.userName,\n        password: getRemenberLoginInfo.password\n      });\n    },\n    // 登录提交\n    handleSubmit: function handleSubmit(e) {\n      var _this = this;\n\n      e.preventDefault();\n      this.loginInfo.validateFields(function (err, values) {\n        if (!err) {\n          var loginObj = {\n            phone: values.userName,\n            pwd: values.password\n          };\n          post(api.login, loginObj).then(function (res) {\n            if (res.data.code === 0 && res.data.data.companys.length !== 0) {\n              console.log(res.data);\n              localStorage.setItem('NICK', res.data.data.user.name); // token\n\n              localStorage.setItem('ACCESS_TOKEN', res.data.data['AUTH-TOKEN']);\n\n              if (res.data.data.companys.length > 1) {\n                _this.success(); // 获取公司信息\n\n\n                _this.selectCompanyData = res.data.data.companys;\n                return false;\n              }\n\n              localStorage.setItem('companyId', res.data.data.companys[0].companyId);\n\n              _this.$message.success('登录成功', 1);\n\n              _this.$router.push('/permission');\n\n              return false;\n            }\n\n            _this.$message.error('登录失败', 1.5);\n          }).catch(function (err) {\n            console.log(err);\n          });\n        }\n      });\n    },\n    handleCancel: function handleCancel() {\n      this.visible = false;\n    },\n    success: function success() {\n      var _this2 = this;\n\n      this.$message.success('登录成功', 1).then(function () {\n        // 显示弹出层\n        _this2.visible = true;\n      });\n    },\n    selectCompanyOk: function selectCompanyOk(index, item) {\n      // companyId\n      localStorage.setItem('companyId', this.selectCompanyData[index].companyId);\n      this.visible = false;\n      this.$message.loading('欢迎回来', 1.5);\n      this.$router.push('/permission');\n    }\n  }\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmEA,SAAA,IAAA,QAAA,gBAAA;AACA,OAAA,GAAA,MAAA,gBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,KADA;AAEA,MAAA,OAAA,EAAA,KAFA;AAGA,MAAA,iBAAA,EAAA;AAHA,KAAA;AAKA,GARA;AASA,EAAA,YATA,0BASA;AACA,SAAA,SAAA,GAAA,KAAA,KAAA,CAAA,UAAA,CAAA,IAAA,CAAA;AACA,GAXA;AAYA,EAAA,OAZA,qBAYA,CACA;AACA,GAdA;AAeA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,YAFA,wBAEA,CAFA,EAEA;AACA,WAAA,UAAA,GAAA,CAAA,CAAA,MAAA,CAAA,OAAA;AACA,UAAA,iBAAA,GAAA,KAAA,SAAA,CAAA,cAAA,CAAA,CACA,UADA,EAEA,UAFA,CAAA,CAAA;;AAIA,UAAA,KAAA,UAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,iBAAA;AACA,QAAA,YAAA,CAAA,OAAA,CACA,mBADA,EAEA,gBAAA,iBAAA,CAFA;AAIA;AACA,KAfA;AAgBA,IAAA,oBAhBA,kCAgBA;AACA,UAAA,oBAAA,GAAA,YAAA,CAAA,OAAA,CAAA,mBAAA,CAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,oBAAA;AACA,WAAA,SAAA,CAAA,cAAA,CAAA;AACA,QAAA,QAAA,EAAA,oBAAA,CAAA,QADA;AAEA,QAAA,QAAA,EAAA,oBAAA,CAAA;AAFA,OAAA;AAIA,KAvBA;AAwBA;AACA,IAAA,YAzBA,wBAyBA,CAzBA,EAyBA;AAAA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,WAAA,SAAA,CAAA,cAAA,CAAA,UAAA,GAAA,EAAA,MAAA,EAAA;AACA,YAAA,CAAA,GAAA,EAAA;AACA,cAAA,QAAA,GAAA;AACA,YAAA,KAAA,EAAA,MAAA,CAAA,QADA;AAEA,YAAA,GAAA,EAAA,MAAA,CAAA;AAFA,WAAA;AAIA,UAAA,IAAA,CAAA,GAAA,CAAA,KAAA,EAAA,QAAA,CAAA,CACA,IADA,CACA,UAAA,GAAA,EAAA;AACA,gBAAA,GAAA,CAAA,IAAA,CAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,QAAA,CAAA,MAAA,KAAA,CAAA,EAAA;AACA,cAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA,IAAA;AACA,cAAA,YAAA,CAAA,OAAA,CAAA,MAAA,EAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,IAAA,CAAA,IAAA,EAFA,CAGA;;AACA,cAAA,YAAA,CAAA,OAAA,CACA,cADA,EAEA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,YAAA,CAFA;;AAIA,kBAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,QAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,gBAAA,KAAA,CAAA,OAAA,GADA,CAEA;;;AACA,gBAAA,KAAA,CAAA,iBAAA,GAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,QAAA;AACA,uBAAA,KAAA;AACA;;AACA,cAAA,YAAA,CAAA,OAAA,CAAA,WAAA,EAAA,GAAA,CAAA,IAAA,CAAA,IAAA,CAAA,QAAA,CAAA,CAAA,EAAA,SAAA;;AACA,cAAA,KAAA,CAAA,QAAA,CAAA,OAAA,CAAA,MAAA,EAAA,CAAA;;AACA,cAAA,KAAA,CAAA,OAAA,CAAA,IAAA,CAAA,aAAA;;AACA,qBAAA,KAAA;AACA;;AACA,YAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,MAAA,EAAA,GAAA;AACA,WAtBA,EAuBA,KAvBA,CAuBA,UAAA,GAAA,EAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,WAzBA;AA0BA;AACA,OAjCA;AAkCA,KA7DA;AA8DA,IAAA,YA9DA,0BA8DA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,KAhEA;AAiEA,IAAA,OAjEA,qBAiEA;AAAA;;AACA,WAAA,QAAA,CAAA,OAAA,CAAA,MAAA,EAAA,CAAA,EAAA,IAAA,CAAA,YAAA;AACA;AACA,QAAA,MAAA,CAAA,OAAA,GAAA,IAAA;AACA,OAHA;AAIA,KAtEA;AAuEA,IAAA,eAvEA,2BAuEA,KAvEA,EAuEA,IAvEA,EAuEA;AACA;AACA,MAAA,YAAA,CAAA,OAAA,CAAA,WAAA,EAAA,KAAA,iBAAA,CAAA,KAAA,EAAA,SAAA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,WAAA,QAAA,CAAA,OAAA,CAAA,MAAA,EAAA,GAAA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,aAAA;AACA;AA7EA;AAfA,CAAA","sourcesContent":["<template>\n  <div class=\"login\">\n    <div class=\"bg-color\"></div>\n    <div class=\"login-wrapper\" style=\"border: 1px solid #F5F5F5; box-shadow: #666 0px 0px 10px; background: #FFF; padding: 20px; border-radius: 4px;\">\n      <!-- <h3>扫码登录</h3> -->\n      <!-- 密码登录 -->\n      <div class=\"pwdLogin\">\n        <a-divider>密码登录</a-divider>\n        <a-form\n          id=\"components-form-demo-normal-login\"\n          :form=\"loginInfo\"\n          class=\"login-form\"\n          @submit=\"handleSubmit\"\n        >\n          <a-form-item>\n            <a-input\n              v-decorator=\"[\n          'userName',\n          { rules: [{ required: true, pattern: /^1[34578]\\d{9}$/, message: '请输入正确的手机号！' }], validateTrigger: 'blur' }\n        ]\"\n              placeholder=\"请输入手机号\"\n            >\n              <a-icon slot=\"prefix\" type=\"user\" style=\"color: rgba(0,0,0,.25)\"/>\n            </a-input>\n          </a-form-item>\n          <a-form-item>\n            <a-input\n              v-decorator=\"[\n          'password',\n          { rules: [{ required: true, pattern: /^[\\w]{6,18}$/, message: '请输入6~18位密码！' }], validateTrigger: 'blur' }\n        ]\"\n              type=\"password\"\n              placeholder=\"请输入密码\"\n            >\n              <a-icon slot=\"prefix\" type=\"lock\" style=\"color: rgba(0,0,0,.25)\"/>\n            </a-input>\n          </a-form-item>\n          <a-form-item>\n            <a-checkbox :checked=\"remenberMe\" @change=\"onRemenberMe\">记住密码</a-checkbox>\n            <router-link to=\"/retrieve\" class=\"login-form-forgot\">忘记密码</router-link>\n            <a-button type=\"primary\" html-type=\"submit\" class=\"login-form-button\">登录</a-button>\n            <router-link to=\"/register\">跳转注册</router-link>\n          </a-form-item>\n        </a-form>\n\n        <!-- 弹出层 -->\n        <a-modal title=\"选择公司\" :visible=\"visible\" :footer=\"null\" @cancel=\"handleCancel\">\n          <a-card>\n            <a-card-grid\n              style=\"width:25%;textAlign:'center'\"\n              class=\"selectCompany\"\n              @click=\"selectCompanyOk(index, item)\"\n              v-for=\"(item, index) of this.selectCompanyData\"\n              :key=\"index\"\n            >\n              <h3>{{ item.companyName }}</h3>\n              <img :src=\"item.companyLogo\" :alt=\"item.companyName\">\n            </a-card-grid>\n          </a-card>\n        </a-modal>\n      </div>\n      <!-- 扫码登录 -->\n      <!-- <div class=\"codeLogin\"></div> -->\n    </div>\n  </div>\n</template>\n<script>\nimport { post } from '@/api/axios.js'\nimport api from '@/api/index.js'\n\nexport default {\n  name: 'Login',\n  data() {\n    return {\n      remenberMe: false,\n      visible: false,\n      selectCompanyData: ''\n    }\n  },\n  beforeCreate() {\n    this.loginInfo = this.$form.createForm(this)\n  },\n  mounted() {\n    // this.setRemenberLoginInfo()\n  },\n  methods: {\n    // 记住密码\n    onRemenberMe(e) {\n      this.remenberMe = e.target.checked\n      const remenberLoginInfo = this.loginInfo.getFieldsValue([\n        'userName',\n        'password'\n      ])\n      if (this.remenberMe) {\n        console.log(remenberLoginInfo)\n        localStorage.setItem(\n          'remenberLoginInfo',\n          JSON.stringify(remenberLoginInfo)\n        )\n      }\n    },\n    setRemenberLoginInfo() {\n      const getRemenberLoginInfo = localStorage.getItem('remenberLoginInfo')\n      console.log(getRemenberLoginInfo)\n      this.loginInfo.setFieldsValue({\n        userName: getRemenberLoginInfo.userName,\n        password: getRemenberLoginInfo.password\n      })\n    },\n    // 登录提交\n    handleSubmit(e) {\n      e.preventDefault()\n      this.loginInfo.validateFields((err, values) => {\n        if (!err) {\n          const loginObj = {\n            phone: values.userName,\n            pwd: values.password\n          }\n          post(api.login, loginObj)\n            .then(res => {\n              if (res.data.code === 0 && res.data.data.companys.length !== 0) {\n                console.log(res.data)\n                localStorage.setItem('NICK', res.data.data.user.name)\n                // token\n                localStorage.setItem(\n                  'ACCESS_TOKEN',\n                  res.data.data['AUTH-TOKEN']\n                )\n                if (res.data.data.companys.length > 1) {\n                  this.success()\n                  // 获取公司信息\n                  this.selectCompanyData = res.data.data.companys\n                  return false\n                }\n                localStorage.setItem('companyId', res.data.data.companys[0].companyId)\n                this.$message.success('登录成功', 1)\n                this.$router.push('/permission')\n                return false\n              }\n              this.$message.error('登录失败', 1.5)\n            })\n            .catch(err => {\n              console.log(err)\n            })\n        }\n      })\n    },\n    handleCancel() {\n      this.visible = false\n    },\n    success() {\n      this.$message.success('登录成功', 1).then(() => {\n        // 显示弹出层\n        this.visible = true\n      })\n    },\n    selectCompanyOk(index, item) {\n      // companyId\n      localStorage.setItem('companyId', this.selectCompanyData[index].companyId)\n      this.visible = false\n      this.$message.loading('欢迎回来', 1.5)\n      this.$router.push('/permission')\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.login {\n  position: fixed;\n  width: 400px;\n  min-height: 300px;\n  left: 50%;\n  top: 50%;\n  margin-left: 100px;\n  margin-top: -240px;\n  .bg-color {\n    position: fixed;\n    z-index: -100;\n    left: 0;\n    top: 0;\n    right: 0;\n    bottom: 0;\n    background: url('../../assets/loginBg.png') no-repeat center;\n    background-size: cover;\n  }\n  .login-wrapper {\n    margin-top: 20px;\n  }\n}\n.selectCompany {\n  text-align: center;\n  cursor: pointer;\n  h3 {\n    text-align: center;\n  }\n  img {\n    height: 60px;\n  }\n}\n#components-form-demo-normal-login .login-form {\n  max-width: 300px;\n}\n#components-form-demo-normal-login .login-form-forgot {\n  float: right;\n}\n#components-form-demo-normal-login .login-form-button {\n  width: 100%;\n}\n</style>\n"],"sourceRoot":"src/views/user"}]}