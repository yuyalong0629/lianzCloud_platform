{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/category/child_info/CategoryInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/category/child_info/CategoryInfo.vue","mtime":1558529326523},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Object$assign from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/object/assign\";\nimport _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport PromptTitle from '@/components/tools/prompt/PromptTitle';\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin';\nimport { getGoodsClass, postCategoryAdd, onSave as _onSave, deleteCategory } from '../basic_lib/index';\nimport { setTimeout } from 'timers';\nimport { Promise } from 'q';\nimport { findParentId } from 'utils/utils.js';\nexport default {\n  name: 'CategoryInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data: function data() {\n    return {\n      cateGoryInfo: this.$form.createForm(this),\n      options: [],\n      viewCategoryInfo: {},\n      categorySuperiorObj: {\n        val: [],\n        id: []\n      }\n    };\n  },\n  props: {\n    categoryInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created: function created() {},\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName: function onChangeCategoryName(value) {\n      console.log(value);\n    },\n    // 提交\n    onSubmit: function onSubmit(e) {\n      e.preventDefault();\n      this.getFormData(null, postCategoryAdd);\n    },\n    // 保存修改\n    onSave: function onSave(e) {\n      e.preventDefault();\n      this.getFormData(this.viewCategoryInfo.id, _onSave);\n    },\n    // 编辑 || 取消\n    isDisabled: function isDisabled(val) {\n      var _this = this;\n\n      var edit = new Promise(function (resolved) {\n        // Input选中\n        _this.disabled = !val; // label color\n\n        _this.isLabelColor = !_this.isLabelColor;\n        resolved();\n      });\n      edit.then(function () {\n        if (_this.disabled) {\n          _this.setFormData();\n        }\n      });\n    },\n    // 删除\n    isDelete: function isDelete(val) {\n      var _this2 = this;\n\n      deleteCategory.call(this, this.viewCategoryInfo.id).then(function () {\n        _this2.$emit('isDrawer', val);\n      });\n    },\n    // FormData\n    getFormData: function () {\n      var _getFormData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee(id, postCategory) {\n        var _this3 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.cateGoryInfo.validateFields(function (err, values) {\n                  if (!err) {\n                    _this3.loading = true;\n                    var params = {\n                      catType: 0,\n                      id: id,\n                      name: values.categoryClassName || '',\n                      pid: values.categorySuperior ? values.categorySuperior.slice(-1).join('') : 0,\n                      remark: values.categoryRemark || ''\n                    };\n                    postCategory.call(_this3, params);\n                  }\n                });\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getFormData(_x, _x2) {\n        return _getFormData.apply(this, arguments);\n      }\n\n      return getFormData;\n    }(),\n    // Form详情\n    setFormData: function setFormData() {\n      this.cateGoryInfo.setFieldsValue({\n        categoryClassName: this.viewCategoryInfo.name,\n        categorySuperior: _toConsumableArray(this.categorySuperiorObj.id),\n        // categorySuperior: ['7818633903429136384', '7819150625907683328'],\n        categoryRemark: this.viewCategoryInfo.remark\n      });\n    }\n  },\n  watch: {\n    // Info\n    categoryInfo: {\n      handler: function handler(val) {\n        var _this4 = this;\n\n        this.viewCategoryInfo = _Object$assign({}, val);\n        getGoodsClass.call(this).then(function () {\n          _this4.categorySuperiorObj.val = findParentId(val.id, _this4.options, 'name');\n          _this4.categorySuperiorObj.id = findParentId(val.id, _this4.options, 'id');\n        }); // console.log(this.categorySuperiorObj)\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n};",{"version":3,"sources":["CategoryInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"category-info\">\n    <prompt-title @isDisabled=\"isDisabled\" @isDelete=\"isDelete\"></prompt-title>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"categoryInfo-title\">客户信息</h3>\n      </a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <a-form :form=\"cateGoryInfo\" layout=\"horizontal\" hideRequiredMark>\n          <a-form-item\n            label=\"分类名称\"\n            :class=\"{labelColor: isLabelColor}\"\n            :label-col=\"labelCol\"\n            :wrapper-col=\"wrapperCol\"\n          >\n            <a-input\n              v-if=\"disabled\"\n              v-decorator=\"['categoryClassName', {rules: [{ required: true, message: '请输入分类名称' }]}]\"\n              placeholder=\"请输入分类名称\"\n            />\n            <template v-else=\"!disabled\">{{viewCategoryInfo.name}}</template>\n          </a-form-item>\n          <a-form-item\n            label=\"上级分类\"\n            :class=\"{labelColor: isLabelColor}\"\n            :label-col=\"labelCol\"\n            :wrapper-col=\"wrapperCol\"\n          >\n            <a-cascader\n              v-if=\"disabled\"\n              v-decorator=\"['categorySuperior']\"\n              :options=\"options\"\n              :fieldNames=\"{ label: 'name', value: 'id', children: 'childrens' }\"\n              @change=\"onChangeCategoryName\"\n              placeholder=\"请输入分类名称\"\n              changeOnSelect\n            />\n            <template\n              v-else=\"!disabled\"\n            >{{categorySuperiorObj.val.length > 1 ? categorySuperiorObj.val.slice(0, -1).join('/') : '无上级分类'}}</template>\n          </a-form-item>\n          <a-form-item\n            label=\"备注\"\n            :class=\"{labelColor: isLabelColor}\"\n            :label-col=\"labelCol\"\n            :wrapper-col=\"wrapperCol\"\n          >\n            <a-input v-if=\"disabled\" v-decorator=\"['categoryRemark']\" placeholder=\"请输入备注\"/>\n            <template v-else=\"!disabled\">{{viewCategoryInfo.remark}}</template>\n          </a-form-item>\n        </a-form>\n      </a-col>\n    </a-row>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport PromptTitle from '@/components/tools/prompt/PromptTitle'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport {\n  getGoodsClass,\n  postCategoryAdd,\n  onSave,\n  deleteCategory\n} from '../basic_lib/index'\nimport { setTimeout } from 'timers'\nimport { Promise } from 'q'\nimport { findParentId } from 'utils/utils.js'\n\nexport default {\n  name: 'CategoryInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      cateGoryInfo: this.$form.createForm(this),\n      options: [],\n      viewCategoryInfo: {},\n      categorySuperiorObj: {\n        val: [],\n        id: []\n      }\n    }\n  },\n  props: {\n    categoryInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created() {},\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName(value) {\n      console.log(value)\n    },\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData(null, postCategoryAdd)\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData(this.viewCategoryInfo.id, onSave)\n    },\n    // 编辑 || 取消\n    isDisabled(val) {\n      const edit = new Promise(resolved => {\n        // Input选中\n        this.disabled = !val\n        // label color\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    },\n    // 删除\n    isDelete(val) {\n      deleteCategory.call(this, this.viewCategoryInfo.id).then(() => {\n        this.$emit('isDrawer', val)\n      })\n    },\n    // FormData\n    async getFormData(id, postCategory) {\n      this.cateGoryInfo.validateFields((err, values) => {\n        if (!err) {\n          this.loading = true\n          const params = {\n            catType: 0,\n            id,\n            name: values.categoryClassName || '',\n            pid: values.categorySuperior\n              ? values.categorySuperior.slice(-1).join('')\n              : 0,\n            remark: values.categoryRemark || ''\n          }\n          postCategory.call(this, params)\n        }\n      })\n    },\n    // Form详情\n    setFormData() {\n      this.cateGoryInfo.setFieldsValue({\n        categoryClassName: this.viewCategoryInfo.name,\n        categorySuperior: [...this.categorySuperiorObj.id],\n        // categorySuperior: ['7818633903429136384', '7819150625907683328'],\n        categoryRemark: this.viewCategoryInfo.remark\n      })\n    }\n  },\n  watch: {\n    // Info\n    categoryInfo: {\n      handler(val) {\n        this.viewCategoryInfo = Object.assign({}, val)\n        getGoodsClass.call(this).then(() => {\n          this.categorySuperiorObj.val = findParentId(\n            val.id,\n            this.options,\n            'name'\n          )\n          this.categorySuperiorObj.id = findParentId(val.id, this.options, 'id')\n        })\n        // console.log(this.categorySuperiorObj)\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.category-info {\n  .categoryInfo-title {\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>"],"sourceRoot":"src/views/product/category/child_info"}]}