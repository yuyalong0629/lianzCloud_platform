{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/cust/Customer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/cust/Customer.vue","mtime":1563189294134},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CustomerInfo from './child_info/CustomerInfo';\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin';\nimport { columnCust } from './basic_lib/column';\nimport Animation from '@/assets/common/Animation';\nimport { showCustomersPage, removeCustomer, getCustomerAndMallUser, getCustIndustry, custNamefetch, custCodefetch, custManagerfetch } from './basic_lib/index';\nimport { setTimeout } from 'timers';\nexport default {\n  name: 'Catattr',\n  mixins: [mixinBasic, mixinDrawer],\n  data: function data() {\n    var _ref;\n\n    return _ref = {\n      advanced: false,\n      tabData: [],\n      columnCust: columnCust\n    }, _defineProperty(_ref, \"advanced\", false), _defineProperty(_ref, \"pagination\", {\n      total: 0,\n      defaultPageSize: 15,\n      defaultCurrent: 1,\n      showQuickJumper: true,\n      hideOnSinglePage: true,\n      showSizeChanger: true,\n      pageSizeOptions: ['10', '15', '30', '50', '100']\n    }), _defineProperty(_ref, \"selectedRowKeys\", []), _defineProperty(_ref, \"custNameData\", []), _defineProperty(_ref, \"custNameValue\", undefined), _defineProperty(_ref, \"custManagerData\", []), _defineProperty(_ref, \"custManagerValue\", undefined), _defineProperty(_ref, \"custSearchLevel\", undefined), _defineProperty(_ref, \"custCodeData\", []), _defineProperty(_ref, \"custCodeValue\", undefined), _defineProperty(_ref, \"custIndustryArr\", []), _defineProperty(_ref, \"defaultCustIndustry\", undefined), _defineProperty(_ref, \"defaultStatus\", undefined), _defineProperty(_ref, \"customerInfo\", {}), _ref;\n  },\n  created: function created() {\n    // 获取客户行业字典表\n    getCustIndustry.call(this, 'INDUSTRY'); // 初始化客户信息\n\n    showCustomersPage.call(this, {});\n  },\n  methods: {\n    // 删除\n    custDelete: function custDelete() {\n      var that = this;\n\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk: function onOk() {\n            var params = that.selectedRowKeys.join('&customerIds=');\n            console.log(\"?customerIds=\".concat(params));\n            removeCustomer.call(that, params).then(function () {\n              that.rest().then(function () {\n                showCustomersPage.call(that, {});\n                that.selectedRowKeys = [];\n              });\n            });\n          },\n          onCancel: function onCancel() {\n            console.log('Cancel');\n          },\n          class: 'test'\n        });\n      } else {\n        this.$message.warn('请先选择删除项');\n      }\n    },\n    // 搜索展开\n    toggleAdvanced: function toggleAdvanced() {\n      this.advanced = !this.advanced;\n    },\n    // 重置\n    rest: function () {\n      var _rest = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.custNameValue = undefined;\n                this.custManagerValue = undefined;\n                this.custSearchLevel = undefined;\n                this.custCodeValue = undefined;\n                this.defaultCustIndustry = undefined;\n                this.defaultStatus = undefined;\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function rest() {\n        return _rest.apply(this, arguments);\n      }\n\n      return rest;\n    }(),\n    custRest: function custRest() {\n      var _this = this;\n\n      this.rest().then(function () {\n        showCustomersPage.call(_this, {});\n      });\n    },\n    // 模糊搜索function\n    custSearch: function custSearch() {\n      showCustomersPage.call(this, {\n        custDtoName: this.custNameValue || '',\n        // 客户名称\n        custDtoManager: this.custManagerValue || '',\n        // 客户经理\n        custDtoLevel: this.custSearchLevel - 0 || 0,\n        // 客户等级\n        custDtoCode: this.custCodeValue || '',\n        // 客户编码\n        custDtoIndustry: this.defaultCustIndustry || '',\n        // 客户行业\n        custDtoStatus: this.defaultStatus || '' // 客户状态\n\n      });\n    },\n    // 客户名称搜索\n    handleCustNameSearch: function handleCustNameSearch(value) {\n      var _this2 = this;\n\n      custNamefetch.call(this, value, function (data) {\n        return _this2.custNameData = data;\n      });\n    },\n    handleCustNameChange: function handleCustNameChange(value) {\n      console.log(value);\n      this.custNameValue = value;\n      this.custSearch();\n    },\n    // 客户经理搜索\n    handleCustManagerSearch: function handleCustManagerSearch(value) {\n      var _this3 = this;\n\n      custManagerfetch.call(this, value, function (data) {\n        return _this3.custManagerData = data;\n      });\n    },\n    handleCustManagerChange: function handleCustManagerChange(value) {\n      console.log(value);\n      this.custManagerValue = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 客户等级\n    onleChangeRank: function onleChangeRank(value) {\n      console.log(value);\n      this.custSearchLevel = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 客户编码搜索\n    handleCustCodeSearch: function handleCustCodeSearch(value) {\n      var _this4 = this;\n\n      custCodefetch.call(this, value, function (data) {\n        return _this4.custCodeData = data;\n      });\n    },\n    handleCustCodeChange: function handleCustCodeChange(value) {\n      this.custCodeValue = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 行业\n    onleChangeindustry: function onleChangeindustry(value) {\n      console.log(value);\n      this.defaultCustIndustry = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 客户状态\n    onleChangeStatus: function onleChangeStatus(value) {\n      this.defaultStatus = value;\n      console.log(this.defaultStatus); // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 查看详情\n    onHandleInfo: function onHandleInfo(record) {\n      var _this5 = this;\n\n      if (this.getMenuPermission.includes('DETAIL')) {\n        getCustomerAndMallUser.call(this, record.key).then(function () {\n          _this5.visible = true;\n        });\n        this.$store.commit('setPromptTitle', {\n          title: '客户信息详情',\n          isEdit: true\n        });\n        return;\n      }\n\n      this.$message.error('权限不足');\n    },\n    // 分页管理\n    onChangePage: function onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标');\n      console.log(pagination.pageSize);\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      }); // 切换分页先清空选中状态\n\n      this.selectedRowKeys = [];\n    },\n    // 分页\n    onShowSizeChange: function onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize);\n    },\n    // $emit改变isvisible\n    isDrawer: function isDrawer(val) {\n      var _this6 = this;\n\n      this.visible = val; // 关闭抽屉主动初始化\n\n      this.timer = setTimeout(function () {\n        _this6.rest().then(function () {\n          showCustomersPage.call(_this6, {});\n        });\n      }, 100);\n    },\n    // 新建\n    showDrawer: function showDrawer() {\n      this.visible = true;\n      this.customerInfo = {};\n      this.$store.commit('setPromptTitle', {\n        title: '新建客户信息',\n        isEdit: false\n      });\n    },\n    // Tab 删除\n    onChangeTab: function onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys);\n      this.selectedRowKeys = selectedRowKeys;\n    }\n  },\n  computed: {\n    rowSelection: function rowSelection() {\n      var selectedRowKeys = this.selectedRowKeys;\n      return {\n        selectedRowKeys: selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      };\n    },\n    getMenuPermission: function getMenuPermission() {\n      return this.$store.state.menuPermission;\n    }\n  },\n  components: {\n    'customer-info': CustomerInfo,\n    Animation: Animation\n  }\n};",{"version":3,"sources":["Customer.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"customer\">\n    <div class=\"catattr-setup\">\n      <a-button type=\"primary\" @click=\"showDrawer\" v-show=\"this.getMenuPermission.includes('ADD')\">\n        <a-icon type=\"plus\" />新建\n      </a-button>\n      <span\n        class=\"delete-btn\"\n        @click=\"custDelete\"\n        v-show=\"this.getMenuPermission.includes('DELETES')\"\n      >\n        <a-icon class=\"delete-icon\" type=\"delete\" />\n        <span>删除</span>\n      </span>\n      <a-dropdown>\n        <span class=\"derive-btn\">\n          <a-icon class=\"derive-icon\" type=\"check-circle\" />\n          <span>更多</span>\n        </span>\n        <a-menu slot=\"overlay\">\n          <a-menu-item key=\"0\" v-show=\"this.getMenuPermission.includes('IMPORT')\">\n            <span>导入</span>\n          </a-menu-item>\n          <a-menu-item key=\"1\" v-show=\"this.getMenuPermission.includes('EXPORT')\">\n            <span>导出</span>\n          </a-menu-item>\n        </a-menu>\n      </a-dropdown>\n    </div>\n    <!-- 客户选择 -->\n    <div class=\"cust-select\">\n      <a-form layout=\"inline\">\n        <a-row>\n          <a-col :span=\"20\">\n            <a-row>\n              <a-col :span=\"24\" style=\"margin: 8px 0;\">\n                <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"客户简称\">\n                  <a-select\n                    showSearch\n                    allowClear\n                    :value=\"custNameValue\"\n                    placeholder=\"请输入客户简称\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustNameSearch\"\n                    @change=\"handleCustNameChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option v-for=\"(d, i) in custNameData\" :key=\"d\">{{ d }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户经理\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    showSearch\n                    allowClear\n                    :value=\"custManagerValue\"\n                    placeholder=\"请输入客户经理\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustManagerSearch\"\n                    @change=\"handleCustManagerChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option\n                      v-for=\"(d, i) in custManagerData\"\n                      :key=\"d.text\"\n                      :value=\"d.value\"\n                    >{{ d.value }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户等级\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    allowClear\n                    placeholder=\"请输入客户等级\"\n                    :value=\"custSearchLevel\"\n                    @change=\"onleChangeRank\"\n                    style=\"width: 200px\"\n                  >\n                    <a-select-option value=\"1\">V1</a-select-option>\n                    <a-select-option value=\"2\">V2</a-select-option>\n                    <a-select-option value=\"3\">V3</a-select-option>\n                    <a-select-option value=\"4\">V4</a-select-option>\n                    <a-select-option value=\"5\">V5</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <Animation name=\"fadeIn\">\n                  <a-row v-if=\"advanced\">\n                    <a-col :span=\"24\">\n                      <a-form-item\n                        label=\"客户编码\"\n                        :label-col=\"{ span: 8 }\"\n                        :wrapper-col=\"{ span: 14 }\"\n                      >\n                        <a-select\n                          showSearch\n                          allowClear\n                          :value=\"custCodeValue\"\n                          placeholder=\"请输入客户编码\"\n                          style=\"width: 200px\"\n                          :defaultActiveFirstOption=\"false\"\n                          :showArrow=\"false\"\n                          :filterOption=\"false\"\n                          @search=\"handleCustCodeSearch\"\n                          @change=\"handleCustCodeChange\"\n                          :notFoundContent=\"null\"\n                        >\n                          <a-select-option v-for=\"(d, i) in custCodeData\" :key=\"d\">{{ d }}</a-select-option>\n                        </a-select>\n                      </a-form-item>\n                      <a-form-item\n                        label=\"客户行业\"\n                        :label-col=\"{ span: 8 }\"\n                        :wrapper-col=\"{ span: 14 }\"\n                      >\n                        <a-select\n                          allowClear\n                          :value=\"defaultCustIndustry\"\n                          @change=\"onleChangeindustry\"\n                          style=\"width: 200px\"\n                          placeholder=\"请输入行业\"\n                        >\n                          <a-select-option\n                            v-for=\"item of custIndustryArr\"\n                            :key=\"item.id\"\n                            :value=\"item.id\"\n                          >{{ item.displayValue }}</a-select-option>\n                        </a-select>\n                      </a-form-item>\n                      <a-form-item\n                        label=\"客户状态\"\n                        :label-col=\"{ span: 8 }\"\n                        :wrapper-col=\"{ span: 14 }\"\n                      >\n                        <a-select\n                          :value=\"defaultStatus\"\n                          placeholder=\"客户状态\"\n                          style=\"width: 200px\"\n                          @change=\"onleChangeStatus\"\n                        >\n                          <a-select-option value=\"1\">已购买</a-select-option>\n                          <a-select-option value=\"0\">未购买</a-select-option>\n                        </a-select>\n                      </a-form-item>\n                    </a-col>\n                  </a-row>\n                </Animation>\n              </a-col>\n            </a-row>\n          </a-col>\n          <a-col :span=\"4\">\n            <a-form-item>\n              <span class=\"cust-select-reset\" @click=\"custRest\">重置</span>\n              <span @click=\"toggleAdvanced\" style=\"cursor: pointer;\">\n                {{ advanced ? '收起' : '展开' }}\n                <a-icon :type=\"advanced ? 'caret-up' : 'caret-down'\" />\n              </span>\n            </a-form-item>\n          </a-col>\n        </a-row>\n      </a-form>\n    </div>\n    <!-- Table -->\n    <div class=\"cust-tab\">\n      <a-table\n        :columns=\"columnCust\"\n        @change=\"onChangePage\"\n        :dataSource=\"tabData\"\n        :pagination=\"pagination\"\n        :rowSelection=\"rowSelection\"\n        :loading=\"loading\"\n        @showSizeChange=\"onShowSizeChange\"\n      >\n        <template slot=\"clientCode\" slot-scope=\"text, record\">\n          <a @click=\"onHandleInfo(record)\" href=\"javascript:;\">{{text}}</a>\n        </template>\n        <template slot=\"clientStatus\" slot-scope=\"text, record\">\n          <span\n            class=\"client-status\"\n            :class=\"[`${text}` === '1' ? 'statusOk' : 'statusNo']\"\n            :title=\"[`${text}` === '1' ? '已购买' : '未购买']\"\n          ></span>\n        </template>\n      </a-table>\n    </div>\n    <!-- 抽屉 -->\n    <a-drawer\n      :destroyOnClose=\"true\"\n      placement=\"right\"\n      :closable=\"false\"\n      @close=\"closeDrawer\"\n      :visible=\"visible\"\n      :width=\"1040\"\n      :zIndex=\"100\"\n      :wrapStyle=\"{height: '100%',overflow: 'auto',paddingBottom: '108px'}\"\n    >\n      <customer-info @isDrawer=\"isDrawer\" :customerInfo=\"customerInfo\" />\n    </a-drawer>\n  </div>\n</template>\n<script>\nimport CustomerInfo from './child_info/CustomerInfo'\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin'\nimport { columnCust } from './basic_lib/column'\nimport Animation from '@/assets/common/Animation'\nimport {\n  showCustomersPage,\n  removeCustomer,\n  getCustomerAndMallUser,\n  getCustIndustry,\n  custNamefetch,\n  custCodefetch,\n  custManagerfetch\n} from './basic_lib/index'\nimport { setTimeout } from 'timers'\n\nexport default {\n  name: 'Catattr',\n  mixins: [mixinBasic, mixinDrawer],\n  data() {\n    return {\n      advanced: false,\n      tabData: [],\n      columnCust,\n      advanced: false,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      selectedRowKeys: [], // Check here to configure the default column,\n      // 客户编码\n      custNameData: [],\n      custNameValue: undefined,\n      // 客户经理\n      custManagerData: [],\n      custManagerValue: undefined,\n      // 客户等级\n      custSearchLevel: undefined,\n      // 客户编码\n      custCodeData: [],\n      custCodeValue: undefined,\n      // 客户行业\n      custIndustryArr: [],\n      defaultCustIndustry: undefined,\n      // 客户状态\n      defaultStatus: undefined,\n      // 详情\n      customerInfo: {}\n    }\n  },\n  created() {\n    // 获取客户行业字典表\n    getCustIndustry.call(this, 'INDUSTRY')\n    // 初始化客户信息\n    showCustomersPage.call(this, {})\n  },\n  methods: {\n    // 删除\n    custDelete() {\n      const that = this\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk() {\n            const params = that.selectedRowKeys.join('&customerIds=')\n            console.log(`?customerIds=${params}`)\n            removeCustomer.call(that, params).then(() => {\n              that.rest().then(() => {\n                showCustomersPage.call(that, {})\n                that.selectedRowKeys = []\n              })\n            })\n          },\n          onCancel() {\n            console.log('Cancel')\n          },\n          class: 'test'\n        })\n      } else {\n        this.$message.warn('请先选择删除项')\n      }\n    },\n    // 搜索展开\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    // 重置\n    async rest() {\n      this.custNameValue = undefined\n      this.custManagerValue = undefined\n      this.custSearchLevel = undefined\n      this.custCodeValue = undefined\n      this.defaultCustIndustry = undefined\n      this.defaultStatus = undefined\n    },\n    custRest() {\n      this.rest().then(() => {\n        showCustomersPage.call(this, {})\n      })\n    },\n    // 模糊搜索function\n    custSearch() {\n      showCustomersPage.call(this, {\n        custDtoName: this.custNameValue || '', // 客户名称\n        custDtoManager: this.custManagerValue || '', // 客户经理\n        custDtoLevel: this.custSearchLevel - 0 || 0, // 客户等级\n        custDtoCode: this.custCodeValue || '', // 客户编码\n        custDtoIndustry: this.defaultCustIndustry || '', // 客户行业\n        custDtoStatus: this.defaultStatus || '' // 客户状态\n      })\n    },\n    // 客户名称搜索\n    handleCustNameSearch(value) {\n      custNamefetch.call(this, value, data => (this.custNameData = data))\n    },\n    handleCustNameChange(value) {\n      console.log(value)\n      this.custNameValue = value\n      this.custSearch()\n    },\n    // 客户经理搜索\n    handleCustManagerSearch(value) {\n      custManagerfetch.call(this, value, data => (this.custManagerData = data))\n    },\n    handleCustManagerChange(value) {\n      console.log(value)\n      this.custManagerValue = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 客户等级\n    onleChangeRank(value) {\n      console.log(value)\n      this.custSearchLevel = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 客户编码搜索\n    handleCustCodeSearch(value) {\n      custCodefetch.call(this, value, data => (this.custCodeData = data))\n    },\n    handleCustCodeChange(value) {\n      this.custCodeValue = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 行业\n    onleChangeindustry(value) {\n      console.log(value)\n      this.defaultCustIndustry = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 客户状态\n    onleChangeStatus(value) {\n      this.defaultStatus = value\n      console.log(this.defaultStatus)\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 查看详情\n    onHandleInfo(record) {\n      if (this.getMenuPermission.includes('DETAIL')) {\n        getCustomerAndMallUser.call(this, record.key).then(() => {\n          this.visible = true\n        })\n        this.$store.commit('setPromptTitle', {\n          title: '客户信息详情',\n          isEdit: true\n        })\n        return\n      }\n      this.$message.error('权限不足')\n    },\n    // 分页管理\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 分页\n    onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize)\n    },\n    // $emit改变isvisible\n    isDrawer(val) {\n      this.visible = val\n      // 关闭抽屉主动初始化\n      this.timer = setTimeout(() => {\n        this.rest().then(() => {\n          showCustomersPage.call(this, {})\n        })\n      }, 100)\n    },\n    // 新建\n    showDrawer() {\n      this.visible = true\n      this.customerInfo = {}\n      this.$store.commit('setPromptTitle', {\n        title: '新建客户信息',\n        isEdit: false\n      })\n    },\n    // Tab 删除\n    onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys)\n      this.selectedRowKeys = selectedRowKeys\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getMenuPermission() {\n      return this.$store.state.menuPermission\n    }\n  },\n  components: {\n    'customer-info': CustomerInfo,\n    Animation\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.customer {\n  .delete-btn {\n    margin: 0 20px;\n    cursor: pointer;\n    .delete-icon {\n      .delete();\n    }\n  }\n  .derive-btn {\n    cursor: pointer;\n    .derive-icon {\n      .more();\n    }\n  }\n  .catattr-setup {\n    margin-bottom: 15px;\n  }\n  .catattr-remove {\n    margin: 0 10px;\n  }\n  .cust-select-reset {\n    margin: 0 10px;\n    cursor: pointer;\n  }\n  .cust-select {\n    margin: 16px 0;\n  }\n  .cust-tab {\n    .client-status {\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      display: inline-block;\n    }\n    .statusOk {\n      background: #6bc67b;\n    }\n    .statusNo {\n      background: #d8d8d8;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/cust"}]}