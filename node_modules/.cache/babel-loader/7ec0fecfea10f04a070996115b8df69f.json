{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/goods/goods.js","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/goods/goods.js","mtime":1557366014950},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport _Array$from from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/array/from\";\nimport _JSON$stringify from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.number.constructor\";\nimport { get, deleted, postJson, uploadPost, put } from '@/api/axios.js';\nimport api from '@/api/index.js';\n/**\n * @description: 初始化table数据\n * @param { currentPage } 当前页\n * @param { pageSize }  每页总数\n * @return: showCustomersPage\n */\n\nexport function showCustomersPage() {\n  var _this = this;\n\n  var currentPage = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n  var pageSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  this.loading = true;\n  get(api.showCustomersPage, {\n    currentPage: currentPage,\n    pageSize: pageSize\n  }).then(function (res) {\n    if (res.data.code === 0) {\n      _this.loading = false;\n      var recordsList = res.data.data; // 设置总页数\n\n      _this.pagination.total = res.data.data === null ? 0 : Number(recordsList.total); // 每次push先清空数组\n\n      _this.tabData = [];\n      recordsList.records.forEach(function (item) {\n        _this.tabData.push({\n          key: item.id,\n          clientCode: item.custCode,\n          clientShortName: item.custShortName,\n          clientAbbreviation: item.mallUserName,\n          clientName: item.mallUserName,\n          clientPhone: item.phone,\n          clientIndustryValue: item.custIndustryValue,\n          clientLevel: item.custLevel,\n          clientStatus: item.custStatus\n        });\n      });\n      return false;\n    }\n  }).catch(function (err) {\n    console.log(err);\n\n    _this.$message.error(\"\\u8BF7\\u6C42\\u8D85\\u65F6\");\n\n    _this.loading = false;\n  });\n}\n/**\n * @description: 客户管理Table列表删除操作\n * @param {params} 客户ID\n * @return: removeCustomer\n */\n\nexport function removeCustomer() {\n  var _this2 = this;\n\n  var params = this.deleteCustomer.slice(0, this.deleteCustomer.length - 1);\n  deleted(api.removeCustomer + \"?\".concat(params)).then(function (res) {\n    if (res.data.code === 0) {\n      _this2.loading = false;\n\n      _this2.$message.success('删除成功');\n\n      return false;\n    }\n  }).catch(function (err) {\n    console.log(err);\n\n    _this2.$message.error('请求错误');\n\n    _this2.loading = false;\n  });\n}\n/**\n * @description: 获取商品类目树形列表\n * @param {type} default\n * @return: getGoodsTree\n */\n\nexport function getGoodsTree() {\n  var _this3 = this;\n\n  return get(api.goodsTree + '1/999').then(function (res) {\n    var mapObj = {\n      name: 'title',\n      id: 'key',\n      childrens: 'children' // 全局替换字段名\n\n    };\n    var conversion = JSON.parse(_JSON$stringify(res.data.data.records).replace(/name|id|childrens/gi, function (matched) {\n      return mapObj[matched];\n    }));\n    _this3.treeData = _Array$from(conversion);\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 保存\n * @param {type}\n * @return: addGoodsSub\n */\n\nexport function addGoodsSub(params) {\n  var _this4 = this;\n\n  return postJson(api.addGoods, params).then(function (res) {\n    console.log(res);\n\n    if (res.data.code === 0) {\n      _this4.loading = false;\n\n      _this4.$message.success('保存成功');\n\n      _this4.isVisible = false;\n\n      _this4.$emit('isVisible', _this4.isVisible);\n\n      return false;\n    }\n\n    _this4.loading = false;\n    _this4.isVisible = true;\n\n    _this4.$emit('isVisible', _this4.isVisible);\n\n    _this4.$message.error(res.data.msg);\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 获取header表头字段信息\n * @param {String} catId [属性ID]\n * @return: getTabHeader\n */\n\nexport function getTabHeader(params) {\n  var _this5 = this;\n\n  return get(api.getAttrs, params).then(function (res) {\n    if (res.data.code === 0) {\n      var _this5$columns;\n\n      _this5.addCloumn = []; // console.log(res.data.data)\n\n      _this5.columns = [{\n        title: '产品编码',\n        dataIndex: 'code',\n        key: 'code',\n        width: 106,\n        fixed: 'left',\n        scopedSlots: {\n          customRender: 'code'\n        }\n      }, {\n        title: '上下架',\n        dataIndex: 'saleStatus',\n        key: 'saleStatus',\n        width: 106\n      }, {\n        title: '产品名称',\n        dataIndex: 'name',\n        key: 'name',\n        width: 106\n      }, {\n        title: '规格',\n        dataIndex: 'spec',\n        key: 'spec',\n        width: 106\n      }, {\n        title: '单位',\n        dataIndex: 'nuit',\n        key: 'nuit',\n        width: 106\n      }, {\n        title: '客户编码',\n        dataIndex: 'customCode',\n        key: 'customCode'\n      }, {\n        title: '价格',\n        dataIndex: 'price',\n        key: 'price' // {\n        //   title: '时间',\n        //   key: 'creatTime',\n        //   dataIndex: 'creatTime',\n        //   width: 106\n        // }\n\n      }];\n      res.data.data.forEach(function (item) {\n        if (item.listProp) {\n          _this5.addCloumn.push({\n            title: item.name,\n            dataIndex: item.attrType,\n            key: item.id\n          });\n        }\n      });\n\n      (_this5$columns = _this5.columns).splice.apply(_this5$columns, [7, 0].concat(_toConsumableArray(_this5.addCloumn)));\n\n      _this5.scrollLen.x = _this5.addCloumn.length * 160; // console.log(this.columns)\n    }\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 后台搜索商家商品\n * @param {Object} params 客户ID\n * @return: searchGoods\n */\n\nexport function searchGoods(params) {\n  var _this6 = this;\n\n  return postJson(api.searchGoods, params).then(function (res) {\n    if (res.data.code === 0) {\n      // console.log(res.data.data)\n      _this6.pagination.total = res.data.data.length;\n      console.log(_this6.columns);\n      _this6.tabData = []; // DATA\n\n      res.data.data.forEach(function (data, index) {\n        // console.log(data)\n        // DEFAULT\n        _this6.tabData.push({\n          key: data.sku.id,\n          code: data.sku.code,\n          saleStatus: data.sku.saleStatus === 'SALE' ? '上架' : '下架',\n          name: data.sku.name,\n          spec: data.sku.spec,\n          nuit: data.sku.unit,\n          customCode: data.sku.customCode,\n          price: data.sku.price,\n          creatTime: data.sku.saleAfter\n        }); // RELOAD\n\n\n        _this6.columns.forEach(function (column) {\n          if (!isNaN(column.key)) {\n            // console.log(this.columns[10])\n            var getAttr = data.attrs.filter(function (attr) {\n              return attr.id === column.key;\n            }); // console.log(getAttr[0])\n\n            _this6.tabData[index][getAttr[0].attrType] = getAttr[0].realVal;\n          }\n        }); // console.log(this.tabData)\n\n      });\n    }\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 获取商品分类所有属性和可选项\n * @param {Object}  params [属性ID]\n * @return: addGoods\n */\n\nexport function addGoods(params) {\n  var _this7 = this;\n\n  return get(api.catAllAttrAndOptions + '?catId=' + params).then(function (res) {\n    if (res.data.code === 0) {\n      console.log(res.data.data);\n      _this7.getCatAllAttrAndOptions = res.data.data;\n    }\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 根据客户SKUID查看详情\n * @param {custID} SKUID\n * @return: getCustomerAndMallUser\n */\n\nexport function getGoodsViews(skuId) {\n  var _this8 = this;\n\n  get(api.goodsView, {\n    skuId: skuId\n  }).then(function (res) {\n    if (res.data.code === 0) {\n      console.log(res.data.data);\n      _this8.setGoodsViews = res.data.data;\n    }\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 图片上传\n * @param {String}  params [图片地址]\n * @return: imgUpload\n */\n\nexport function imgUpload(params) {\n  return uploadPost(api.uploadFile, params).then(function (res) {\n    console.log(res);\n  }).catch(function (err) {\n    console.log(err);\n  });\n}\n/**\n * @description: 商品修改\n * @param {Object} [params] 修改表单字段\n * @return: reGoodsUpdate\n */\n\nexport function reGoodsUpdate(params) {\n  var _this9 = this;\n\n  return put(api.goodsUpdate, params).then(function (res) {\n    if (res.data.code === 0) {\n      _this9.loading = false;\n\n      _this9.$message.success('修改成功');\n\n      _this9.isVisible = false;\n\n      _this9.$emit('isVisible', _this9.isVisible);\n\n      return false;\n    }\n\n    _this9.loading = false;\n    _this9.isVisible = true;\n\n    _this9.$emit('isVisible', _this9.isVisible);\n\n    _this9.$message.error(res.data.msg);\n  }).catch(function (err) {\n    console.log(err);\n  });\n}",{"version":3,"sources":["/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/goods/goods.js"],"names":["get","deleted","postJson","uploadPost","put","api","showCustomersPage","currentPage","pageSize","loading","then","res","data","code","recordsList","pagination","total","Number","tabData","records","forEach","item","push","key","id","clientCode","custCode","clientShortName","custShortName","clientAbbreviation","mallUserName","clientName","clientPhone","phone","clientIndustryValue","custIndustryValue","clientLevel","custLevel","clientStatus","custStatus","catch","err","console","log","$message","error","removeCustomer","params","deleteCustomer","slice","length","success","getGoodsTree","goodsTree","mapObj","name","childrens","conversion","JSON","parse","replace","matched","treeData","addGoodsSub","addGoods","isVisible","$emit","msg","getTabHeader","getAttrs","addCloumn","columns","title","dataIndex","width","fixed","scopedSlots","customRender","listProp","attrType","splice","scrollLen","x","searchGoods","index","sku","saleStatus","spec","nuit","unit","customCode","price","creatTime","saleAfter","column","isNaN","getAttr","attrs","filter","attr","realVal","catAllAttrAndOptions","getCatAllAttrAndOptions","getGoodsViews","skuId","goodsView","setGoodsViews","imgUpload","uploadFile","reGoodsUpdate","goodsUpdate"],"mappings":"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","sourcesContent":["import { get, deleted, postJson, uploadPost, put } from '@/api/axios.js'\nimport api from '@/api/index.js'\n\n/**\n * @description: 初始化table数据\n * @param { currentPage } 当前页\n * @param { pageSize }  每页总数\n * @return: showCustomersPage\n */\n\nexport function showCustomersPage(currentPage = 1, pageSize = 5) {\n  this.loading = true\n  get(api.showCustomersPage, { currentPage, pageSize })\n    .then(res => {\n      if (res.data.code === 0) {\n        this.loading = false\n        const recordsList = res.data.data\n        // 设置总页数\n        this.pagination.total = res.data.data === null ? 0 : Number(recordsList.total)\n        // 每次push先清空数组\n        this.tabData = []\n        recordsList.records.forEach((item) => {\n          this.tabData.push({\n            key: item.id,\n            clientCode: item.custCode,\n            clientShortName: item.custShortName,\n            clientAbbreviation: item.mallUserName,\n            clientName: item.mallUserName,\n            clientPhone: item.phone,\n            clientIndustryValue: item.custIndustryValue,\n            clientLevel: item.custLevel,\n            clientStatus: item.custStatus\n          })\n        })\n        return false\n      }\n    })\n    .catch(err => {\n      console.log(err)\n      this.$message.error(`请求超时`)\n      this.loading = false\n    })\n}\n\n/**\n * @description: 客户管理Table列表删除操作\n * @param {params} 客户ID\n * @return: removeCustomer\n */\nexport function removeCustomer() {\n  const params = this.deleteCustomer.slice(0, (this.deleteCustomer.length) - 1)\n  deleted(api.removeCustomer + `?${params}`).then((res) => {\n    if (res.data.code === 0) {\n      this.loading = false\n      this.$message.success('删除成功')\n      return false\n    }\n  }).catch((err) => {\n    console.log(err)\n    this.$message.error('请求错误')\n    this.loading = false\n  })\n}\n\n/**\n * @description: 获取商品类目树形列表\n * @param {type} default\n * @return: getGoodsTree\n */\nexport function getGoodsTree() {\n  return get(api.goodsTree + '1/999').then(res => {\n    const mapObj = {\n      name: 'title',\n      id: 'key',\n      childrens: 'children'\n    }\n    // 全局替换字段名\n    const conversion = JSON.parse(JSON.stringify(res.data.data.records).replace(/name|id|childrens/gi, function (matched) {\n      return mapObj[matched]\n    }))\n    this.treeData = Array.from(conversion)\n  }).catch(err => {\n    console.log(err)\n  })\n}\n/**\n * @description: 保存\n * @param {type}\n * @return: addGoodsSub\n */\nexport function addGoodsSub(params) {\n  return postJson(api.addGoods, params).then((res) => {\n    console.log(res)\n    if (res.data.code === 0) {\n      this.loading = false\n      this.$message.success('保存成功')\n      this.isVisible = false\n      this.$emit('isVisible', this.isVisible)\n      return false\n    }\n    this.loading = false\n    this.isVisible = true\n    this.$emit('isVisible', this.isVisible)\n    this.$message.error(res.data.msg)\n  }).catch(err => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 获取header表头字段信息\n * @param {String} catId [属性ID]\n * @return: getTabHeader\n */\nexport function getTabHeader(params) {\n  return get(api.getAttrs, params).then(res => {\n    if (res.data.code === 0) {\n      this.addCloumn = []\n      // console.log(res.data.data)\n      this.columns = [\n        {\n          title: '产品编码',\n          dataIndex: 'code',\n          key: 'code',\n          width: 106,\n          fixed: 'left',\n          scopedSlots: { customRender: 'code' }\n        },\n        {\n          title: '上下架',\n          dataIndex: 'saleStatus',\n          key: 'saleStatus',\n          width: 106\n        },\n        {\n          title: '产品名称',\n          dataIndex: 'name',\n          key: 'name',\n          width: 106\n        },\n        {\n          title: '规格',\n          dataIndex: 'spec',\n          key: 'spec',\n          width: 106\n        },\n        {\n          title: '单位',\n          dataIndex: 'nuit',\n          key: 'nuit',\n          width: 106\n        },\n        {\n          title: '客户编码',\n          dataIndex: 'customCode',\n          key: 'customCode'\n        },\n        {\n          title: '价格',\n          dataIndex: 'price',\n          key: 'price'\n        }\n        // {\n        //   title: '时间',\n        //   key: 'creatTime',\n        //   dataIndex: 'creatTime',\n        //   width: 106\n        // }\n      ]\n      res.data.data.forEach(item => {\n        if (item.listProp) {\n          this.addCloumn.push({\n            title: item.name,\n            dataIndex: item.attrType,\n            key: item.id\n          })\n        }\n      })\n      this.columns.splice(7, 0, ...this.addCloumn)\n      this.scrollLen.x = this.addCloumn.length * 160\n      // console.log(this.columns)\n    }\n  }).catch(err => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 后台搜索商家商品\n * @param {Object} params 客户ID\n * @return: searchGoods\n */\nexport function searchGoods(params) {\n  return postJson(api.searchGoods, params).then(res => {\n    if (res.data.code === 0) {\n      // console.log(res.data.data)\n      this.pagination.total = res.data.data.length\n      console.log(this.columns)\n      this.tabData = []\n      // DATA\n      res.data.data.forEach((data, index) => {\n        // console.log(data)\n        // DEFAULT\n        this.tabData.push({\n          key: data.sku.id,\n          code: data.sku.code,\n          saleStatus: data.sku.saleStatus === 'SALE' ? '上架' : '下架',\n          name: data.sku.name,\n          spec: data.sku.spec,\n          nuit: data.sku.unit,\n          customCode: data.sku.customCode,\n          price: data.sku.price,\n          creatTime: data.sku.saleAfter\n        })\n        // RELOAD\n        this.columns.forEach(column => {\n          if (!isNaN(column.key)) {\n            // console.log(this.columns[10])\n            const getAttr = data.attrs.filter(attr => {\n              return attr.id === column.key\n            })\n            // console.log(getAttr[0])\n            this.tabData[index][getAttr[0].attrType] = getAttr[0].realVal\n          }\n        })\n        // console.log(this.tabData)\n      })\n    }\n  }).catch(err => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 获取商品分类所有属性和可选项\n * @param {Object}  params [属性ID]\n * @return: addGoods\n */\nexport function addGoods(params) {\n  return get(api.catAllAttrAndOptions + '?catId=' + params).then(res => {\n    if (res.data.code === 0) {\n      console.log(res.data.data)\n      this.getCatAllAttrAndOptions = res.data.data\n    }\n  }).catch(err => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 根据客户SKUID查看详情\n * @param {custID} SKUID\n * @return: getCustomerAndMallUser\n */\nexport function getGoodsViews(skuId) {\n  get(api.goodsView, { skuId: skuId }).then((res) => {\n    if (res.data.code === 0) {\n      console.log(res.data.data)\n      this.setGoodsViews = res.data.data\n    }\n  }).catch((err) => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 图片上传\n * @param {String}  params [图片地址]\n * @return: imgUpload\n */\nexport function imgUpload(params) {\n  return uploadPost(api.uploadFile, params).then(res => {\n    console.log(res)\n  }).catch(err => {\n    console.log(err)\n  })\n}\n\n/**\n * @description: 商品修改\n * @param {Object} [params] 修改表单字段\n * @return: reGoodsUpdate\n */\nexport function reGoodsUpdate(params) {\n  return put(api.goodsUpdate, params).then(res => {\n    if (res.data.code === 0) {\n      this.loading = false\n      this.$message.success('修改成功')\n      this.isVisible = false\n      this.$emit('isVisible', this.isVisible)\n      return false\n    }\n    this.loading = false\n    this.isVisible = true\n    this.$emit('isVisible', this.isVisible)\n    this.$message.error(res.data.msg)\n  }).catch(err => {\n    console.log(err)\n  })\n}\n"]}]}