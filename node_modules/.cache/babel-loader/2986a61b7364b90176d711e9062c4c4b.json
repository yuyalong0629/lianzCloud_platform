{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/cust/child_info/ContactForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/cust/child_info/ContactForm.vue","mtime":1563190507889},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Object$assign from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/core-js/object/assign\";\nimport _objectSpread from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"core-js/modules/es6.function.name\";\nimport _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { columns } from '../basic_lib/column';\nexport default {\n  name: 'ConcatForm',\n  data: function data() {\n    return {\n      data: [],\n      columns: columns,\n      count: 0,\n      cacheData: []\n    };\n  },\n  props: {\n    mallUsersInfo: {\n      type: Array,\n      default: []\n    },\n    childDisabled: {\n      type: Boolean,\n      default: false,\n      required: false\n    }\n  },\n  methods: {\n    handleAdd: function handleAdd() {\n      var count = this.count,\n          data = this.data;\n      var newData = {\n        key: count,\n        name: '',\n        sex: '0',\n        phone: '',\n        companyPosition: '',\n        email: '',\n        contact: '',\n        deleted: false,\n        editable: true\n      };\n      this.data = [].concat(_toConsumableArray(data), [newData]);\n      this.count = count + 1; // // 保存初始化Obj\n      // this.cacheData = this.data.map(item => ({ ...item }))\n    },\n    handleChangeSelect: function handleChangeSelect(value, key, column) {\n      var newData = _toConsumableArray(this.data);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        target[column] = value;\n        this.data = newData;\n        this.$emit('userNatureDtos', this.data);\n      }\n\n      this.data = _toConsumableArray(newData);\n      console.log(this.data);\n    },\n    onDelete: function onDelete(key) {\n      var dataSource = _toConsumableArray(this.data);\n\n      this.data = dataSource.filter(function (item) {\n        return item.key !== key;\n      });\n      this.$emit('userNatureDtos', this.data);\n    },\n    handleChange: function handleChange(value, key, column) {\n      var newData = _toConsumableArray(this.data);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        target[column] = value;\n        this.data = newData;\n      }\n    },\n    edit: function edit(key) {\n      var newData = _toConsumableArray(this.data);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target) {\n        target.editable = true;\n        this.data = newData;\n      }\n    },\n    save: function save(key) {\n      var newData = _toConsumableArray(this.data);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target && target.name && target.phone) {\n        target.editable = false;\n        this.data = newData;\n        this.cacheData = newData.map(function (item) {\n          return _objectSpread({}, item);\n        });\n        this.$emit('userNatureDtos', this.data);\n      } else {\n        this.$message.error('请先完善信息');\n      }\n    },\n    cancel: function cancel(key) {\n      var newData = _toConsumableArray(this.data);\n\n      var target = newData.filter(function (item) {\n        return key === item.key;\n      })[0];\n      var targetData = this.cacheData.filter(function (item) {\n        return key === item.key;\n      })[0];\n\n      if (target && target.name && target.phone && targetData) {\n        _Object$assign(target, this.cacheData.filter(function (item) {\n          return key === item.key;\n        })[0]);\n\n        target.editable = false;\n        this.data = newData;\n        console.log(this.data);\n      } else {\n        this.data = newData.filter(function (item) {\n          return item.key !== key;\n        });\n        console.log(this.data);\n      }\n    }\n  },\n  watch: {\n    mallUsersInfo: {\n      handler: function handler(val) {\n        var _this = this;\n\n        if (val.length) {\n          var count = this.count,\n              data = this.data;\n          val.forEach(function (item, index) {\n            _this.data[index] = {\n              key: index,\n              name: item.name,\n              sex: item.sex === 'MALE' ? '0' : '1',\n              phone: item.phone,\n              companyPosition: item.companyPosition || '无',\n              email: item.email || '无',\n              contact: item.contact || '无',\n              custId: item.custId,\n              id: item.id,\n              deleted: false,\n              editable: false\n            };\n            _this.count = index + 1;\n          }); // 保存初始化Obj\n\n          this.cacheData = this.data.map(function (item) {\n            return _objectSpread({}, item);\n          });\n          console.log(this.cacheData);\n          this.$emit('userNatureDtos', this.data);\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  }\n};",{"version":3,"sources":["ContactForm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"concat-form\">\n    <a-table :columns=\"columns\" :dataSource=\"data\" :pagination=\"false\">\n      <template\n        v-for=\"col in ['name', 'sex', 'phone', 'companyPosition', 'email', 'contact']\"\n        :slot=\"col\"\n        slot-scope=\"text, record, index\"\n      >\n        <div :key=\"col\">\n          <a-input\n            v-if=\"record.editable && col !== 'sex'\"\n            style=\"margin: -5px 0\"\n            :value=\"text\"\n            @change=\"e => handleChange(e.target.value, record.key, col)\"\n          />\n          <a-select\n            v-if=\"record.editable && col === 'sex'\"\n            :value=\"record.sex\"\n            style=\"width: 80px\"\n            @change=\"(value) => handleChangeSelect(value, record.key, col)\"\n          >\n            <a-select-option value=\"0\">男</a-select-option>\n            <a-select-option value=\"1\">女</a-select-option>\n          </a-select>\n          <template>\n            <span v-if=\"!record.editable && col !== 'sex'\">{{ text }}</span>\n            <span v-if=\"!record.editable && col === 'sex'\">{{ text === '0' ? '男' : '女' }}</span>\n          </template>\n        </div>\n      </template>\n      <template v-if=\"childDisabled\" slot=\"operation\" slot-scope=\"text, record, index\">\n        <div class=\"editable-row-operations\">\n          <span v-if=\"record.editable\">\n            <a @click=\"() => save(record.key)\">保存</a>\n            <a @click=\"() => cancel(record.key)\">取消</a>\n          </span>\n          <span v-else>\n            <a @click=\"() => edit(record.key)\">编辑</a>\n            <a-popconfirm title=\"确定删除吗?\" @confirm=\"() => onDelete(record.key)\">\n              <a>删除</a>\n            </a-popconfirm>\n          </span>\n        </div>\n      </template>\n    </a-table>\n    <a-button\n      style=\"width: 100%; margin-top: 16px; margin-bottom: 8px\"\n      v-if=\"childDisabled\"\n      type=\"dashed\"\n      icon=\"plus\"\n      @click.stop=\"handleAdd\"\n    >添加联系人</a-button>\n  </div>\n</template>\n<script>\nimport { columns } from '../basic_lib/column'\n\nexport default {\n  name: 'ConcatForm',\n  data() {\n    return {\n      data: [],\n      columns,\n      count: 0,\n      cacheData: []\n    }\n  },\n  props: {\n    mallUsersInfo: {\n      type: Array,\n      default: []\n    },\n    childDisabled: {\n      type: Boolean,\n      default: false,\n      required: false\n    }\n  },\n  methods: {\n    handleAdd() {\n      const { count, data } = this\n      const newData = {\n        key: count,\n        name: '',\n        sex: '0',\n        phone: '',\n        companyPosition: '',\n        email: '',\n        contact: '',\n        deleted: false,\n        editable: true\n      }\n      this.data = [...data, newData]\n      this.count = count + 1\n      // // 保存初始化Obj\n      // this.cacheData = this.data.map(item => ({ ...item }))\n    },\n    handleChangeSelect(value, key, column) {\n      const newData = [...this.data]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target[column] = value\n        this.data = newData\n        this.$emit('userNatureDtos', this.data)\n      }\n      this.data = [...newData]\n      console.log(this.data)\n    },\n    onDelete(key) {\n      const dataSource = [...this.data]\n      this.data = dataSource.filter(item => item.key !== key)\n      this.$emit('userNatureDtos', this.data)\n    },\n    handleChange(value, key, column) {\n      const newData = [...this.data]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target[column] = value\n        this.data = newData\n      }\n    },\n    edit(key) {\n      const newData = [...this.data]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target) {\n        target.editable = true\n        this.data = newData\n      }\n    },\n    save(key) {\n      const newData = [...this.data]\n      const target = newData.filter(item => key === item.key)[0]\n      if (target && target.name && target.phone) {\n        target.editable = false\n        this.data = newData\n        this.cacheData = newData.map(item => ({ ...item }))\n        this.$emit('userNatureDtos', this.data)\n      } else {\n        this.$message.error('请先完善信息')\n      }\n    },\n    cancel(key) {\n      const newData = [...this.data]\n      const target = newData.filter(item => key === item.key)[0]\n      const targetData = this.cacheData.filter(item => key === item.key)[0]\n      if (target && target.name && target.phone && targetData) {\n        Object.assign(\n          target,\n          this.cacheData.filter(item => key === item.key)[0]\n        )\n        target.editable = false\n        this.data = newData\n        console.log(this.data)\n      } else {\n        this.data = newData.filter(item => item.key !== key)\n        console.log(this.data)\n      }\n    }\n  },\n  watch: {\n    mallUsersInfo: {\n      handler(val) {\n        if (val.length) {\n          const { count, data } = this\n          val.forEach((item, index) => {\n            this.data[index] = {\n              key: index,\n              name: item.name,\n              sex: item.sex === 'MALE' ? '0' : '1',\n              phone: item.phone,\n              companyPosition: item.companyPosition || '无',\n              email: item.email || '无',\n              contact: item.contact || '无',\n              custId: item.custId,\n              id: item.id,\n              deleted: false,\n              editable: false\n            }\n            this.count = index + 1\n          })\n          // 保存初始化Obj\n          this.cacheData = this.data.map(item => ({\n            ...item\n          }))\n          console.log(this.cacheData)\n          this.$emit('userNatureDtos', this.data)\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.editable-row-operations a {\n  margin-right: 8px;\n}\n</style>\n"],"sourceRoot":"src/views/cust/child_info"}]}