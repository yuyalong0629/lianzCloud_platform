{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/Customer.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/customer/Customer.vue","mtime":1557923502281},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.object.to-string\";\nimport _parseInt from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Animation from '@/assets/common/Animation';\nimport { showCustomersPage, removeCustomer, getCustomerAndMallUser, getCustIndustry, custNamefetch, custCodefetch, custManagerfetch } from './getPage.js';\nimport { columnCust } from './columns.js';\nimport CustomerInfo from './CustomerInfo';\nexport default {\n  name: 'Customer',\n  data: function data() {\n    return {\n      // 高级搜索 展开/关闭\n      advanced: false,\n      // table\n      tabData: [],\n      columnCust: columnCust,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      loading: false,\n      selectedRowKeys: [],\n      // Check here to configure the default column,\n      deleteCustomer: '',\n      visible: false,\n      setCustomerAndMallUser: {},\n      isEdit: false,\n      isShow: true,\n      isPermission: true,\n      // 权限\n      // 客户搜索\n      custSearchInfo: {\n        custSearchLevel: '' // 客户等级\n\n      },\n      custIndustryArr: [],\n      defaultCustIndustry: '',\n      // 客户行业\n      defaultStatus: '',\n      // 客户状态\n      // 客户名称\n      custNameData: [],\n      custNameValue: {},\n      // 客户编码\n      custCodeData: [],\n      custCodeValue: {},\n      // 客户经理\n      custManagerData: [],\n      custManagerValue: {}\n    };\n  },\n  created: function created() {\n    getCustIndustry.call(this, 'INDUSTRY');\n  },\n  mounted: function mounted() {\n    // 初始化客户信息\n    showCustomersPage.call(this, {});\n  },\n  methods: {\n    // 模糊搜索function\n    custSearch: function custSearch() {\n      showCustomersPage.call(this, {\n        custDtoCode: this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label,\n        // 客户编码\n        custDtoIndustry: this.defaultCustIndustry === 'all' || this.defaultCustIndustry === '' ? '' : this.defaultCustIndustry,\n        // 客户行业\n        custDtoLevel: this.custSearchInfo.custSearchLevel === 'all' || this.custSearchInfo.custSearchLevel === '' ? 0 : _parseInt(this.custSearchInfo.custSearchLevel),\n        // 客户等级\n        custDtoManager: this.custManagerValue.label === '全部' ? '' : this.custManagerValue.label,\n        // 客户经理\n        custDtoName: this.custNameValue.label === '全部' ? '' : this.custNameValue.label,\n        // 客户名称\n        custDtoStatus: this.defaultStatus === 'all' || this.defaultStatus === '' ? 0 : _parseInt(this.defaultStatus) // 客户状态\n\n      });\n    },\n    // 客户名称搜索\n    handleCustNameSearch: function handleCustNameSearch(value) {\n      var _this = this;\n\n      custNamefetch.call(this, value, function (data) {\n        return _this.custNameData = data;\n      });\n    },\n    handleCustNameChange: function handleCustNameChange(value) {\n      // this.custNameValue = Object.assign({}, value)\n      this.custNameValue = {\n        key: value.key.toString(),\n        label: value.label\n      };\n      this.custSearch();\n    },\n    // 客户编码搜索\n    handleCustCodeSearch: function handleCustCodeSearch(value) {\n      var _this2 = this;\n\n      custCodefetch.call(this, value, function (data) {\n        return _this2.custCodeData = data;\n      });\n    },\n    handleCustCodeChange: function handleCustCodeChange(value) {\n      this.custCodeValue = {\n        key: value.key.toString(),\n        label: value.label // 模糊查询分页显示\n\n      };\n      this.custSearch();\n    },\n    // 客户经理搜索\n    handleCustManagerSearch: function handleCustManagerSearch(value) {\n      var _this3 = this;\n\n      custManagerfetch.call(this, value, function (data) {\n        return _this3.custManagerData = data;\n      });\n    },\n    handleCustManagerChange: function handleCustManagerChange(value) {\n      console.log(value);\n      this.custManagerValue = {\n        key: value.key.toString(),\n        label: value.label // 模糊查询分页显示\n\n      };\n      this.custSearch();\n    },\n    // 重置\n    custRest: function custRest() {\n      this.custNameValue = {};\n      this.custCodeValue = {};\n      this.custManagerValue = {};\n      this.custSearchInfo.custSearchLevel = '';\n      this.defaultStatus = '';\n      this.defaultCustIndustry = ''; // 重置列表\n\n      showCustomersPage.call(this, {});\n    },\n    // 地域选择\n    onChangeArea: function onChangeArea(value) {\n      console.log(value);\n    },\n    // 客户等级\n    onleChangeRank: function onleChangeRank(value) {\n      console.log(value);\n      this.custSearchInfo.custSearchLevel = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // 行业\n    onleChangeindustry: function onleChangeindustry(value) {\n      console.log(value);\n      this.defaultCustIndustry = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    toggleAdvanced: function toggleAdvanced() {\n      this.advanced = !this.advanced;\n    },\n    // 客户状态\n    onleChangeStatus: function onleChangeStatus(value) {\n      console.log(value);\n      this.defaultStatus = value; // 模糊查询分页显示\n\n      this.custSearch();\n    },\n    // table 选择操作\n    onChangeTab: function onChangeTab(selectedRowKeys, selectedRows) {\n      var _this4 = this;\n\n      console.log(selectedRowKeys);\n      console.log(selectedRows);\n      this.selectedRowKeys = selectedRowKeys; // 选中删除供应商数\n\n      this.deleteCustomer = '';\n      selectedRowKeys.forEach(function (item, index) {\n        console.log(item);\n        _this4.deleteCustomer += \"customerIds=\".concat(item, \"&\");\n      });\n      console.log(this.deleteCustomer);\n    },\n    // 删除tab列表项\n    onDeleteCustomer: function onDeleteCustomer() {\n      var that = this;\n\n      if (that.selectedRowKeys.length === 0) {\n        that.$message.error('请先选择要删除的项');\n        return false;\n      }\n\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: function onOk() {\n          that.loading = true;\n          removeCustomer.call(that);\n          setTimeout(function () {\n            showCustomersPage.call(that, {});\n          }, 200);\n        },\n        onCancel: function onCancel() {\n          console.log('Cancel');\n        }\n      });\n    },\n    // 分页管理\n    onChangePage: function onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标');\n      console.log(pagination.pageSize);\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      }); // 切换分页先清空选中状态\n\n      this.selectedRowKeys = [];\n    },\n    // 新增客户信息\n    addCustomerInfo: function addCustomerInfo() {\n      this.visible = true;\n      this.isEdit = false;\n    },\n    // 取消客户信息\n    onCustomerInfo: function onCustomerInfo() {\n      this.visible = false;\n    },\n    // 客户信息详情\n    onChangeCode: function onChangeCode(record) {\n      if (this.isPermission) {\n        this.visible = true; // 编辑按钮显示\n\n        this.isEdit = true;\n        getCustomerAndMallUser.call(this, record.key);\n      }\n    },\n    // 客户状态\n    onChangeStatus: function onChangeStatus(record) {\n      console.log(record);\n    },\n    // $emit改变isvisible\n    isVisible: function isVisible(_isVisible) {\n      this.visible = _isVisible;\n    },\n    controlPermission: function controlPermission(val) {\n      var _this5 = this;\n\n      val.forEach(function (item) {\n        // console.log(item.btnOptType)\n        switch (item.btnOptType) {\n          case 'LIST':\n            // 客户搜索\n            _this5.isPermission = true;\n            break;\n\n          case 'IMPORT':\n            // 导入\n            _this5.isPermission = true;\n            break;\n\n          case 'EXPORT':\n            // 导出\n            _this5.isPermission = true;\n            break;\n\n          case 'DELETES':\n            // 删除\n            _this5.isPermission = true;\n            break;\n\n          case 'ADD':\n            // 新建\n            _this5.isPermission = true;\n            break;\n\n          case 'DETAIL':\n            // 详情\n            _this5.isPermission = true;\n            break;\n\n          default:\n            _this5.isPermission = false;\n        }\n      });\n    },\n    // 分页\n    onShowSizeChange: function onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize);\n    }\n  },\n  computed: {\n    rowSelection: function rowSelection() {\n      var selectedRowKeys = this.selectedRowKeys;\n      return {\n        selectedRowKeys: selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      };\n    },\n    getNavPermission: function getNavPermission() {\n      return this.$store.getters.getNavPermission;\n    }\n  },\n  watch: {\n    getNavPermission: function getNavPermission(val) {\n      // console.log(val)\n      this.controlPermission(val);\n    }\n  },\n  components: {\n    Animation: Animation,\n    CustomerInfo: CustomerInfo\n  }\n};",{"version":3,"sources":["Customer.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"client\">\n    <!-- 头部选择区 -->\n    <div class=\"client-add\">\n      <a-button type=\"primary\" v-show=\"isPermission\" @click=\"addCustomerInfo\">\n        <a-icon type=\"plus\"/>新建\n      </a-button>\n      <!-- 弹出层 -->\n      <a-drawer\n        destroyOnClose\n        placement=\"right\"\n        :closable=\"false\"\n        :width=\"1080\"\n        @close=\"onCustomerInfo\"\n        :visible=\"visible\"\n        :wrapStyle=\"{height: 'calc(100% - 108px)',overflow: 'auto',paddingBottom: '108px'}\"\n      >\n        <CustomerInfo\n          @isVisible=\"isVisible\"\n          :isEdit=\"isEdit\"\n          :setCustomerAndMallUser=\"setCustomerAndMallUser\"\n        ></CustomerInfo>\n      </a-drawer>\n      <span v-show=\"isPermission\" class=\"delete-btn\" @click=\"onDeleteCustomer\">\n        <a-icon class=\"delete-icon\" type=\"delete\"/>\n        <span>删除</span>\n      </span>\n      <a-dropdown>\n        <span>\n          <a-icon class=\"client-derive\" type=\"check-circle\"/>\n          <span>更多</span>\n        </span>\n        <a-menu slot=\"overlay\">\n          <a-menu-item key=\"0\">\n            <span v-show=\"isPermission\">导入</span>\n          </a-menu-item>\n          <a-menu-item key=\"1\">\n            <span v-show=\"isPermission\">导出</span>\n          </a-menu-item>\n        </a-menu>\n      </a-dropdown>\n    </div>\n    <!-- 客户选择 -->\n    <div class=\"client-select\" v-show=\"isPermission\">\n      <a-form layout=\"inline\">\n        <a-row>\n          <a-col :span=\"20\">\n            <a-row>\n              <a-col :span=\"24\" style=\"margin: 8px 0;\">\n                <a-form-item label=\"客户名称\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    showSearch\n                    labelInValue\n                    :value=\"custNameValue\"\n                    placeholder=\"请输入客户名称\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustNameSearch\"\n                    @change=\"handleCustNameChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option value>全部</a-select-option>\n                    <a-select-option v-for=\"(d, i) in custNameData\" :key=\"i\">{{ d }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户经理\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    showSearch\n                    labelInValue\n                    :value=\"custManagerValue\"\n                    placeholder=\"请输入客户经理\"\n                    style=\"width: 200px\"\n                    :defaultActiveFirstOption=\"false\"\n                    :showArrow=\"false\"\n                    :filterOption=\"false\"\n                    @search=\"handleCustManagerSearch\"\n                    @change=\"handleCustManagerChange\"\n                    :notFoundContent=\"null\"\n                  >\n                    <a-select-option class=\"defaultSelect\" value>全部</a-select-option>\n                    <a-select-option v-for=\"(d, i) in custManagerData\" :key=\"d.text\">{{ d.value }}</a-select-option>\n                  </a-select>\n                </a-form-item>\n                <a-form-item label=\"客户等级\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                  <a-select\n                    placeholder=\"客户等级\"\n                    v-model=\"custSearchInfo.custSearchLevel\"\n                    @change=\"onleChangeRank\"\n                    class=\"inputWidth\"\n                  >\n                    <a-select-option value=\"all\">全部</a-select-option>\n                    <a-select-option value=\"0\">V1</a-select-option>\n                    <a-select-option value=\"1\">V2</a-select-option>\n                    <a-select-option value=\"2\">V3</a-select-option>\n                    <a-select-option value=\"3\">V4</a-select-option>\n                    <a-select-option value=\"4\">V5</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n            </a-row>\n            <Animation name=\"fadeIn\">\n              <a-row v-if=\"advanced\">\n                <a-col :span=\"24\">\n                  <a-form-item label=\"客户编码\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      showSearch\n                      labelInValue\n                      :value=\"custCodeValue\"\n                      placeholder\n                      style=\"width: 200px\"\n                      :defaultActiveFirstOption=\"false\"\n                      :showArrow=\"false\"\n                      :filterOption=\"false\"\n                      @search=\"handleCustCodeSearch\"\n                      @change=\"handleCustCodeChange\"\n                      :notFoundContent=\"null\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option v-for=\"(d, i) in custCodeData\" :key=\"i\">{{ d }}</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                  <a-form-item label=\"行业\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      :value=\"defaultCustIndustry\"\n                      @change=\"onleChangeindustry\"\n                      class=\"inputWidth\"\n                      placeholder=\"行业\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option\n                        v-for=\"item of custIndustryArr\"\n                        :key=\"item.id\"\n                        :value=\"item.id\"\n                      >{{ item.displayValue }}</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                  <a-form-item label=\"客户状态\" :label-col=\"{ span: 8 }\" :wrapper-col=\"{ span: 14 }\">\n                    <a-select\n                      :value=\"defaultStatus\"\n                      placeholder=\"客户状态\"\n                      class=\"inputWidth\"\n                      @change=\"onleChangeStatus\"\n                    >\n                      <a-select-option value=\"all\">全部</a-select-option>\n                      <a-select-option value=\"0\">已购买</a-select-option>\n                      <a-select-option value=\"1\">未购买</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                </a-col>\n              </a-row>\n            </Animation>\n          </a-col>\n          <a-col :span=\"4\">\n            <a-form-item>\n              <span class=\"client-select-reset\" @click=\"custRest\">重置</span>\n              <span @click=\"toggleAdvanced\" style=\"cursor: pointer;\">\n                {{ advanced ? '收起' : '展开' }}\n                <a-icon :type=\"advanced ? 'caret-up' : 'caret-down'\"/>\n              </span>\n            </a-form-item>\n          </a-col>\n        </a-row>\n      </a-form>\n    </div>\n    <!-- table -->\n    <div class=\"client-table\">\n      <a-table\n        :columns=\"columnCust\"\n        @change=\"onChangePage\"\n        :dataSource=\"tabData\"\n        :pagination=\"pagination\"\n        :rowSelection=\"rowSelection\"\n        :loading=\"loading\"\n        @showSizeChange=\"onShowSizeChange\"\n      >\n        <template slot=\"clientCode\" slot-scope=\"text, record\">\n          <a @click=\"onChangeCode(record)\" href=\"javascript:;\">{{text}}</a>\n        </template>\n        <template slot=\"clientStatus\" slot-scope=\"text, record\">\n          <a\n            @click=\"onChangeStatus(record)\"\n            href=\"javascript:;\"\n            class=\"client-status\"\n            :class=\"[`${text}` === '0' ? 'statusOk' : 'statusNo']\"\n            :title=\"[`${text}` === '0' ? '已购买' : '未购买']\"\n          ></a>\n        </template>\n      </a-table>\n    </div>\n  </div>\n</template>\n<script>\nimport Animation from '@/assets/common/Animation'\nimport {\n  showCustomersPage,\n  removeCustomer,\n  getCustomerAndMallUser,\n  getCustIndustry,\n  custNamefetch,\n  custCodefetch,\n  custManagerfetch\n} from './getPage.js'\nimport { columnCust } from './columns.js'\nimport CustomerInfo from './CustomerInfo'\n\nexport default {\n  name: 'Customer',\n  data() {\n    return {\n      // 高级搜索 展开/关闭\n      advanced: false,\n      // table\n      tabData: [],\n      columnCust,\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      loading: false,\n      selectedRowKeys: [], // Check here to configure the default column,\n      deleteCustomer: '',\n      visible: false,\n      setCustomerAndMallUser: {},\n      isEdit: false,\n      isShow: true,\n      isPermission: true, // 权限\n      // 客户搜索\n      custSearchInfo: {\n        custSearchLevel: '' // 客户等级\n      },\n      custIndustryArr: [],\n      defaultCustIndustry: '', // 客户行业\n      defaultStatus: '', // 客户状态\n      // 客户名称\n      custNameData: [],\n      custNameValue: {},\n      // 客户编码\n      custCodeData: [],\n      custCodeValue: {},\n      // 客户经理\n      custManagerData: [],\n      custManagerValue: {}\n    }\n  },\n  created() {\n    getCustIndustry.call(this, 'INDUSTRY')\n  },\n  mounted() {\n    // 初始化客户信息\n    showCustomersPage.call(this, {})\n  },\n  methods: {\n    // 模糊搜索function\n    custSearch() {\n      showCustomersPage.call(this, {\n        custDtoCode:\n          this.custCodeValue.label === '全部' ? '' : this.custCodeValue.label, // 客户编码\n        custDtoIndustry:\n          this.defaultCustIndustry === 'all' || this.defaultCustIndustry === ''\n            ? ''\n            : this.defaultCustIndustry, // 客户行业\n        custDtoLevel:\n          this.custSearchInfo.custSearchLevel === 'all' ||\n          this.custSearchInfo.custSearchLevel === ''\n            ? 0\n            : parseInt(this.custSearchInfo.custSearchLevel), // 客户等级\n        custDtoManager:\n          this.custManagerValue.label === '全部'\n            ? ''\n            : this.custManagerValue.label, // 客户经理\n        custDtoName:\n          this.custNameValue.label === '全部' ? '' : this.custNameValue.label, // 客户名称\n        custDtoStatus:\n          this.defaultStatus === 'all' || this.defaultStatus === ''\n            ? 0\n            : parseInt(this.defaultStatus) // 客户状态\n      })\n    },\n    // 客户名称搜索\n    handleCustNameSearch(value) {\n      custNamefetch.call(this, value, data => (this.custNameData = data))\n    },\n    handleCustNameChange(value) {\n      // this.custNameValue = Object.assign({}, value)\n      this.custNameValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      this.custSearch()\n    },\n    // 客户编码搜索\n    handleCustCodeSearch(value) {\n      custCodefetch.call(this, value, data => (this.custCodeData = data))\n    },\n    handleCustCodeChange(value) {\n      this.custCodeValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 客户经理搜索\n    handleCustManagerSearch(value) {\n      custManagerfetch.call(this, value, data => (this.custManagerData = data))\n    },\n    handleCustManagerChange(value) {\n      console.log(value)\n      this.custManagerValue = {\n        key: value.key.toString(),\n        label: value.label\n      }\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 重置\n    custRest() {\n      this.custNameValue = {}\n      this.custCodeValue = {}\n      this.custManagerValue = {}\n      this.custSearchInfo.custSearchLevel = ''\n      this.defaultStatus = ''\n      this.defaultCustIndustry = ''\n      // 重置列表\n      showCustomersPage.call(this, {})\n    },\n    // 地域选择\n    onChangeArea(value) {\n      console.log(value)\n    },\n    // 客户等级\n    onleChangeRank(value) {\n      console.log(value)\n      this.custSearchInfo.custSearchLevel = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // 行业\n    onleChangeindustry(value) {\n      console.log(value)\n      this.defaultCustIndustry = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    // 客户状态\n    onleChangeStatus(value) {\n      console.log(value)\n      this.defaultStatus = value\n      // 模糊查询分页显示\n      this.custSearch()\n    },\n    // table 选择操作\n    onChangeTab(selectedRowKeys, selectedRows) {\n      console.log(selectedRowKeys)\n      console.log(selectedRows)\n      this.selectedRowKeys = selectedRowKeys\n      // 选中删除供应商数\n      this.deleteCustomer = ''\n      selectedRowKeys.forEach((item, index) => {\n        console.log(item)\n        this.deleteCustomer += `customerIds=${item}&`\n      })\n      console.log(this.deleteCustomer)\n    },\n    // 删除tab列表项\n    onDeleteCustomer() {\n      const that = this\n      if (that.selectedRowKeys.length === 0) {\n        that.$message.error('请先选择要删除的项')\n        return false\n      }\n      this.$confirm({\n        title: '删除',\n        content: '您确认要删除？',\n        okText: '删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk() {\n          that.loading = true\n          removeCustomer.call(that)\n          setTimeout(() => {\n            showCustomersPage.call(that, {})\n          }, 200)\n        },\n        onCancel() {\n          console.log('Cancel')\n        }\n      })\n    },\n    // 分页管理\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      showCustomersPage.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 新增客户信息\n    addCustomerInfo() {\n      this.visible = true\n      this.isEdit = false\n    },\n    // 取消客户信息\n    onCustomerInfo() {\n      this.visible = false\n    },\n    // 客户信息详情\n    onChangeCode(record) {\n      if (this.isPermission) {\n        this.visible = true\n        // 编辑按钮显示\n        this.isEdit = true\n        getCustomerAndMallUser.call(this, record.key)\n      }\n    },\n    // 客户状态\n    onChangeStatus(record) {\n      console.log(record)\n    },\n    // $emit改变isvisible\n    isVisible(isVisible) {\n      this.visible = isVisible\n    },\n    controlPermission(val) {\n      val.forEach(item => {\n        // console.log(item.btnOptType)\n        switch (item.btnOptType) {\n          case 'LIST':\n            // 客户搜索\n            this.isPermission = true\n            break\n          case 'IMPORT':\n            // 导入\n            this.isPermission = true\n            break\n          case 'EXPORT':\n            // 导出\n            this.isPermission = true\n            break\n          case 'DELETES':\n            // 删除\n            this.isPermission = true\n            break\n          case 'ADD':\n            // 新建\n            this.isPermission = true\n            break\n          case 'DETAIL':\n            // 详情\n            this.isPermission = true\n            break\n          default:\n            this.isPermission = false\n        }\n      })\n    },\n    // 分页\n    onShowSizeChange(current, pageSize) {\n      console.log(current, pageSize)\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getNavPermission() {\n      return this.$store.getters.getNavPermission\n    }\n  },\n  watch: {\n    getNavPermission(val) {\n      // console.log(val)\n      this.controlPermission(val)\n    }\n  },\n  components: {\n    Animation,\n    CustomerInfo\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.client {\n  .client-add {\n    .delete-btn {\n      margin: 0 20px;\n      cursor: pointer;\n      .delete-icon {\n        color: #f00;\n        margin-right: 3px;\n      }\n    }\n    .client-derive {\n      color: #6bc67b;\n      margin-right: 5px;\n    }\n  }\n  .client-select {\n    margin: 20px 0;\n    .client-select-reset {\n      margin: 0 8px;\n      cursor: pointer;\n    }\n    /deep/ .ant-form-item-label {\n      .labelWidth();\n    }\n  }\n  .inputWidth {\n    .inputWidth();\n  }\n  .client-table {\n    .client-status {\n      width: 12px;\n      height: 12px;\n      border-radius: 50%;\n      display: inline-block;\n    }\n    .statusOk {\n      background: #6bc67b;\n    }\n    .statusNo {\n      background: #d8d8d8;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/customer"}]}