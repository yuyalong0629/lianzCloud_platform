{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/router/router.js","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/router/router.js","mtime":1564625928906},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport Vue from 'vue';\nimport Router from 'vue-router';\nimport NProgress from 'nprogress';\nimport 'nprogress/nprogress.css';\nimport { routerMap } from './router.config.js';\nVue.use(Router);\nvar router = new Router({\n  // mode: 'hash', // 默认是 history 可以改为 hash\n  base: process.env.BASE_URL,\n  scrollBehavior: function scrollBehavior() {\n    return {\n      y: 0\n    };\n  },\n  routes: routerMap\n}); // 全局路由守卫\n\nvar userAgent = navigator.userAgent;\nvar isIE = userAgent.indexOf('Trident') > -1;\nrouter.beforeEach(function (to, from, next) {\n  if (to.path === '/exception/browser') {\n    next();\n  } else {\n    if (isIE) {\n      next({\n        path: '/exception/browser'\n      });\n    } else {\n      if (to.path === '/user/login' || to.path === '/user/register' || to.path === '/user/retrieve') {\n        next();\n      } else {\n        if (localStorage.getItem('ACCESS_TOKEN')) {\n          NProgress.start();\n          next(Error);\n        } else {\n          next({\n            path: '/user/login'\n          });\n          localStorage.removeItem('ACCESS_TOKEN');\n        }\n      }\n    }\n  }\n}); // 错误捕获\n\nrouter.onError(function (error) {\n  console.log(error);\n  var targetPath = router.history.pending.fullPath;\n\n  if (error) {\n    console.log(1);\n    window.location.reload(true);\n    router.replace(targetPath);\n  }\n});\nrouter.afterEach(function (from) {\n  NProgress.done();\n});\nexport default router;",{"version":3,"sources":["/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/router/router.js"],"names":["Vue","Router","NProgress","routerMap","use","router","base","process","env","BASE_URL","scrollBehavior","y","routes","userAgent","navigator","isIE","indexOf","beforeEach","to","from","next","path","localStorage","getItem","start","Error","removeItem","onError","error","console","log","targetPath","history","pending","fullPath","window","location","reload","replace","afterEach","done"],"mappings":";AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,MAAP,MAAmB,YAAnB;AACA,OAAOC,SAAP,MAAsB,WAAtB;AACA,OAAO,yBAAP;AACA,SAASC,SAAT,QAA0B,oBAA1B;AAEAH,GAAG,CAACI,GAAJ,CAAQH,MAAR;AAEA,IAAMI,MAAM,GAAG,IAAIJ,MAAJ,CAAW;AACxB;AACAK,EAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC,QAFM;AAGxBC,EAAAA,cAAc,EAAE;AAAA,WAAO;AAAEC,MAAAA,CAAC,EAAE;AAAL,KAAP;AAAA,GAHQ;AAIxBC,EAAAA,MAAM,EAAET;AAJgB,CAAX,CAAf,C,CAOA;;AACA,IAAMU,SAAS,GAAGC,SAAS,CAACD,SAA5B;AACA,IAAME,IAAI,GAAGF,SAAS,CAACG,OAAV,CAAkB,SAAlB,IAA+B,CAAC,CAA7C;AAEAX,MAAM,CAACY,UAAP,CAAkB,UAACC,EAAD,EAAKC,IAAL,EAAWC,IAAX,EAAoB;AACpC,MAAIF,EAAE,CAACG,IAAH,KAAY,oBAAhB,EAAsC;AACpCD,IAAAA,IAAI;AACL,GAFD,MAEO;AACL,QAAIL,IAAJ,EAAU;AACRK,MAAAA,IAAI,CAAC;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAAD,CAAJ;AACD,KAFD,MAEO;AACL,UAAIH,EAAE,CAACG,IAAH,KAAY,aAAZ,IAA6BH,EAAE,CAACG,IAAH,KAAY,gBAAzC,IAA6DH,EAAE,CAACG,IAAH,KAAY,gBAA7E,EAA+F;AAC7FD,QAAAA,IAAI;AACL,OAFD,MAEO;AACL,YAAIE,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAJ,EAA0C;AACxCrB,UAAAA,SAAS,CAACsB,KAAV;AACAJ,UAAAA,IAAI,CAACK,KAAD,CAAJ;AACD,SAHD,MAGO;AACLL,UAAAA,IAAI,CAAC;AAAEC,YAAAA,IAAI,EAAE;AAAR,WAAD,CAAJ;AACAC,UAAAA,YAAY,CAACI,UAAb,CAAwB,cAAxB;AACD;AACF;AACF;AACF;AACF,CApBD,E,CAsBA;;AACArB,MAAM,CAACsB,OAAP,CAAe,UAACC,KAAD,EAAW;AACxBC,EAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,MAAMG,UAAU,GAAG1B,MAAM,CAAC2B,OAAP,CAAeC,OAAf,CAAuBC,QAA1C;;AACA,MAAIN,KAAJ,EAAW;AACTC,IAAAA,OAAO,CAACC,GAAR,CAAY,CAAZ;AACAK,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,IAAvB;AACAhC,IAAAA,MAAM,CAACiC,OAAP,CAAeP,UAAf;AACD;AACF,CARD;AAUA1B,MAAM,CAACkC,SAAP,CAAiB,UAACpB,IAAD,EAAU;AACzBjB,EAAAA,SAAS,CAACsC,IAAV;AACD,CAFD;AAIA,eAAenC,MAAf","sourcesContent":["import Vue from 'vue'\nimport Router from 'vue-router'\nimport NProgress from 'nprogress'\nimport 'nprogress/nprogress.css'\nimport { routerMap } from './router.config.js'\n\nVue.use(Router)\n\nconst router = new Router({\n  // mode: 'hash', // 默认是 history 可以改为 hash\n  base: process.env.BASE_URL,\n  scrollBehavior: () => ({ y: 0 }),\n  routes: routerMap\n})\n\n// 全局路由守卫\nconst userAgent = navigator.userAgent\nconst isIE = userAgent.indexOf('Trident') > -1\n\nrouter.beforeEach((to, from, next) => {\n  if (to.path === '/exception/browser') {\n    next()\n  } else {\n    if (isIE) {\n      next({ path: '/exception/browser' })\n    } else {\n      if (to.path === '/user/login' || to.path === '/user/register' || to.path === '/user/retrieve') {\n        next()\n      } else {\n        if (localStorage.getItem('ACCESS_TOKEN')) {\n          NProgress.start()\n          next(Error)\n        } else {\n          next({ path: '/user/login' })\n          localStorage.removeItem('ACCESS_TOKEN')\n        }\n      }\n    }\n  }\n})\n\n// 错误捕获\nrouter.onError((error) => {\n  console.log(error)\n  const targetPath = router.history.pending.fullPath\n  if (error) {\n    console.log(1)\n    window.location.reload(true)\n    router.replace(targetPath)\n  }\n})\n\nrouter.afterEach((from) => {\n  NProgress.done()\n})\n\nexport default router\n"]}]}