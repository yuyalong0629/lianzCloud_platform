{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/tab_goodsInfo/SpriceInfoForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/tab_goodsInfo/SpriceInfoForm.vue","mtime":1560860489610},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _objectSpread from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { setTimeout, clearTimeout } from 'timers';\nexport default {\n  name: 'SpriceInfo',\n  data: function data() {\n    return {\n      timer: null,\n      columns: [{\n        title: '',\n        dataIndex: 'name',\n        align: 'center'\n      }],\n      dataSource: [],\n      dataObj: {},\n      spriceData: []\n    };\n  },\n  props: {\n    infoData: {\n      type: Object,\n      default: {}\n    },\n    spriceInfoData: {\n      type: Array,\n      default: []\n    },\n    craftsInfoData: {\n      type: Array,\n      default: []\n    },\n    materialsGroupInfoData: {\n      type: Array,\n      default: []\n    },\n    spriceInfoBasic: {\n      type: String,\n      default: ''\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearTimeout(this.timer);\n  },\n  methods: {\n    handleChange: function handleChange(value, key, column) {\n      var _this = this;\n\n      var reg = /^[0-9]*$/;\n\n      if (reg.test(value)) {\n        var newData = _toConsumableArray(this.dataSource);\n\n        var target = newData.filter(function (item) {\n          return key === item.key;\n        })[0];\n\n        if (target) {\n          target[column] = value;\n          this.dataSource = newData; // console.log(this.dataSource)\n          // console.log(this.columns.slice(1, this.columns.length))\n\n          this.spriceData = [];\n          this.dataSource.forEach(function (item) {\n            _this.columns.slice(1, _this.columns.length).forEach(function (cItem) {\n              // console.log(cItem)\n              _this.spriceData.push({\n                bomIndex: cItem.id - 1,\n                craftIndex: item.key - 1,\n                price: item[\"plan\".concat(cItem.id)]\n              });\n            });\n          }); // console.log(this.spriceData)\n\n          this.$emit('spriceData', this.spriceData);\n        }\n      } else {\n        this.$message.error('请输入数字');\n      }\n    },\n    handleChangeBasic: function handleChangeBasic(value) {\n      // console.log(value)\n      var reg = /^[0-9]*$/;\n\n      if (reg.test(value)) {\n        this.$emit('basicSprice', value);\n      } else {\n        this.$message.error('请输入数字');\n      }\n    }\n  },\n  watch: {\n    infoData: {\n      handler: function handler(val) {\n        var _this2 = this;\n\n        if (val.craftInfoData.length || val.bomInfoData.length) {\n          console.log(val); // 初始化\n\n          this.dataSource = [];\n          this.columns = [{\n            title: '',\n            dataIndex: 'name',\n            align: 'center'\n          }]; // 遍历columns\n\n          val.bomInfoData.forEach(function (item) {\n            _this2.columns.push({\n              title: item.inputVal,\n              dataIndex: \"plan\".concat(item.id),\n              id: item.id,\n              align: 'center',\n              scopedSlots: {\n                customRender: \"plan\".concat(item.id)\n              }\n            });\n          }); // console.log(this.columns)\n          // 遍历dataIndex\n\n          this.columns.slice(1, this.columns.length).forEach(function (item, index) {\n            _this2.dataObj[item.dataIndex] = '';\n            _this2.dataObj['id'] = item.id;\n          }); // console.log(this.dataObj)\n          // 遍历data\n\n          val.craftInfoData.forEach(function (item) {\n            _this2.dataSource.push(_objectSpread({\n              key: item.id,\n              name: item.inputVal\n            }, _this2.dataObj));\n          }); // console.log(this.dataSource)\n\n          this.spriceData = [];\n          this.dataSource.forEach(function (item) {\n            _this2.columns.slice(1, _this2.columns.length).forEach(function (cItem) {\n              // console.log(cItem)\n              _this2.spriceData.push({\n                bomIndex: cItem.id - 1,\n                craftIndex: item.key - 1,\n                price: item[\"plan\".concat(cItem.id)]\n              });\n            });\n          }); // console.log(this.spriceData)\n\n          this.$emit('spriceData', this.spriceData);\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    // column\n    craftsInfoData: {\n      handler: function handler(val) {\n        var _this3 = this;\n\n        if (val.length) {\n          this.$nextTick(function () {\n            _this3.dataSource = [];\n            val.forEach(function (item, index) {\n              _this3.$nextTick(function () {\n                _this3.dataSource.push(_objectSpread({\n                  key: item.id,\n                  name: item.productCraftName\n                }, _this3.dataObj));\n              });\n            }); // console.log(this.dataObj)\n\n            console.log(_this3.dataSource);\n          });\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    // datasource\n    materialsGroupInfoData: {\n      handler: function handler(val) {\n        var _this4 = this;\n\n        if (val.length) {\n          this.$nextTick(function () {\n            _this4.columns = [{\n              title: '',\n              dataIndex: 'name',\n              align: 'center'\n            }];\n            val.forEach(function (item) {\n              _this4.columns.push({\n                title: item.groupName,\n                dataIndex: \"plan\".concat(item.id),\n                id: item.id,\n                align: 'center',\n                scopedSlots: {\n                  customRender: \"plan\".concat(item.id)\n                }\n              });\n            });\n\n            _this4.columns.slice(1, _this4.columns.length).forEach(function (item, index) {\n              _this4.dataObj[item.dataIndex] = '';\n              _this4.dataObj['id'] = item.id;\n            });\n          });\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    spriceInfoData: {\n      handler: function handler(val) {\n        var _this5 = this;\n\n        if (val.length) {\n          this.timer = setTimeout(function () {\n            // console.log(this.dataSource)\n            // console.log(this.columns)\n            var dataSourceIndex = [];\n\n            _this5.dataSource.forEach(function (item, index) {\n              // console.log(item)\n              var trData = val.filter(function (cItem) {\n                return cItem.craftGroupId === item.key;\n              });\n              dataSourceIndex[index] = _toConsumableArray(trData);\n              dataSourceIndex[index].forEach(function (cItem, cIndex) {\n                // console.log(cItem)\n                _this5.columns.forEach(function (ccItem) {\n                  if (cItem.bomGroupId !== ccItem.id) {// this.dataSource[index][`plan${ccItem.id}`] = '0'\n                  }\n\n                  if (cItem.bomGroupId === ccItem.id) {\n                    _this5.dataSource[index][\"plan\".concat(ccItem.id)] = cItem.price;\n                  }\n                }); // console.log(indexColumn)\n\n              });\n            }); // console.log(dataSourceIndex)\n\n          }, 100);\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  }\n};",{"version":3,"sources":["SpriceInfoForm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"sprice-info\">\n    <a-row :gutter=\"24\">\n      <a-col :span=\"18\">\n        <a-table bordered :dataSource=\"dataSource\" :columns=\"columns\" :pagination=\"false\">\n          <template v-for=\"(value, col) in dataObj\" :slot=\"col\" slot-scope=\"text, record, index\">\n            <div :key=\"col\">\n              <a-input\n                style=\"margin: -5px 5px; width: 80%;\"\n                :value=\"text\"\n                @change=\"e => handleChange(e.target.value, record.key, col)\"\n              />\n            </div>\n          </template>\n        </a-table>\n      </a-col>\n      <a-col :span=\"6\">\n        <a-form-item label=\"基础报价\">\n          <a-input :value=\"spriceInfoBasic\" @change=\"e => handleChangeBasic(e.target.value)\" placeholder=\"基础报价\"/>\n        </a-form-item>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n<script>\nimport { setTimeout, clearTimeout } from 'timers'\nexport default {\n  name: 'SpriceInfo',\n  data() {\n    return {\n      timer: null,\n      columns: [\n        {\n          title: '',\n          dataIndex: 'name',\n          align: 'center'\n        }\n      ],\n      dataSource: [],\n      dataObj: {},\n      spriceData: []\n    }\n  },\n  props: {\n    infoData: {\n      type: Object,\n      default: {}\n    },\n    spriceInfoData: {\n      type: Array,\n      default: []\n    },\n    craftsInfoData: {\n      type: Array,\n      default: []\n    },\n    materialsGroupInfoData: {\n      type: Array,\n      default: []\n    },\n    spriceInfoBasic: {\n      type: String,\n      default: ''\n    }\n  },\n  beforeDestroy() {\n    clearTimeout(this.timer)\n  },\n  methods: {\n    handleChange(value, key, column) {\n      const reg = /^[0-9]*$/\n      if (reg.test(value)) {\n        const newData = [...this.dataSource]\n        const target = newData.filter(item => key === item.key)[0]\n        if (target) {\n          target[column] = value\n          this.dataSource = newData\n          // console.log(this.dataSource)\n          // console.log(this.columns.slice(1, this.columns.length))\n          this.spriceData = []\n          this.dataSource.forEach(item => {\n            this.columns.slice(1, this.columns.length).forEach(cItem => {\n              // console.log(cItem)\n              this.spriceData.push({\n                bomIndex: cItem.id - 1,\n                craftIndex: item.key - 1,\n                price: item[`plan${cItem.id}`]\n              })\n            })\n          })\n          // console.log(this.spriceData)\n          this.$emit('spriceData', this.spriceData)\n        }\n      } else {\n        this.$message.error('请输入数字')\n      }\n    },\n    handleChangeBasic(value) {\n      // console.log(value)\n      const reg = /^[0-9]*$/\n      if (reg.test(value)) {\n        this.$emit('basicSprice', value)\n      } else {\n        this.$message.error('请输入数字')\n      }\n    }\n  },\n  watch: {\n    infoData: {\n      handler(val) {\n        if (val.craftInfoData.length || val.bomInfoData.length) {\n          console.log(val)\n          // 初始化\n          this.dataSource = []\n          this.columns = [\n            {\n              title: '',\n              dataIndex: 'name',\n              align: 'center'\n            }\n          ]\n          // 遍历columns\n          val.bomInfoData.forEach(item => {\n            this.columns.push({\n              title: item.inputVal,\n              dataIndex: `plan${item.id}`,\n              id: item.id,\n              align: 'center',\n              scopedSlots: { customRender: `plan${item.id}` }\n            })\n          })\n          // console.log(this.columns)\n          // 遍历dataIndex\n          this.columns.slice(1, this.columns.length).forEach((item, index) => {\n            this.dataObj[item.dataIndex] = ''\n            this.dataObj['id'] = item.id\n          })\n          // console.log(this.dataObj)\n          // 遍历data\n          val.craftInfoData.forEach(item => {\n            this.dataSource.push({\n              key: item.id,\n              name: item.inputVal,\n              ...this.dataObj\n            })\n          })\n          // console.log(this.dataSource)\n          this.spriceData = []\n          this.dataSource.forEach(item => {\n            this.columns.slice(1, this.columns.length).forEach(cItem => {\n              // console.log(cItem)\n              this.spriceData.push({\n                bomIndex: cItem.id - 1,\n                craftIndex: item.key - 1,\n                price: item[`plan${cItem.id}`]\n              })\n            })\n          })\n          // console.log(this.spriceData)\n          this.$emit('spriceData', this.spriceData)\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    // column\n    craftsInfoData: {\n      handler(val) {\n        if (val.length) {\n          this.$nextTick(() => {\n            this.dataSource = []\n            val.forEach((item, index) => {\n              this.$nextTick(() => {\n                this.dataSource.push({\n                  key: item.id,\n                  name: item.productCraftName,\n                  ...this.dataObj\n                })\n              })\n            })\n            // console.log(this.dataObj)\n            console.log(this.dataSource)\n          })\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    // datasource\n    materialsGroupInfoData: {\n      handler(val) {\n        if (val.length) {\n          this.$nextTick(() => {\n            this.columns = [\n              {\n                title: '',\n                dataIndex: 'name',\n                align: 'center'\n              }\n            ]\n            val.forEach(item => {\n              this.columns.push({\n                title: item.groupName,\n                dataIndex: `plan${item.id}`,\n                id: item.id,\n                align: 'center',\n                scopedSlots: { customRender: `plan${item.id}` }\n              })\n            })\n            this.columns\n              .slice(1, this.columns.length)\n              .forEach((item, index) => {\n                this.dataObj[item.dataIndex] = ''\n                this.dataObj['id'] = item.id\n              })\n          })\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    spriceInfoData: {\n      handler(val) {\n        if (val.length) {\n          this.timer = setTimeout(() => {\n            // console.log(this.dataSource)\n            // console.log(this.columns)\n            const dataSourceIndex = []\n            this.dataSource.forEach((item, index) => {\n              // console.log(item)\n              const trData = val.filter(cItem => {\n                return cItem.craftGroupId === item.key\n              })\n              dataSourceIndex[index] = [...trData]\n              dataSourceIndex[index].forEach((cItem, cIndex) => {\n                // console.log(cItem)\n                this.columns.forEach(ccItem => {\n                  if (cItem.bomGroupId !== ccItem.id) {\n                    // this.dataSource[index][`plan${ccItem.id}`] = '0'\n                  }\n                  if (cItem.bomGroupId === ccItem.id) {\n                    this.dataSource[index][`plan${ccItem.id}`] = cItem.price\n                  }\n                })\n                // console.log(indexColumn)\n              })\n            })\n            // console.log(dataSourceIndex)\n          }, 100)\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n.sprice-info {\n  margin-bottom: 30px;\n}\n</style>\n"],"sourceRoot":"src/views/product/pdm/goods/child_info/tab_goodsInfo"}]}