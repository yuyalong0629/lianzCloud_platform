{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/approval/basic_lib/common.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/approval/basic_lib/common.vue","mtime":1564711940108},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Animation from '@/assets/common/Animation';\nimport approvalInfo from '../child_lib/approvalInfo';\nimport infiniteScroll from 'vue-infinite-scroll';\nimport { status, useApp } from './menu';\nimport api from '@/api/index';\nimport { get, postJson } from '@/api/axios';\nimport Bus from '@/Bus.js';\nexport default {\n  directives: {\n    infiniteScroll: infiniteScroll\n  },\n  components: {\n    Animation: Animation,\n    approvalInfo: approvalInfo\n  },\n  data: function data() {\n    return {\n      labelCol: {\n        span: 6\n      },\n      wrapperCol: {\n        span: 18\n      },\n      key: null,\n      advanced: false,\n      visible: false,\n      dataList: [],\n      dataListSize: 0,\n      currentPage: 1,\n      pageSize: 20,\n      busy: true,\n      loadingCompony: false,\n      propItem: {},\n      status: status,\n      useApp: useApp,\n      founder: [],\n      showAction: false,\n      dto: {\n        bizType: 0,\n        procesEndTime: '',\n        procesStartTime: '',\n        processSerarchType: -1,\n        processStarters: []\n      },\n      timer: ''\n    };\n  },\n  created: function created() {\n    if (this.$route.query.key) {\n      this.key = Number(this.$route.query.key);\n    }\n\n    if (Number(this.$route.query.key) === 4) {\n      this.getFounder();\n    }\n  },\n  methods: {\n    handleInfiniteOnLoad: function handleInfiniteOnLoad() {\n      if (this.dataList.length >= this.dataListSize && this.dataListSize !== 0) {\n        this.loadingCompony = false;\n        this.busy = true;\n      } else {\n        this.getList(this.key);\n        this.currentPage += 1;\n        this.busy = false;\n      }\n    },\n    toggleAdvanced: function toggleAdvanced() {\n      this.advanced = !this.advanced;\n    },\n    getList: function getList(key) {\n      switch (key) {\n        case 1:\n          this.getItem(api.getReviewProcess);\n          break;\n\n        case 2:\n          this.getItem(api.getProcessListToBeRead, 'READ');\n          break;\n\n        case 3:\n          this.getItem(api.foRunProcessByStarter);\n          break;\n\n        case 4:\n          this.getSearchResult();\n          break;\n      }\n    },\n    getItem: function getItem(url, processSerarch) {\n      var _this = this;\n\n      this.loadingCompony = true;\n      get(url, {\n        currentPage: this.currentPage,\n        pageSize: this.pageSize,\n        processSerarch: processSerarch\n      }).then(function (res) {\n        if (res.data.code === 0) {\n          _this.dataListSize = Number(res.data.data.total);\n          _this.loadingCompony = false;\n          _this.dataList = _this.dataList.concat(res.data.data.records);\n        }\n      });\n    },\n    // 查看审批详情 打开抽屉\n    detialView: function detialView(item, type) {\n      var _this2 = this;\n\n      if (type === 'noRead') {\n        get(api.readProcess + \"?runProcessIds=\".concat(item.foRunProcess.id)).then(function (res) {\n          if (res.data.code === 0) {\n            _this2.currentPage = 1;\n            _this2.dataList = [];\n            Bus.$emit('ToObtain', true);\n\n            _this2.getList(_this2.key);\n          }\n        });\n        item.foRunProcessDtoType = 'READED';\n      }\n\n      if (type === 'RUN') {\n        this.showAction = false;\n      } else {\n        this.showAction = true;\n      }\n\n      this.propItem = item;\n      this.visible = true;\n    },\n    // 全部已读\n    allRead: function allRead() {\n      var _this3 = this;\n\n      var data = this.dataList;\n      var runProcessIds = [];\n      data.forEach(function (item) {\n        runProcessIds.push(\"runProcessIds=\".concat(item.foRunProcess.id));\n      });\n      runProcessIds = runProcessIds.join('&');\n      get(api.readProcess + \"?\".concat(runProcessIds)).then(function (res) {\n        if (res.data.code === 0) {\n          _this3.currentPage = 1;\n          _this3.dataList = [];\n\n          _this3.getList(_this3.key);\n\n          Bus.$emit('ToObtain', true);\n        }\n      });\n    },\n    // 关闭审批详情抽屉\n    onClose: function onClose(val) {\n      if (val) {\n        this.dataList = [];\n        this.currentPage = 1;\n        this.getList(this.key);\n      }\n\n      this.visible = false;\n    },\n    // 获取创建人\n    getFounder: function getFounder() {\n      var _this4 = this;\n\n      get(api.getCompanyAllUsers).then(function (res) {\n        if (res.data.code === 0) {\n          _this4.founder = _this4.founder.concat(res.data.data);\n        }\n      });\n    },\n    // 按条件搜索\n    inputChange: function inputChange(val, type) {\n      var _this5 = this;\n\n      this.dataList = [];\n      var dto = this.dto;\n\n      if (type === 'date') {\n        dto.procesStartTime = val[0];\n        dto.procesEndTime = val[1];\n      } else {\n        dto[type] = val >= 0 ? val : -1;\n      }\n\n      if (this.timer !== '') {\n        clearTimeout(this.timer);\n      }\n\n      this.timer = setTimeout(function () {\n        _this5.getSearchResult(1);\n      }, 1000);\n    },\n    getSearchResult: function getSearchResult(currentPage) {\n      var _this6 = this;\n\n      var dto = this.dto;\n      dto.currentPage = currentPage || this.currentPage;\n      dto.pageSize = this.pageSize;\n      postJson(api.searchRunProcess, dto).then(function (res) {\n        if (res.data.code === 0) {\n          _this6.dataListSize = Number(res.data.data.total);\n          _this6.loadingCompony = false;\n          _this6.dataList = _this6.dataList.concat(res.data.data.records);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["common.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"examination\">\n    <div class=\"examination-search\" v-show=\"key === 4\">\n      <a-form layout=\"horizontal\" style=\"margin-bottom:20px\">\n        <a-row>\n          <a-col :span=\"22\">\n            <a-row>\n              <a-col :span=\"8\">\n                <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" label=\"所属应用\">\n                  <a-select\n                    class=\"inputWidth\"\n                    placeholder=\"请选择所属应用\"\n                    :allowClear=\"true\"\n                    @change=\"(val)=>inputChange(val,'bizType')\"\n                  >\n                    <a-select-option v-for=\"item in useApp\" :key=\"item.value\">{{item.label}}</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" label=\"创建时间\">\n                  <a-range-picker\n                    class=\"inputWidth\"\n                    format=\"YYYY/MM/DD\"\n                    @change=\"(dates, dateStrings)=>inputChange(dateStrings,'date')\"\n                  />\n                </a-form-item>\n              </a-col>\n              <a-col :span=\"8\">\n                <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" label=\"状态\">\n                  <a-select\n                    class=\"inputWidth\"\n                    :allowClear=\"true\"\n                    placeholder=\"请选择审批状态\"\n                    @change=\"(val)=>inputChange(val,'processSerarchType')\"\n                  >\n                    <a-select-option v-for=\"item in status\" :key=\"item.value\">{{item.label}}</a-select-option>\n                  </a-select>\n                </a-form-item>\n              </a-col>\n            </a-row>\n            <Animation name=\"fadeIn\">\n              <a-row v-show=\"advanced\">\n                <a-col :span=\"8\">\n                  <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" label=\"创建人\">\n                    <a-select\n                      mode=\"multiple\"\n                      class=\"inputWidth\"\n                      :allowClear=\"true\"\n                      placeholder=\"请选择创建人\"\n                      @change=\"(val)=>inputChange(val,'processStarters')\"\n                    >\n                      <a-select-option v-for=\"item in founder\" :key=\"item.id\">{{item.name}}</a-select-option>\n                    </a-select>\n                  </a-form-item>\n                </a-col>\n                <a-col :span=\"8\">\n                  <a-form-item :label-col=\"labelCol\" :wrapper-col=\"wrapperCol\" label=\"处理时间\">\n                    <a-range-picker class=\"inputWidth\" format=\"YYYY/MM/DD\" />\n                  </a-form-item>\n                </a-col>\n              </a-row>\n            </Animation>\n          </a-col>\n          <a-col :span=\"2\">\n            <a-form-item style=\"text-align:center\">\n              <span style=\"cursor: pointer;\" @click=\"toggleAdvanced\">\n                {{ advanced ? '收起' : '展开' }}\n                <a-icon :type=\"advanced ? 'caret-up' : 'caret-down'\" />\n              </span>\n            </a-form-item>\n          </a-col>\n        </a-row>\n      </a-form>\n    </div>\n    <div class=\"examination-title\">\n      <span>标题</span>\n      <span>内容</span>\n      <span>时间</span>\n      <span>操作</span>\n      <div v-show=\"key === 2\" @click=\"allRead\">全部已阅</div>\n    </div>\n    <div class=\"examination-content\">\n      <div\n        class=\"examination-content-list\"\n        v-infinite-scroll=\"handleInfiniteOnLoad\"\n        :infinite-scroll-disabled=\"busy\"\n        :infinite-scroll-distance=\"10\"\n        :infinite-scroll-immediate-check=\"false\"\n      >\n        <a-list :dataSource=\"dataList\">\n          <a-list-item slot=\"renderItem\" slot-scope=\"item\">\n            <div class=\"examination-content-list-item\">\n              <div class=\"list-item-title\">\n                <span>{{item.foRunProcess.processStarterName}}</span>\n                {{item.foRunProcess.processName}}\n              </div>\n              <div class=\"list-item-content\">\n                <ul>\n                  <li\n                    v-for=\"(item,index) in item.foRunProcess.digest.split('/')\"\n                    :key=\"index\"\n                  >{{item}}</li>\n                </ul>\n              </div>\n              <div class=\"list-item-time\">{{item.foRunProcess.processStarttime | formatDate}}</div>\n              <div class=\"list-item-action\">\n                <template v-if=\"key === 1\">\n                  <a-button type=\"primary\" ghost @click=\"detialView(item,'RUN')\">进入审批</a-button>\n                </template>\n                <template v-if=\"key === 2\">\n                  <a-button\n                    type=\"primary\"\n                    v-if=\"item.foRunProcessDtoType === 'WAITE_READ'\"\n                    @click=\"detialView(item,'noRead')\"\n                  >未阅</a-button>\n                  <a-button\n                    type=\"primary\"\n                    @click=\"detialView(item)\"\n                    v-if=\"item.foRunProcessDtoType === 'READED'\"\n                  >已阅</a-button>\n                </template>\n                <template v-if=\"key === 3\">\n                  <a href=\"javascript:;\" @click=\"detialView(item)\">详情</a>\n                </template>\n                <template v-if=\"key === 4\">\n                  <a-button\n                    type=\"primary\"\n                    v-if=\"item.foRunProcessDtoType === 'WAITE_READ'\"\n                    @click=\"detialView(item,'noRead')\"\n                  >未阅</a-button>\n                  <a-button\n                    type=\"primary\"\n                    v-if=\"item.foRunProcessDtoType === 'READED'\"\n                    @click=\"detialView(item)\"\n                  >已阅</a-button>\n                  <a-button\n                    type=\"primary\"\n                    ghost\n                    v-if=\"item.foRunProcessDtoType==='RUNING'\"\n                    @click=\"detialView(item,'RUN')\"\n                  >进入审批</a-button>\n                  <a-button\n                    type=\"danger\"\n                    ghost\n                    v-if=\"item.foRunProcessDtoType==='NO_PASS'\"\n                    @click=\"detialView(item)\"\n                  >审批不通过</a-button>\n                  <a-button\n                    type=\"primary\"\n                    ghost\n                    v-if=\"item.foRunProcessDtoType==='PASS'\"\n                    @click=\"detialView(item)\"\n                  >审批通过</a-button>\n                </template>\n              </div>\n            </div>\n          </a-list-item>\n        </a-list>\n        <div v-if=\"loadingCompony && !busy\" class=\"demo-loading-container\">\n          <a-spin />\n        </div>\n      </div>\n    </div>\n    <a-drawer\n      destroyOnClose\n      :visible=\"visible\"\n      :closable=\"false\"\n      :width=\"1040\"\n      :wrapStyle=\"{overflow: 'auto',paddingBottom: '108px'}\"\n    >\n      <approvalInfo @onClose=\"onClose\" :detial=\"propItem\" :showAction=\"showAction\"></approvalInfo>\n    </a-drawer>\n  </div>\n</template>\n\n<script>\nimport Animation from '@/assets/common/Animation'\nimport approvalInfo from '../child_lib/approvalInfo'\nimport infiniteScroll from 'vue-infinite-scroll'\nimport { status, useApp } from './menu'\nimport api from '@/api/index'\nimport { get, postJson } from '@/api/axios'\nimport Bus from '@/Bus.js'\nexport default {\n  directives: { infiniteScroll },\n  components: {\n    Animation,\n    approvalInfo\n  },\n  data() {\n    return {\n      labelCol: { span: 6 },\n      wrapperCol: { span: 18 },\n      key: null,\n      advanced: false,\n      visible: false,\n      dataList: [],\n      dataListSize: 0,\n      currentPage: 1,\n      pageSize: 20,\n      busy: true,\n      loadingCompony: false,\n      propItem: {},\n      status: status,\n      useApp: useApp,\n      founder: [],\n      showAction: false,\n      dto: {\n        bizType: 0,\n        procesEndTime: '',\n        procesStartTime: '',\n        processSerarchType: -1,\n        processStarters: []\n      },\n      timer: ''\n    }\n  },\n  created() {\n    if (this.$route.query.key) {\n      this.key = Number(this.$route.query.key)\n    }\n    if (Number(this.$route.query.key) === 4) {\n      this.getFounder()\n    }\n  },\n  methods: {\n    handleInfiniteOnLoad() {\n      if (this.dataList.length >= this.dataListSize && this.dataListSize !== 0) {\n        this.loadingCompony = false\n        this.busy = true\n      } else {\n        this.getList(this.key)\n        this.currentPage += 1\n        this.busy = false\n      }\n    },\n    toggleAdvanced() {\n      this.advanced = !this.advanced\n    },\n    getList(key) {\n      switch (key) {\n        case 1:\n          this.getItem(api.getReviewProcess)\n          break\n        case 2:\n          this.getItem(api.getProcessListToBeRead, 'READ')\n          break\n        case 3:\n          this.getItem(api.foRunProcessByStarter)\n          break\n        case 4:\n          this.getSearchResult()\n          break\n      }\n    },\n    getItem(url, processSerarch) {\n      this.loadingCompony = true\n      get(url, { currentPage: this.currentPage, pageSize: this.pageSize, processSerarch }).then(res => {\n        if (res.data.code === 0) {\n          this.dataListSize = Number(res.data.data.total)\n          this.loadingCompony = false\n          this.dataList = this.dataList.concat(res.data.data.records)\n        }\n      })\n    },\n    // 查看审批详情 打开抽屉\n    detialView(item, type) {\n      if (type === 'noRead') {\n        get(api.readProcess + `?runProcessIds=${item.foRunProcess.id}`).then(res => {\n          if (res.data.code === 0) {\n            this.currentPage = 1\n            this.dataList = []\n            Bus.$emit('ToObtain', true)\n            this.getList(this.key)\n          }\n        })\n        item.foRunProcessDtoType = 'READED'\n      }\n      if (type === 'RUN') {\n        this.showAction = false\n      } else {\n        this.showAction = true\n      }\n      this.propItem = item\n      this.visible = true\n    },\n    // 全部已读\n    allRead() {\n      const data = this.dataList\n      let runProcessIds = []\n      data.forEach(item => {\n        runProcessIds.push(`runProcessIds=${item.foRunProcess.id}`)\n      })\n      runProcessIds = runProcessIds.join('&')\n      get(api.readProcess + `?${runProcessIds}`).then(res => {\n        if (res.data.code === 0) {\n          this.currentPage = 1\n          this.dataList = []\n          this.getList(this.key)\n          Bus.$emit('ToObtain', true)\n        }\n      })\n    },\n    // 关闭审批详情抽屉\n    onClose(val) {\n      if (val) {\n        this.dataList = []\n        this.currentPage = 1\n        this.getList(this.key)\n      }\n      this.visible = false\n    },\n    // 获取创建人\n    getFounder() {\n      get(api.getCompanyAllUsers).then(res => {\n        if (res.data.code === 0) {\n          this.founder = this.founder.concat(res.data.data)\n        }\n      })\n    },\n    // 按条件搜索\n    inputChange(val, type) {\n      this.dataList = []\n      const dto = this.dto\n      if (type === 'date') {\n        dto.procesStartTime = val[0]\n        dto.procesEndTime = val[1]\n      } else {\n        dto[type] = val >= 0 ? val : -1\n      }\n      if (this.timer !== '') {\n        clearTimeout(this.timer)\n      }\n      this.timer = setTimeout(() => {\n        this.getSearchResult(1)\n      }, 1000)\n    },\n    getSearchResult(currentPage) {\n      const dto = this.dto\n      dto.currentPage = currentPage || this.currentPage\n      dto.pageSize = this.pageSize\n      postJson(api.searchRunProcess, dto).then(res => {\n        if (res.data.code === 0) {\n          this.dataListSize = Number(res.data.data.total)\n          this.loadingCompony = false\n          this.dataList = this.dataList.concat(res.data.data.records)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n@import \"~styles/variable.less\";\n\n.inputWidth {\n  .inputWidth();\n}\n\n.examination {\n  padding: 0 30px;\n  &-title {\n    position: relative;\n    display: flex;\n    flex-direction: row;\n    font-size: 14px;\n    color: #999999;\n    border-bottom: 1px dashed #eeeeee;\n    & > span {\n      flex: 15%;\n      padding: 10px;\n      &:first-child {\n        flex: 30%;\n      }\n      &:nth-child(2) {\n        flex: 40%;\n      }\n    }\n    & > div {\n      position: absolute;\n      right: 10px;\n      top: 10px;\n      color: #007aff;\n      cursor: pointer;\n    }\n  }\n  &-content {\n    &-list-item {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      border-bottom: 1px solid #eeeeee;\n      font-size: 14px;\n      color: #333333;\n      width: 100%;\n      & > div {\n        flex: 15%;\n        padding: 10px;\n        &:first-child {\n          flex: 30%;\n          & > span {\n            display: inline-block;\n            width: 50px;\n            height: 50px;\n            background-color: #5077d1;\n            text-align: center;\n            line-height: 50px;\n            border-radius: 50%;\n            color: #fff;\n            margin-right: 10px;\n          }\n        }\n        &:nth-child(2) {\n          flex: 40%;\n          & > ul > li {\n            padding: 3px 0;\n            &:last-child {\n              font-size: 16px;\n              color: #ff9436;\n            }\n          }\n        }\n      }\n      .list-item-action {\n        & > button {\n          border-radius: 15px;\n        }\n      }\n    }\n  }\n}\n/deep/.ant-list-split .ant-list-item {\n  border: none !important;\n  padding: 0 !important;\n}\n.demo-infinite-container {\n  border: 1px solid #e8e8e8;\n  border-radius: 4px;\n  overflow: auto;\n  padding: 8px 24px 8px 10px;\n  height: 84vh;\n}\n.demo-loading-container {\n  position: absolute;\n  bottom: 40px;\n  width: 100%;\n  text-align: center;\n}\n</style>\n"],"sourceRoot":"src/views/approval/basic_lib"}]}