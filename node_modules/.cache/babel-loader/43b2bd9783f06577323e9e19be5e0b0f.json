{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/cust/child_info/CustomerInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/cust/child_info/CustomerInfo.vue","mtime":1561636895983},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Object$keys from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Promise from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport PromptTitle from '@/components/tools/prompt/PromptTitle';\nimport CustForm from './CustForm';\nimport ConcatForm from './ContactForm';\nimport InvoiceForm from './InvoiceForm';\nimport AddressForm from './AddressForm';\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin';\nimport { subAddCust, uploadCustomerAndMallUser } from '../basic_lib/index';\nimport { findParentId } from 'utils/utils.js';\nexport default {\n  name: 'CustomerInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data: function data() {\n    return {\n      customer: {},\n      // 客户信息\n      mallUserNatureDtos: [],\n      // 联系人信息\n      custInvoiceInfo: {},\n      // 发票信息\n      customerAddrList: [],\n      // 地址信息\n      custFormInfo: {},\n      invoiceInfo: {},\n      mallUsersInfo: [],\n      addressInfo: [],\n      custManager: undefined\n    };\n  },\n  props: {\n    customerInfo: {\n      type: Object,\n      default: {},\n      required: false\n    }\n  },\n  created: function created() {},\n  methods: {\n    // 提交\n    onSubmit: function onSubmit(e) {\n      var _this = this;\n\n      e.preventDefault();\n      this.getFormData().then(function () {\n        var params = {\n          customer: _objectSpread({}, _this.customer, {\n            custManager: _this.customer.custManagerId.label,\n            custManagerId: _this.customer.custManagerId.key\n          }),\n          mallUserNatureDtos: _toConsumableArray(_this.mallUserNatureDtos),\n          custInvoiceInfo: _objectSpread({}, _this.custInvoiceInfo, {\n            deleted: false\n          }),\n          customerAddrList: _toConsumableArray(_this.customerAddrList)\n        };\n        console.log(params);\n        subAddCust.call(_this, params);\n      });\n    },\n    // 保存修改\n    onSave: function onSave(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      this.getFormData().then(function () {\n        var params = {\n          customer: _objectSpread({}, _this2.customer, {\n            id: _this2.custFormInfo.id,\n            custFrom: _this2.customer.custFrom === '线上注册' ? 0 : 1,\n            custLevel: _this2.setCustLevel,\n            custManager: _this2.customer.custManagerId.label,\n            custManagerId: _this2.customer.custManagerId.key\n          }),\n          mallUserNatureDtos: _toConsumableArray(_this2.mallUserNatureDtos),\n          custInvoiceInfo: _objectSpread({}, _this2.custInvoiceInfo, {\n            id: _this2.invoiceInfo.id,\n            custId: _this2.invoiceInfo.custId,\n            deleted: false\n          }),\n          customerAddrList: _toConsumableArray(_this2.customerAddrList)\n        };\n        console.log(params);\n        uploadCustomerAndMallUser.call(_this2, params);\n      });\n    },\n    // 编辑 || 取消\n    isDisabled: function isDisabled(val) {\n      var _this3 = this;\n\n      var edit = new _Promise(function (resolved) {\n        // Input选中\n        _this3.disabled = !val; // label color\n\n        _this3.isLabelColor = !_this3.isLabelColor;\n        resolved();\n      });\n      edit.then(function () {\n        if (_this3.disabled) {\n          _this3.setFormData();\n        }\n      });\n    },\n    // 删除\n    isDelete: function isDelete(val) {\n      // deleteCategory.call(this, this.viewCatattrInfo.id).then(() => {\n      this.$emit('isDrawer', val); // })\n    },\n    // 联系人数组\n    userNatureDtos: function userNatureDtos(val) {\n      var _this4 = this;\n\n      val.forEach(function (item, index) {\n        _this4.mallUserNatureDtos[index] = _objectSpread({}, item, {\n          sex: item.sex === '男' ? '0' : '1'\n        });\n      });\n      console.log(this.mallUserNatureDtos);\n    },\n    // 地址信息\n    custAddrList: function custAddrList(val) {\n      this.customerAddrList = val;\n      console.log(this.customerAddrList);\n    },\n    // FormData\n    getFormData: function () {\n      var _getFormData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this5 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // 基本信息\n                this.$refs.custForm.custForm.validateFields(function (err, values) {\n                  if (!err) {\n                    console.log(values);\n                    _this5.customer = _objectSpread({}, values, {\n                      custProvince: values.custAddress[0],\n                      custCity: values.custAddress[1],\n                      custArea: values.custAddress[2]\n                    });\n                    delete _this5.customer.custAddress;\n                  }\n                }); // 发票信息\n\n                this.$refs.invoiceForm.invoiceForm.validateFields(function (err, values) {\n                  if (!err) {\n                    console.log(values);\n                    _this5.custInvoiceInfo = values;\n                  }\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getFormData() {\n        return _getFormData.apply(this, arguments);\n      }\n\n      return getFormData;\n    }(),\n    // Form详情\n    setFormData: function setFormData() {\n      var _this$$refs$invoiceFo;\n\n      // 客户信息\n      this.$refs.custForm.custForm.setFieldsValue({\n        custName: this.custFormInfo.custName,\n        custPhone: this.custFormInfo.custPhone,\n        custIndustry: this.custFormInfo.custIndustry,\n        custShortName: this.custFormInfo.custShortName,\n        custManagerId: {\n          key: this.custFormInfo.custManagerId || '',\n          label: this.custFormInfo.custManager\n        },\n        custLevel: this.getCustLevel,\n        custAddress: [this.custFormInfo.custProvince, this.custFormInfo.custCity, this.custFormInfo.custArea],\n        custDetailAddr: this.custFormInfo.custDetailAddr,\n        custFax: this.custFormInfo.custFax,\n        custWebsite: this.custFormInfo.custWebsite,\n        custFrom: this.custFormInfo.custFrom === 0 ? '线上注册' : '线下注册'\n      }); // 发票信息\n\n      this.$refs.invoiceForm.invoiceForm.setFieldsValue((_this$$refs$invoiceFo = {\n        iiCompanyName: this.invoiceInfo.iiCompanyName,\n        iiTaxpayerId: this.invoiceInfo.iiTaxpayerId,\n        iiBank: this.invoiceInfo.iiBank,\n        iiAccountName: this.invoiceInfo.iiAccountName,\n        iiTaxContent: this.invoiceInfo.iiTaxContent\n      }, _defineProperty(_this$$refs$invoiceFo, \"iiTaxContent\", this.invoiceInfo.iiTaxContent), _defineProperty(_this$$refs$invoiceFo, \"iiContact\", this.invoiceInfo.iiContact), _defineProperty(_this$$refs$invoiceFo, \"iiAddress\", this.invoiceInfo.iiAddress), _this$$refs$invoiceFo));\n    }\n  },\n  watch: {\n    customerInfo: {\n      handler: function handler(val) {\n        console.log(_Object$keys(val).length);\n\n        if (_Object$keys(val).length) {\n          this.custFormInfo = val.customer;\n          this.invoiceInfo = val.custInvoiceInfo;\n          this.mallUsersInfo = val.mallUsers;\n          this.addressInfo = val.customerAddrList;\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  computed: {\n    getCustLevel: function getCustLevel() {\n      var custLevelArr = ['V1', 'V2', 'V3', 'V4', 'V5'];\n      return custLevelArr[this.custFormInfo.custLevel - 1];\n    },\n    setCustLevel: function setCustLevel() {\n      var custLevelArr = ['V1', 'V2', 'V3', 'V4', 'V5'];\n      return custLevelArr.indexOf(this.customer.custLevel) + 1;\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle,\n    'cust-form': CustForm,\n    'concat-form': ConcatForm,\n    'invoice-form': InvoiceForm,\n    'address-form': AddressForm\n  }\n};",{"version":3,"sources":["CustomerInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"customer-info\">\n    <prompt-title @isDisabled=\"isDisabled\" @isDelete=\"isDelete\"></prompt-title>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"customer-title\">基本信息</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <cust-form ref=\"custForm\" :custFormInfo=\"custFormInfo\" :childDisabled=\"disabled\"/>\n      </a-col>\n      <a-col :span=\"24\">\n        <h3 class=\"customer-title\">联系人信息</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <concat-form @userNatureDtos=\"userNatureDtos\" :mallUsersInfo=\"mallUsersInfo\"/>\n      </a-col>\n      <a-col :span=\"24\">\n        <h3 class=\"customer-title\">发票信息</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <invoice-form ref=\"invoiceForm\" :childDisabled=\"disabled\" :invoiceInfo=\"invoiceInfo\"/>\n      </a-col>\n      <a-col :span=\"24\">\n        <h3 class=\"customer-title\">收货地址</h3>\n      </a-col>\n      <a-col :span=\"24\" style=\"margin-bottom: 30px;\">\n        <address-form @custAddrList=\"custAddrList\" :addressInfo=\"addressInfo\"/>\n      </a-col>\n    </a-row>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          zIndex: 10,\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport PromptTitle from '@/components/tools/prompt/PromptTitle'\nimport CustForm from './CustForm'\nimport ConcatForm from './ContactForm'\nimport InvoiceForm from './InvoiceForm'\nimport AddressForm from './AddressForm'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport { subAddCust, uploadCustomerAndMallUser } from '../basic_lib/index'\nimport { findParentId } from 'utils/utils.js'\n\nexport default {\n  name: 'CustomerInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      customer: {}, // 客户信息\n      mallUserNatureDtos: [], // 联系人信息\n      custInvoiceInfo: {}, // 发票信息\n      customerAddrList: [], // 地址信息\n      custFormInfo: {},\n      invoiceInfo: {},\n      mallUsersInfo: [],\n      addressInfo: [],\n      custManager: undefined\n    }\n  },\n  props: {\n    customerInfo: {\n      type: Object,\n      default: {},\n      required: false\n    }\n  },\n  created() {},\n  methods: {\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          customer: {\n            ...this.customer,\n            custManager: this.customer.custManagerId.label,\n            custManagerId: this.customer.custManagerId.key\n          },\n          mallUserNatureDtos: [...this.mallUserNatureDtos],\n          custInvoiceInfo: {\n            ...this.custInvoiceInfo,\n            deleted: false\n          },\n          customerAddrList: [...this.customerAddrList]\n        }\n        console.log(params)\n        subAddCust.call(this, params)\n      })\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          customer: {\n            ...this.customer,\n            id: this.custFormInfo.id,\n            custFrom: this.customer.custFrom === '线上注册' ? 0 : 1,\n            custLevel: this.setCustLevel,\n            custManager: this.customer.custManagerId.label,\n            custManagerId: this.customer.custManagerId.key\n          },\n          mallUserNatureDtos: [...this.mallUserNatureDtos],\n          custInvoiceInfo: {\n            ...this.custInvoiceInfo,\n            id: this.invoiceInfo.id,\n            custId: this.invoiceInfo.custId,\n            deleted: false\n          },\n          customerAddrList: [...this.customerAddrList]\n        }\n        console.log(params)\n        uploadCustomerAndMallUser.call(this, params)\n      })\n    },\n    // 编辑 || 取消\n    isDisabled(val) {\n      const edit = new Promise(resolved => {\n        // Input选中\n        this.disabled = !val\n        // label color\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    },\n    // 删除\n    isDelete(val) {\n      // deleteCategory.call(this, this.viewCatattrInfo.id).then(() => {\n      this.$emit('isDrawer', val)\n      // })\n    },\n    // 联系人数组\n    userNatureDtos(val) {\n      val.forEach((item, index) => {\n        this.mallUserNatureDtos[index] = {\n          ...item,\n          sex: item.sex === '男' ? '0' : '1'\n        }\n      })\n      console.log(this.mallUserNatureDtos)\n    },\n    // 地址信息\n    custAddrList(val) {\n      this.customerAddrList = val\n      console.log(this.customerAddrList)\n    },\n    // FormData\n    async getFormData() {\n      // 基本信息\n      this.$refs.custForm.custForm.validateFields((err, values) => {\n        if (!err) {\n          console.log(values)\n          this.customer = {\n            ...values,\n            custProvince: values.custAddress[0],\n            custCity: values.custAddress[1],\n            custArea: values.custAddress[2]\n          }\n          delete this.customer.custAddress\n        }\n      })\n      // 发票信息\n      this.$refs.invoiceForm.invoiceForm.validateFields((err, values) => {\n        if (!err) {\n          console.log(values)\n          this.custInvoiceInfo = values\n        }\n      })\n    },\n    // Form详情\n    setFormData() {\n      // 客户信息\n      this.$refs.custForm.custForm.setFieldsValue({\n        custName: this.custFormInfo.custName,\n        custPhone: this.custFormInfo.custPhone,\n        custIndustry: this.custFormInfo.custIndustry,\n        custShortName: this.custFormInfo.custShortName,\n        custManagerId: {\n          key: this.custFormInfo.custManagerId || '',\n          label: this.custFormInfo.custManager\n        },\n        custLevel: this.getCustLevel,\n        custAddress: [\n          this.custFormInfo.custProvince,\n          this.custFormInfo.custCity,\n          this.custFormInfo.custArea\n        ],\n        custDetailAddr: this.custFormInfo.custDetailAddr,\n        custFax: this.custFormInfo.custFax,\n        custWebsite: this.custFormInfo.custWebsite,\n        custFrom: this.custFormInfo.custFrom === 0 ? '线上注册' : '线下注册'\n      })\n      // 发票信息\n      this.$refs.invoiceForm.invoiceForm.setFieldsValue({\n        iiCompanyName: this.invoiceInfo.iiCompanyName,\n        iiTaxpayerId: this.invoiceInfo.iiTaxpayerId,\n        iiBank: this.invoiceInfo.iiBank,\n        iiAccountName: this.invoiceInfo.iiAccountName,\n        iiTaxContent: this.invoiceInfo.iiTaxContent,\n        iiTaxContent: this.invoiceInfo.iiTaxContent,\n        iiContact: this.invoiceInfo.iiContact,\n        iiAddress: this.invoiceInfo.iiAddress\n      })\n    }\n  },\n  watch: {\n    customerInfo: {\n      handler(val) {\n        console.log(Object.keys(val).length)\n        if (Object.keys(val).length) {\n          this.custFormInfo = val.customer\n          this.invoiceInfo = val.custInvoiceInfo\n          this.mallUsersInfo = val.mallUsers\n          this.addressInfo = val.customerAddrList\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  computed: {\n    getCustLevel() {\n      const custLevelArr = ['V1', 'V2', 'V3', 'V4', 'V5']\n      return custLevelArr[this.custFormInfo.custLevel - 1]\n    },\n    setCustLevel() {\n      const custLevelArr = ['V1', 'V2', 'V3', 'V4', 'V5']\n      return custLevelArr.indexOf(this.customer.custLevel) + 1\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle,\n    'cust-form': CustForm,\n    'concat-form': ConcatForm,\n    'invoice-form': InvoiceForm,\n    'address-form': AddressForm\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.customer-info {\n  .customer-title {\n    margin: 10px 0;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n  .label-box {\n    margin-bottom: 0;\n    .create-label {\n      background: #1890ff;\n      color: #fff;\n      border-radius: 4px;\n      display: inline-block;\n      height: 24px;\n      line-height: 12px;\n      padding: 6px;\n      margin: 0 4px;\n      i {\n        font-size: 10px;\n        margin-left: 4px;\n      }\n    }\n  }\n}\n</style>"],"sourceRoot":"src/views/cust/child_info"}]}