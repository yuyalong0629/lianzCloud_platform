{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/pdm/goods/Goods.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/src/views/product/pdm/goods/Goods.vue","mtime":1564364184974},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-projects/platform/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ScrollList from '@/components/scroll_list/ScrollList.vue';\nimport Goodsinfo from './child_info/GoodsInfo';\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin';\nimport { columns, springType } from './basic_lib/column';\nimport { searchGoods, custNamefetch, goodsNamefetch, goodsCodefetch, getViewInfo, bomDelete } from './basic_lib/index';\nexport default {\n  name: 'Goods',\n  mixins: [mixinBasic, mixinDrawer],\n  data: function data() {\n    return {\n      data: [],\n      columns: columns,\n      springType: springType,\n      selectedRowKeys: [],\n      // 删除勾选项\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      // 客户名称模糊搜素\n      selectNameData: [],\n      selectNameValue: undefined,\n      // 产品编码模糊搜索\n      selectCodeData: [],\n      selectCodeValue: undefined,\n      // 弹簧种类\n      springValue: undefined,\n      // 详情INFO\n      goodsViewInfo: {}\n    };\n  },\n  created: function created() {\n    searchGoods.call(this, {}); // 成品列表商品搜索Tab列表\n  },\n  methods: {\n    // 查看详情\n    onHandleInfo: function onHandleInfo(record) {\n      var _this = this;\n\n      if (this.getMenuPermission.includes('DETAIL')) {\n        getViewInfo.call(this, record.id).then(function () {\n          _this.visible = true;\n        });\n        this.$store.commit('setPromptTitle', {\n          title: '产品信息详情',\n          isEdit: true\n        });\n        return;\n      }\n\n      this.$message.error('权限不足');\n    },\n    // 新建\n    showDrawer: function showDrawer() {\n      this.visible = true;\n      this.goodsViewInfo = {};\n      this.$store.commit('setPromptTitle', {\n        title: '新建产品信息',\n        isEdit: false\n      });\n    },\n    // $emit改变isvisible\n    isDrawer: function isDrawer(val) {\n      var _this2 = this;\n\n      this.visible = val; // 关闭抽屉主动初始化\n\n      this.timer = setTimeout(function () {\n        _this2.rest().then(function () {\n          searchGoods.call(_this2, {}); // 成品列表商品搜索Tab列表\n        });\n      }, 100);\n    },\n    // 关闭抽屉回调\n    closeDrawer: function closeDrawer() {\n      var _this3 = this;\n\n      this.visible = false; // 关闭抽屉主动初始化\n\n      this.timer = setTimeout(function () {\n        _this3.rest().then(function () {\n          searchGoods.call(_this3, {}); // 成品列表商品搜索Tab列表\n        });\n      }, 100);\n    },\n    // rest\n    rest: function () {\n      var _rest = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.selectCodeValue = undefined;\n                this.selectNameValue = undefined;\n                this.springValue = undefined;\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function rest() {\n        return _rest.apply(this, arguments);\n      }\n\n      return rest;\n    }(),\n    // 删除\n    processDelete: function processDelete() {\n      var that = this;\n\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk: function onOk() {\n            var params = that.selectedRowKeys.join('&skuIds=');\n            bomDelete.call(that, params).then(function () {\n              that.rest().then(function () {\n                searchGoods.call(that, {});\n                that.selectedRowKeys = [];\n              });\n            });\n          },\n          onCancel: function onCancel() {\n            console.log('Cancel');\n          },\n          class: 'test'\n        });\n      }\n    },\n    // 分页\n    onChangePage: function onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标');\n      console.log(pagination.pageSize);\n      searchGoods.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize,\n        skuCode: this.selectCodeValue,\n        keywords: this.selectNameValue,\n        springType: this.springValue\n      }); // 切换分页先清空选中状态\n\n      this.selectedRowKeys = [];\n    },\n    // 产品编码模糊搜索\n    handleSearchCode: function handleSearchCode(value) {\n      var _this4 = this;\n\n      goodsCodefetch.call(this, value, function (data) {\n        return _this4.selectCodeData = data;\n      });\n      console.log(this.selectCodeData);\n    },\n    handleChangeCode: function handleChangeCode(value) {\n      this.selectCodeValue = value;\n      searchGoods.call(this, {\n        skuCode: value\n      });\n    },\n    // handleScrollCode(e) {\n    //   const SCROLLTHEIGHT = e.target.scrollHeight // 获取元素内容高度\n    //   const SCROLLTOP = e.target.scrollTop // 获取或者设置元素的滚动高度\n    //   const CLIENTHEIGHT = e.target.clientHeight // 读取元素的可见高度\n    //   const CONDITION = SCROLLTHEIGHT - SCROLLTOP <= CLIENTHEIGHT\n    //   if (CONDITION) {\n    //     this.scrollPositionCode++\n    //     listCompanyGoodsCode.call(this, this.scrollPositionCode)\n    //   }\n    // },\n    // 产品名称\n    handleSearchName: function handleSearchName(value) {\n      var _this5 = this;\n\n      goodsNamefetch.call(this, value, function (data) {\n        return _this5.selectNameData = data;\n      }); // console.log(this.selectNameData)\n    },\n    handleChangeName: function handleChangeName(value) {\n      console.log(value);\n      this.selectNameValue = value;\n      searchGoods.call(this, {\n        keywords: [value || '']\n      });\n    },\n    // 弹簧种类\n    handleChangeSpring: function handleChangeSpring(value) {\n      console.log(value);\n      this.springValue = value;\n      searchGoods.call(this, {\n        springType: value\n      });\n    },\n    // 点击客户列表更新Tab详情\n    custId: function custId(val) {\n      searchGoods.call(this, {\n        custId: val\n      });\n    },\n    custVal: function custVal(val) {\n      searchGoods.call(this, {\n        custId: val\n      });\n    },\n    // Tab 删除\n    onChangeTab: function onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys);\n      this.selectedRowKeys = selectedRowKeys;\n    }\n  },\n  computed: {\n    rowSelection: function rowSelection() {\n      var selectedRowKeys = this.selectedRowKeys;\n      return {\n        selectedRowKeys: selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      };\n    },\n    getMenuPermission: function getMenuPermission() {\n      return this.$store.state.menuPermission;\n    }\n  },\n  components: {\n    'scroll-list': ScrollList,\n    'goods-info': Goodsinfo\n  }\n};",{"version":3,"sources":["Goods.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"goods\">\n    <a-row>\n      <!-- 编辑 -->\n      <div class=\"process-setup\">\n        <a-button\n          type=\"primary\"\n          @click=\"showDrawer\"\n          v-show=\"this.getMenuPermission.includes('ADD')\"\n        >\n          <a-icon type=\"plus\" />新建\n        </a-button>\n        <span\n          class=\"delete-btn\"\n          @click=\"processDelete\"\n          v-show=\"this.getMenuPermission.includes('DELETES')\"\n        >\n          <a-icon class=\"delete-icon\" type=\"delete\" />\n          <span>删除</span>\n        </span>\n        <a-dropdown>\n          <span class=\"derive-btn\">\n            <a-icon class=\"derive-icon\" type=\"check-circle\" />\n            <span>更多</span>\n          </span>\n          <a-menu slot=\"overlay\">\n            <a-menu-item key=\"0\" v-show=\"this.getMenuPermission.includes('IMPORT')\">\n              <span>导入</span>\n            </a-menu-item>\n            <a-menu-item key=\"1\" v-show=\"this.getMenuPermission.includes('EXPORT')\">\n              <span>导出</span>\n            </a-menu-item>\n          </a-menu>\n        </a-dropdown>\n      </div>\n    </a-row>\n    <a-row :gutter=\"20\">\n      <a-col :span=\"5\">\n        <scroll-list @custId=\"custId\" @custVal=\"custVal\"></scroll-list>\n      </a-col>\n      <a-col :span=\"19\">\n        <a-row>\n          <a-col :span=\"24\" :style=\"{marginBottom: '16px'}\">\n            <a-form layout=\"inline\">\n              <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"产品编码\">\n                <a-select\n                  showSearch\n                  allowClear\n                  :value=\"selectCodeValue\"\n                  placeholder=\"请输入产品编码\"\n                  style=\"width: 200px\"\n                  :defaultActiveFirstOption=\"false\"\n                  :showArrow=\"false\"\n                  :filterOption=\"false\"\n                  @search=\"handleSearchCode\"\n                  @change=\"handleChangeCode\"\n                  :notFoundContent=\"null\"\n                >\n                  <a-select-option v-for=\"(d, i) in selectCodeData\" :key=\"d\">{{ d }}</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"产品名称\">\n                <a-select\n                  showSearch\n                  allowClear\n                  :value=\"selectNameValue\"\n                  placeholder=\"请输入产品名称\"\n                  style=\"width: 200px\"\n                  :defaultActiveFirstOption=\"false\"\n                  :showArrow=\"false\"\n                  :filterOption=\"false\"\n                  @search=\"handleSearchName\"\n                  @change=\"handleChangeName\"\n                  :notFoundContent=\"null\"\n                >\n                  <a-select-option v-for=\"(d, i) in selectNameData\" :key=\"d\">{{ d }}</a-select-option>\n                </a-select>\n              </a-form-item>\n              <a-form-item :label-col=\"{span: 8}\" :wrapper-col=\"{span: 16}\" label=\"弹簧种类\">\n                <a-select\n                  allowClear\n                  :value=\"springValue\"\n                  placeholder=\"请输入弹簧种类\"\n                  style=\"width: 200px\"\n                  @change=\"handleChangeSpring\"\n                >\n                  <a-select-option v-for=\"(d, i) in springType\" :key=\"d.id\">{{d.name}}</a-select-option>\n                </a-select>\n              </a-form-item>\n            </a-form>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-table\n              :columns=\"columns\"\n              :dataSource=\"data\"\n              :loading=\"loading\"\n              @change=\"onChangePage\"\n              :pagination=\"pagination\"\n              :rowSelection=\"rowSelection\"\n              :scroll=\"{ y: '66vh' }\"\n            >\n              <template slot=\"code\" slot-scope=\"text, record\">\n                <a @click=\"onHandleInfo(record)\" href=\"javascript:;\">{{ text }}</a>\n              </template>\n              <template slot=\"time\" slot-scope=\"text, record\">\n                <span>{{ text | formatDate }}</span>\n              </template>\n            </a-table>\n          </a-col>\n        </a-row>\n      </a-col>\n    </a-row>\n    <!-- 抽屉 -->\n    <a-drawer\n      :destroyOnClose=\"true\"\n      placement=\"right\"\n      :closable=\"false\"\n      @close=\"closeDrawer\"\n      :visible=\"visible\"\n      :width=\"1040\"\n      :zIndex=\"100\"\n      :wrapStyle=\"{height: '100%',overflow: 'auto',paddingBottom: '108px'}\"\n    >\n      <goods-info @isDrawer=\"isDrawer\" :goodsViewInfo=\"goodsViewInfo\" />\n    </a-drawer>\n  </div>\n</template>\n<script>\nimport ScrollList from '@/components/scroll_list/ScrollList.vue'\nimport Goodsinfo from './child_info/GoodsInfo'\nimport { mixinBasic, mixinDrawer } from '@/components/tools/mixin/mixin'\nimport { columns, springType } from './basic_lib/column'\nimport {\n  searchGoods,\n  custNamefetch,\n  goodsNamefetch,\n  goodsCodefetch,\n  getViewInfo,\n  bomDelete\n} from './basic_lib/index'\n\nexport default {\n  name: 'Goods',\n  mixins: [mixinBasic, mixinDrawer],\n  data() {\n    return {\n      data: [],\n      columns,\n      springType,\n      selectedRowKeys: [], // 删除勾选项\n      pagination: {\n        total: 0,\n        defaultPageSize: 15,\n        defaultCurrent: 1,\n        showQuickJumper: true,\n        hideOnSinglePage: true,\n        showSizeChanger: true,\n        pageSizeOptions: ['10', '15', '30', '50', '100']\n      },\n      // 客户名称模糊搜素\n      selectNameData: [],\n      selectNameValue: undefined,\n      // 产品编码模糊搜索\n      selectCodeData: [],\n      selectCodeValue: undefined,\n      // 弹簧种类\n      springValue: undefined,\n      // 详情INFO\n      goodsViewInfo: {}\n    }\n  },\n  created() {\n    searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n  },\n  methods: {\n    // 查看详情\n    onHandleInfo(record) {\n      if (this.getMenuPermission.includes('DETAIL')) {\n        getViewInfo.call(this, record.id).then(() => {\n          this.visible = true\n        })\n        this.$store.commit('setPromptTitle', {\n          title: '产品信息详情',\n          isEdit: true\n        })\n        return\n      }\n      this.$message.error('权限不足')\n    },\n    // 新建\n    showDrawer() {\n      this.visible = true\n      this.goodsViewInfo = {}\n      this.$store.commit('setPromptTitle', {\n        title: '新建产品信息',\n        isEdit: false\n      })\n    },\n    // $emit改变isvisible\n    isDrawer(val) {\n      this.visible = val\n      // 关闭抽屉主动初始化\n      this.timer = setTimeout(() => {\n        this.rest().then(() => {\n          searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n        })\n      }, 100)\n    },\n    // 关闭抽屉回调\n    closeDrawer() {\n      this.visible = false\n      // 关闭抽屉主动初始化\n      this.timer = setTimeout(() => {\n        this.rest().then(() => {\n          searchGoods.call(this, {}) // 成品列表商品搜索Tab列表\n        })\n      }, 100)\n    },\n    // rest\n    async rest() {\n      this.selectCodeValue = undefined\n      this.selectNameValue = undefined\n      this.springValue = undefined\n    },\n    // 删除\n    processDelete() {\n      const that = this\n      if (this.selectedRowKeys.length > 0) {\n        this.$confirm({\n          title: '您确认要删除吗?',\n          okType: 'danger',\n          onOk() {\n            const params = that.selectedRowKeys.join('&skuIds=')\n            bomDelete.call(that, params).then(() => {\n              that.rest().then(() => {\n                searchGoods.call(that, {})\n                that.selectedRowKeys = []\n              })\n            })\n          },\n          onCancel() {\n            console.log('Cancel')\n          },\n          class: 'test'\n        })\n      }\n    },\n    // 分页\n    onChangePage(pagination, filters, sorter) {\n      console.log(pagination.current + '分页下标')\n      console.log(pagination.pageSize)\n      searchGoods.call(this, {\n        currentPage: pagination.current,\n        pageSize: pagination.pageSize,\n        skuCode: this.selectCodeValue,\n        keywords: this.selectNameValue,\n        springType: this.springValue\n      })\n      // 切换分页先清空选中状态\n      this.selectedRowKeys = []\n    },\n    // 产品编码模糊搜索\n    handleSearchCode(value) {\n      goodsCodefetch.call(this, value, data => (this.selectCodeData = data))\n      console.log(this.selectCodeData)\n    },\n    handleChangeCode(value) {\n      this.selectCodeValue = value\n      searchGoods.call(this, { skuCode: value })\n    },\n    // handleScrollCode(e) {\n    //   const SCROLLTHEIGHT = e.target.scrollHeight // 获取元素内容高度\n    //   const SCROLLTOP = e.target.scrollTop // 获取或者设置元素的滚动高度\n    //   const CLIENTHEIGHT = e.target.clientHeight // 读取元素的可见高度\n    //   const CONDITION = SCROLLTHEIGHT - SCROLLTOP <= CLIENTHEIGHT\n    //   if (CONDITION) {\n    //     this.scrollPositionCode++\n    //     listCompanyGoodsCode.call(this, this.scrollPositionCode)\n    //   }\n    // },\n    // 产品名称\n    handleSearchName(value) {\n      goodsNamefetch.call(this, value, data => (this.selectNameData = data))\n      // console.log(this.selectNameData)\n    },\n    handleChangeName(value) {\n      console.log(value)\n      this.selectNameValue = value\n      searchGoods.call(this, { keywords: [value || ''] })\n    },\n    // 弹簧种类\n    handleChangeSpring(value) {\n      console.log(value)\n      this.springValue = value\n      searchGoods.call(this, { springType: value })\n    },\n    // 点击客户列表更新Tab详情\n    custId(val) {\n      searchGoods.call(this, { custId: val })\n    },\n    custVal(val) {\n      searchGoods.call(this, { custId: val })\n    },\n    // Tab 删除\n    onChangeTab(selectedRowKeys) {\n      console.log(selectedRowKeys)\n      this.selectedRowKeys = selectedRowKeys\n    }\n  },\n  computed: {\n    rowSelection() {\n      const { selectedRowKeys } = this\n      return {\n        selectedRowKeys,\n        onChange: this.onChangeTab,\n        hideDefaultSelections: true\n      }\n    },\n    getMenuPermission() {\n      return this.$store.state.menuPermission\n    }\n  },\n  components: {\n    'scroll-list': ScrollList,\n    'goods-info': Goodsinfo\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.process-setup {\n  margin-bottom: 20px;\n  .delete-btn {\n    margin-left: 20px;\n    cursor: pointer;\n    .delete-icon {\n      .delete();\n    }\n  }\n  .derive-btn {\n    cursor: pointer;\n    .derive-icon {\n      .more();\n      margin-left: 20px;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/product/pdm/goods"}]}