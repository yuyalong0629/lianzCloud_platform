{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/craft/process/child_info/ProcessInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/craft/process/child_info/ProcessInfo.vue","mtime":1558927332558},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport PromptTitle from '@/components/tools/prompt/PromptTitle';\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin';\nimport { postProcessAdd, processUpdate } from '../basic_lib/index';\nimport { Promise } from 'q';\nimport { setTimeout } from 'timers';\nexport default {\n  name: 'ProcessInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data: function data() {\n    return {\n      processFormInfo: this.$form.createForm(this),\n      previewVisible: false,\n      previewImage: '',\n      // url\n      fileList: [],\n      headers: {\n        'AUTH-TOKEN': localStorage.getItem('ACCESS_TOKEN'),\n        companyId: localStorage.getItem('companyId')\n      },\n      // Info接收\n      getProcessInfo: {}\n    };\n  },\n  props: {\n    processInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  methods: {\n    // 提交\n    onSubmit: function onSubmit(e) {\n      e.preventDefault();\n      this.getFormData(null, this.fileList[0].response.data, postProcessAdd);\n    },\n    // 保存修改\n    onSave: function onSave(e) {\n      e.preventDefault();\n      this.getFormData(this.getProcessInfo.id, this.fileList[0].url, processUpdate);\n    },\n    // 编辑 || 取消\n    isDisabled: function isDisabled(val) {\n      var _this = this;\n\n      var edit = new Promise(function (resolved) {\n        // Input选中\n        _this.disabled = !val; // label color\n\n        _this.isLabelColor = !_this.isLabelColor;\n        resolved();\n      });\n      edit.then(function () {\n        if (_this.disabled) {\n          _this.setFormData();\n        }\n      });\n    },\n    // 删除\n    isDelete: function isDelete(val) {\n      // deleteCategory.call(this, this.viewCategoryInfo.id).then(() => {\n      this.$emit('isDrawer', val); // })\n    },\n    // upload\n    handleCancel: function handleCancel() {\n      this.previewVisible = false;\n    },\n    handlePreview: function handlePreview(file) {\n      this.previewImage = file.url || file.thumbUrl;\n      this.previewVisible = true;\n    },\n    handleChange: function handleChange(_ref) {\n      var file = _ref.file,\n          fileList = _ref.fileList;\n      this.fileList = fileList;\n    },\n    // Form\n    getFormData: function getFormData(id, fileList, postFormData) {\n      var _this2 = this;\n\n      this.processFormInfo.validateFields(function (err, values) {\n        if (!err) {\n          console.log(_this2.fileList);\n          _this2.loading = true;\n          var params = {\n            // code: '', // 工序编码\n            id: id,\n            name: values.processName,\n            // 工序名称\n            optBook: _this2.fileList.length > 0 ? fileList : '',\n            qc: values.processInspection,\n            // 是否质检\n            remark: values.processRemark,\n            // 备注\n            standardHours: values.processWorkHours,\n            // 标准工时\n            timeBilling: values.processBilling // 工时计费\n\n          };\n          console.log(params);\n          postFormData.call(_this2, params);\n        }\n      });\n    },\n    // Info\n    setFormData: function setFormData() {\n      this.processFormInfo.setFieldsValue({\n        processName: this.getProcessInfo.name,\n        // 工序名称\n        processInspection: this.getProcessInfo.qc,\n        // 是否质检\n        processRemark: this.getProcessInfo.remark,\n        // 备注\n        processWorkHours: this.getProcessInfo.standardHours,\n        // 标准工时\n        processBilling: this.getProcessInfo.timeBilling // 工时计费\n\n      });\n    }\n  },\n  watch: {\n    processInfo: {\n      handler: function handler(val) {\n        console.log(val);\n        this.getProcessInfo = val; // 判断是否有图片\n\n        if (val && val.optBook) {\n          this.fileList = [{\n            url: val.optBook,\n            uid: '-1',\n            name: 'xxx.png'\n          }];\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n};",{"version":3,"sources":["ProcessInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"process-info\">\n    <prompt-title @isDisabled=\"isDisabled\" @isDelete=\"isDelete\"></prompt-title>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"process-title\">基础信息</h3>\n      </a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <a-form :form=\"processFormInfo\" layout=\"horizontal\" hideRequiredMark>\n          <a-row>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工序编码\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input\n                  v-if=\"disabled\"\n                  disabled=\"disabled\"\n                  v-decorator=\"['processCode']\"\n                  placeholder=\"默认带出\"\n                />\n                <template v-else=\"disabled\">{{getProcessInfo.code}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"标准工时\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processWorkHours']\" placeholder=\"请输入标准工时\"/>\n                <template v-else=\"disabled\">{{getProcessInfo.standardHours}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工序名称\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processName']\" placeholder=\"请输入工序名称\"/>\n                <template v-else=\"disabled\">{{getProcessInfo.name}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"备注\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processRemark']\" placeholder=\"请输入备注\"/>\n                <template v-else=\"disabled\">{{getProcessInfo.remark}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"工时计费\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-input v-if=\"disabled\" v-decorator=\"['processBilling']\" placeholder=\"请输入工时计费\"/>\n                <template v-else=\"disabled\">{{getProcessInfo.timeBilling}}</template>\n              </a-form-item>\n            </a-col>\n            <a-col :span=\"8\">\n              <a-form-item\n                label=\"是否质检\"\n                :class=\"{labelColor: isLabelColor}\"\n                :label-col=\"labelCol\"\n                :wrapper-col=\"wrapperCol\"\n              >\n                <a-switch\n                  v-if=\"disabled\"\n                  v-decorator=\"['processInspection', { initialValue: false, valuePropName: 'checked' }]\"\n                />\n                <template v-else=\"disabled\">{{getProcessInfo.qc ? '屎' : '否'}}</template>\n              </a-form-item>\n            </a-col>\n          </a-row>\n        </a-form>\n      </a-col>\n    </a-row>\n    <a-row>\n      <a-col :span=\"24\">\n        <h3 class=\"process-title\">文件</h3>\n      </a-col>\n      <a-col :span=\"24\">\n        <div class=\"clearfix\" style=\"marginLeft: 16px;\">\n          <a-upload\n            action=\"/api/ic/user/file/uploadFile\"\n            listType=\"picture-card\"\n            :data=\"{'bizType': 'GOODS'}\"\n            :headers=\"headers\"\n            :fileList=\"fileList\"\n            @preview=\"handlePreview\"\n            @change=\"handleChange\"\n          >\n            <div v-if=\"fileList.length < 1\">\n              <a-icon type=\"plus\"/>\n              <div class=\"ant-upload-text\">Upload</div>\n            </div>\n          </a-upload>\n          <a-modal :visible=\"previewVisible\" :footer=\"null\" @cancel=\"handleCancel\">\n            <img alt=\"example\" style=\"width: 100%\" :src=\"previewImage\">\n          </a-modal>\n        </div>\n      </a-col>\n    </a-row>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport PromptTitle from '@/components/tools/prompt/PromptTitle'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport { postProcessAdd, processUpdate } from '../basic_lib/index'\nimport { Promise } from 'q'\nimport { setTimeout } from 'timers'\n\nexport default {\n  name: 'ProcessInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      processFormInfo: this.$form.createForm(this),\n      previewVisible: false,\n      previewImage: '',\n      // url\n      fileList: [],\n      headers: {\n        'AUTH-TOKEN': localStorage.getItem('ACCESS_TOKEN'),\n        companyId: localStorage.getItem('companyId')\n      },\n      // Info接收\n      getProcessInfo: {}\n    }\n  },\n  props: {\n    processInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  methods: {\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData(null, this.fileList[0].response.data, postProcessAdd)\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData(\n        this.getProcessInfo.id,\n        this.fileList[0].url,\n        processUpdate\n      )\n    },\n    // 编辑 || 取消\n    isDisabled(val) {\n      const edit = new Promise(resolved => {\n        // Input选中\n        this.disabled = !val\n        // label color\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    },\n    // 删除\n    isDelete(val) {\n      // deleteCategory.call(this, this.viewCategoryInfo.id).then(() => {\n      this.$emit('isDrawer', val)\n      // })\n    },\n    // upload\n    handleCancel() {\n      this.previewVisible = false\n    },\n    handlePreview(file) {\n      this.previewImage = file.url || file.thumbUrl\n      this.previewVisible = true\n    },\n    handleChange({ file, fileList }) {\n      this.fileList = fileList\n    },\n    // Form\n    getFormData(id, fileList, postFormData) {\n      this.processFormInfo.validateFields((err, values) => {\n        if (!err) {\n          console.log(this.fileList)\n          this.loading = true\n          const params = {\n            // code: '', // 工序编码\n            id,\n            name: values.processName, // 工序名称\n            optBook: this.fileList.length > 0 ? fileList : '',\n            qc: values.processInspection, // 是否质检\n            remark: values.processRemark, // 备注\n            standardHours: values.processWorkHours, // 标准工时\n            timeBilling: values.processBilling // 工时计费\n          }\n          console.log(params)\n          postFormData.call(this, params)\n        }\n      })\n    },\n    // Info\n    setFormData() {\n      this.processFormInfo.setFieldsValue({\n        processName: this.getProcessInfo.name, // 工序名称\n        processInspection: this.getProcessInfo.qc, // 是否质检\n        processRemark: this.getProcessInfo.remark, // 备注\n        processWorkHours: this.getProcessInfo.standardHours, // 标准工时\n        processBilling: this.getProcessInfo.timeBilling // 工时计费\n      })\n    }\n  },\n  watch: {\n    processInfo: {\n      handler(val) {\n        console.log(val)\n        this.getProcessInfo = val\n        // 判断是否有图片\n        if (val && val.optBook) {\n          this.fileList = [\n            {\n              url: val.optBook,\n              uid: '-1',\n              name: 'xxx.png'\n            }\n          ]\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'prompt-title': PromptTitle\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.process-info {\n  .process-title {\n    margin-bottom: 16px;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/product/craft/process/child_info"}]}