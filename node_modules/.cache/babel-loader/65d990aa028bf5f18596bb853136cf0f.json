{"remainingRequest":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/GoodsInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/src/views/product/bom/bom_list/child_info/GoodsInfo.vue","mtime":1561431499265},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Object$keys from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/object/keys\";\nimport _defineProperty from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _Promise from \"/Users/yuyalong/myProjects/lianzhiyun/projects/web-project/platform/node_modules/@babel/runtime-corejs2/core-js/promise\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Bus from '@/Bus.js';\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin';\nimport TabTitle from '../other/TabTitle';\nimport TabMallInfo from './tab_mallInfo/TabMallInfo'; // 产品信息\n\nimport ProductInfoForm from './tab_goodsInfo/ProductInfoForm';\nimport ClassAttrForm from './tab_goodsInfo/ClassAttrForm';\nimport ProductUpload from '@/components/upload/Upload'; // index\n\nimport { goodsSkuAdd } from '../basic_lib/index';\nexport default {\n  name: 'GoodsInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data: function data() {\n    return {\n      isLabelColor: false,\n      getClassType: false,\n      classAttrVal: [],\n      // 产品详情data\n      skuData: {},\n      // Pic\n      pics: [],\n      // 客户详情\n      custInfo: {},\n      springInfo: {},\n      // 分类属性\n      attrVals: [],\n      // 产品详情回显\n      skuInfoData: {},\n      classCatObjId: [],\n      // 产品图片回显\n      picInfoData: [],\n      // 分类属性回显\n      classAttrInfoData: [],\n      classCatId: ''\n    };\n  },\n  props: {\n    goodsViewInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    // 编辑 || 取消\n    Bus.$on('isDisabled', function (val) {\n      // Input选中\n      console.log(val);\n      var edit = new _Promise(function (resolved) {\n        _this.disabled = !val;\n        _this.isLabelColor = !_this.isLabelColor;\n        resolved();\n      });\n      edit.then(function () {\n        if (_this.disabled) {\n          _this.setFormData();\n        }\n      });\n    });\n  },\n  destroyed: function destroyed() {\n    Bus.$off('isDisabled');\n  },\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName: function onChangeCategoryName(value) {// console.log(value)\n    },\n    // 提交\n    onSubmit: function onSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      this.getFormData().then(function () {\n        var params = {\n          sku: _objectSpread({}, _this2.skuData, {\n            catId: _this2.skuData.catId ? _this2.skuData.catId.slice(-1).join('') : ''\n          }, _this2.price, {\n            skuType: 'MATERIAL'\n          }),\n          pics: _toConsumableArray(_this2.pics),\n          custInfo: _objectSpread({}, _this2.custInfo),\n          attrVals: _toConsumableArray(_this2.attrVals) // console.log(params)\n          // 添加商品列表\n\n        };\n        goodsSkuAdd.call(_this2, params, '添加成功');\n      });\n    },\n    // 保存修改\n    onSave: function onSave(e) {\n      var _this3 = this;\n\n      e.preventDefault();\n      this.getFormData().then(function () {\n        var params = {\n          sku: _objectSpread({}, _this3.skuData, {\n            catId: _this3.skuData.catId ? _this3.skuData.catId.slice(-1).join('') : ''\n          }, _this3.price, {\n            skuType: 'MATERIAL'\n          }),\n          pics: _toConsumableArray(_this3.pics),\n          custInfo: _objectSpread({}, _this3.custInfo),\n          attrVals: _toConsumableArray(_this3.attrVals) // console.log(params)\n          // 添加商品列表\n\n        };\n        goodsSkuAdd.call(_this3, params, '更新成功');\n      });\n    },\n    // 删除\n    isDelete: function isDelete(val) {},\n    // 子组件分类属性 $emit\n    classAttrInfo: function classAttrInfo(val) {\n      if (val.length) {\n        this.getClassType = true;\n        this.classAttrVal = val;\n        return;\n      }\n\n      this.getClassType = false;\n    },\n    // 子组件分类属性 接受data $emit\n    classData: function classData(val) {\n      // console.log(val)\n      this.attrVals = val;\n    },\n    // Upload\n    propsFileList: function propsFileList(val) {\n      this.pics = val;\n    },\n    // 产品详情子组件接受分类属性ID数组\n    classCatObj: function classCatObj(val) {\n      this.classCatObjId = val.id;\n    },\n    // FormData\n    getFormData: function () {\n      var _getFormData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this4 = this;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // 产品详情FormData\n                this.$refs.goodsInfoForm.goodsInfoForm.validateFields(function (err, values) {\n                  if (!err) {\n                    // console.log(values)\n                    _this4.skuData = values;\n                  }\n                }); // 分类属性FormData\n\n                if (this.$refs.classAttrForm) {\n                  this.$refs.classAttrForm.classAttrInfoForm.validateFields(function (err, values) {\n                    if (!err) {// console.log(values)\n                    }\n                  });\n                } // 弹簧属性FormData\n\n\n                if (this.$refs.productAttrForm) {\n                  this.$refs.productAttrForm.productAttrForm.validateFields(function (err, values) {\n                    if (!err) {\n                      // console.log(values)\n                      _this4.springInfo = values;\n                    }\n                  });\n                }\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getFormData() {\n        return _getFormData.apply(this, arguments);\n      }\n\n      return getFormData;\n    }(),\n    // Form详情\n    setFormData: function () {\n      var _setFormData = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var _this$$refs$goodsInfo;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // 产品详情FormData\n                this.$refs.goodsInfoForm.goodsInfoForm.setFieldsValue((_this$$refs$goodsInfo = {\n                  catId: this.classCatObjId,\n                  name: this.skuInfoData.name,\n                  drawNum: this.skuInfoData.drawNum,\n                  drawVersion: this.skuInfoData.drawVersion,\n                  spec: this.skuInfoData.spec,\n                  unit: this.skuInfoData.unit\n                }, _defineProperty(_this$$refs$goodsInfo, \"unit\", this.skuInfoData.unit), _defineProperty(_this$$refs$goodsInfo, \"gateway\", this.skuInfoData.gateway), _defineProperty(_this$$refs$goodsInfo, \"standard\", this.skuInfoData.standard), _defineProperty(_this$$refs$goodsInfo, \"weight\", this.skuInfoData.weight + ''), _defineProperty(_this$$refs$goodsInfo, \"bmcl\", this.skuInfoData.bmcl), _defineProperty(_this$$refs$goodsInfo, \"remark\", this.skuInfoData.remark), _defineProperty(_this$$refs$goodsInfo, \"price\", this.skuInfoData.price), _this$$refs$goodsInfo));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function setFormData() {\n        return _setFormData.apply(this, arguments);\n      }\n\n      return setFormData;\n    }()\n  },\n  watch: {\n    goodsViewInfo: {\n      handler: function handler(val) {\n        console.log(val);\n\n        if (_Object$keys(val).length) {\n          // sku\n          this.skuInfoData = val.sku; // PIC\n\n          this.picInfoData = val.pics; // 分类属性\n\n          this.classAttrInfoData = val.attrVals;\n          this.classCatId = val.sku.catId;\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'tab-title': TabTitle,\n    'tabMall-info': TabMallInfo,\n    'product-info': ProductInfoForm,\n    'class-attr': ClassAttrForm,\n    'product-upload': ProductUpload\n  }\n};",{"version":3,"sources":["GoodsInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA,OAAA,GAAA,MAAA,UAAA;AACA,SAAA,UAAA,EAAA,WAAA,QAAA,gCAAA;AACA,OAAA,QAAA,MAAA,mBAAA;AACA,OAAA,WAAA,MAAA,4BAAA,C,CACA;;AACA,OAAA,eAAA,MAAA,iCAAA;AACA,OAAA,aAAA,MAAA,+BAAA;AACA,OAAA,aAAA,MAAA,4BAAA,C,CACA;;AACA,SAAA,WAAA,QAAA,oBAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,WADA;AAEA,EAAA,MAAA,EAAA,CAAA,UAAA,EAAA,WAAA,CAFA;AAGA,EAAA,IAHA,kBAGA;AACA,WAAA;AACA,MAAA,YAAA,EAAA,KADA;AAEA,MAAA,YAAA,EAAA,KAFA;AAGA,MAAA,YAAA,EAAA,EAHA;AAIA;AACA,MAAA,OAAA,EAAA,EALA;AAMA;AACA,MAAA,IAAA,EAAA,EAPA;AAQA;AACA,MAAA,QAAA,EAAA,EATA;AAUA,MAAA,UAAA,EAAA,EAVA;AAWA;AACA,MAAA,QAAA,EAAA,EAZA;AAaA;AACA,MAAA,WAAA,EAAA,EAdA;AAeA,MAAA,aAAA,EAAA,EAfA;AAgBA;AACA,MAAA,WAAA,EAAA,EAjBA;AAkBA;AACA,MAAA,iBAAA,EAAA,EAnBA;AAoBA,MAAA,UAAA,EAAA;AApBA,KAAA;AAsBA,GA1BA;AA2BA,EAAA,KAAA,EAAA;AACA,IAAA,aAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GA3BA;AAiCA,EAAA,OAjCA,qBAiCA;AAAA;;AACA;AACA,IAAA,GAAA,CAAA,GAAA,CAAA,YAAA,EAAA,UAAA,GAAA,EAAA;AACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,UAAA,IAAA,GAAA,aAAA,UAAA,QAAA,EAAA;AACA,QAAA,KAAA,CAAA,QAAA,GAAA,CAAA,GAAA;AACA,QAAA,KAAA,CAAA,YAAA,GAAA,CAAA,KAAA,CAAA,YAAA;AACA,QAAA,QAAA;AACA,OAJA,CAAA;AAKA,MAAA,IAAA,CAAA,IAAA,CAAA,YAAA;AACA,YAAA,KAAA,CAAA,QAAA,EAAA;AACA,UAAA,KAAA,CAAA,WAAA;AACA;AACA,OAJA;AAKA,KAbA;AAcA,GAjDA;AAkDA,EAAA,SAlDA,uBAkDA;AACA,IAAA,GAAA,CAAA,IAAA,CAAA,YAAA;AACA,GApDA;AAqDA,EAAA,OAAA,EAAA;AACA;AACA,IAAA,oBAFA,gCAEA,KAFA,EAEA,CACA;AACA,KAJA;AAKA;AACA,IAAA,QANA,oBAMA,CANA,EAMA;AAAA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,WAAA,WAAA,GAAA,IAAA,CAAA,YAAA;AACA,YAAA,MAAA,GAAA;AACA,UAAA,GAAA,oBACA,MAAA,CAAA,OADA;AAEA,YAAA,KAAA,EAAA,MAAA,CAAA,OAAA,CAAA,KAAA,GACA,MAAA,CAAA,OAAA,CAAA,KAAA,CAAA,KAAA,CAAA,CAAA,CAAA,EAAA,IAAA,CAAA,EAAA,CADA,GAEA;AAJA,aAKA,MAAA,CAAA,KALA;AAMA,YAAA,OAAA,EAAA;AANA,YADA;AASA,UAAA,IAAA,qBAAA,MAAA,CAAA,IAAA,CATA;AAUA,UAAA,QAAA,oBACA,MAAA,CAAA,QADA,CAVA;AAaA,UAAA,QAAA,qBAAA,MAAA,CAAA,QAAA,CAbA,CAeA;AACA;;AAhBA,SAAA;AAiBA,QAAA,WAAA,CAAA,IAAA,CAAA,MAAA,EAAA,MAAA,EAAA,MAAA;AACA,OAnBA;AAoBA,KA5BA;AA6BA;AACA,IAAA,MA9BA,kBA8BA,CA9BA,EA8BA;AAAA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,WAAA,WAAA,GAAA,IAAA,CAAA,YAAA;AACA,YAAA,MAAA,GAAA;AACA,UAAA,GAAA,oBACA,MAAA,CAAA,OADA;AAEA,YAAA,KAAA,EAAA,MAAA,CAAA,OAAA,CAAA,KAAA,GACA,MAAA,CAAA,OAAA,CAAA,KAAA,CAAA,KAAA,CAAA,CAAA,CAAA,EAAA,IAAA,CAAA,EAAA,CADA,GAEA;AAJA,aAKA,MAAA,CAAA,KALA;AAMA,YAAA,OAAA,EAAA;AANA,YADA;AASA,UAAA,IAAA,qBAAA,MAAA,CAAA,IAAA,CATA;AAUA,UAAA,QAAA,oBACA,MAAA,CAAA,QADA,CAVA;AAaA,UAAA,QAAA,qBAAA,MAAA,CAAA,QAAA,CAbA,CAeA;AACA;;AAhBA,SAAA;AAiBA,QAAA,WAAA,CAAA,IAAA,CAAA,MAAA,EAAA,MAAA,EAAA,MAAA;AACA,OAnBA;AAoBA,KApDA;AAqDA;AACA,IAAA,QAtDA,oBAsDA,GAtDA,EAsDA,CAAA,CAtDA;AAuDA;AACA,IAAA,aAxDA,yBAwDA,GAxDA,EAwDA;AACA,UAAA,GAAA,CAAA,MAAA,EAAA;AACA,aAAA,YAAA,GAAA,IAAA;AACA,aAAA,YAAA,GAAA,GAAA;AACA;AACA;;AACA,WAAA,YAAA,GAAA,KAAA;AACA,KA/DA;AAgEA;AACA,IAAA,SAjEA,qBAiEA,GAjEA,EAiEA;AACA;AACA,WAAA,QAAA,GAAA,GAAA;AACA,KApEA;AAqEA;AACA,IAAA,aAtEA,yBAsEA,GAtEA,EAsEA;AACA,WAAA,IAAA,GAAA,GAAA;AACA,KAxEA;AAyEA;AACA,IAAA,WA1EA,uBA0EA,GA1EA,EA0EA;AACA,WAAA,aAAA,GAAA,GAAA,CAAA,EAAA;AACA,KA5EA;AA6EA;AACA,IAAA,WA9EA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA+EA;AACA,qBAAA,KAAA,CAAA,aAAA,CAAA,aAAA,CAAA,cAAA,CAAA,UAAA,GAAA,EAAA,MAAA,EAAA;AACA,sBAAA,CAAA,GAAA,EAAA;AACA;AACA,oBAAA,MAAA,CAAA,OAAA,GAAA,MAAA;AACA;AACA,iBALA,EAhFA,CAsFA;;AACA,oBAAA,KAAA,KAAA,CAAA,aAAA,EAAA;AACA,uBAAA,KAAA,CAAA,aAAA,CAAA,iBAAA,CAAA,cAAA,CACA,UAAA,GAAA,EAAA,MAAA,EAAA;AACA,wBAAA,CAAA,GAAA,EAAA,CACA;AACA;AACA,mBALA;AAOA,iBA/FA,CAgGA;;;AACA,oBAAA,KAAA,KAAA,CAAA,eAAA,EAAA;AACA,uBAAA,KAAA,CAAA,eAAA,CAAA,eAAA,CAAA,cAAA,CACA,UAAA,GAAA,EAAA,MAAA,EAAA;AACA,wBAAA,CAAA,GAAA,EAAA;AACA;AACA,sBAAA,MAAA,CAAA,UAAA,GAAA,MAAA;AACA;AACA,mBANA;AAQA;;AA1GA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AA4GA;AACA,IAAA,WA7GA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA8GA;AACA,qBAAA,KAAA,CAAA,aAAA,CAAA,aAAA,CAAA,cAAA;AACA,kBAAA,KAAA,EAAA,KAAA,aADA;AAEA,kBAAA,IAAA,EAAA,KAAA,WAAA,CAAA,IAFA;AAGA,kBAAA,OAAA,EAAA,KAAA,WAAA,CAAA,OAHA;AAIA,kBAAA,WAAA,EAAA,KAAA,WAAA,CAAA,WAJA;AAKA,kBAAA,IAAA,EAAA,KAAA,WAAA,CAAA,IALA;AAMA,kBAAA,IAAA,EAAA,KAAA,WAAA,CAAA;AANA,kEAOA,KAAA,WAAA,CAAA,IAPA,qDAQA,KAAA,WAAA,CAAA,OARA,sDASA,KAAA,WAAA,CAAA,QATA,oDAUA,KAAA,WAAA,CAAA,MAAA,GAAA,EAVA,kDAWA,KAAA,WAAA,CAAA,IAXA,oDAYA,KAAA,WAAA,CAAA,MAZA,mDAaA,KAAA,WAAA,CAAA,KAbA;;AA/GA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GArDA;AAqLA,EAAA,KAAA,EAAA;AACA,IAAA,aAAA,EAAA;AACA,MAAA,OADA,mBACA,GADA,EACA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;;AACA,YAAA,aAAA,GAAA,EAAA,MAAA,EAAA;AACA;AACA,eAAA,WAAA,GAAA,GAAA,CAAA,GAAA,CAFA,CAGA;;AACA,eAAA,WAAA,GAAA,GAAA,CAAA,IAAA,CAJA,CAKA;;AACA,eAAA,iBAAA,GAAA,GAAA,CAAA,QAAA;AACA,eAAA,UAAA,GAAA,GAAA,CAAA,GAAA,CAAA,KAAA;AACA;AACA,OAZA;AAaA,MAAA,IAAA,EAAA,IAbA;AAcA,MAAA,SAAA,EAAA;AAdA;AADA,GArLA;AAuMA,EAAA,UAAA,EAAA;AACA,iBAAA,QADA;AAEA,oBAAA,WAFA;AAGA,oBAAA,eAHA;AAIA,kBAAA,aAJA;AAKA,sBAAA;AALA;AAvMA,CAAA","sourcesContent":["<template>\n  <div class=\"goods-info\">\n    <tab-title @isDelete=\"isDelete\">\n      <template v-slot:tabGoodsInfo>\n        <!-- 产品信息 -->\n        <a-row>\n          <a-col :span=\"24\">\n            <h3 class=\"categoryInfo-title\">产品详情</h3>\n          </a-col>\n          <a-col :span=\"24\">\n            <product-info\n              ref=\"goodsInfoForm\"\n              @classAttrInfo=\"classAttrInfo\"\n              @classCatObj=\"classCatObj\"\n              :skuInfoData=\"skuInfoData\"\n              :childDisabled=\"disabled\"\n            />\n          </a-col>\n          <a-col :span=\"24\" v-if=\"getClassType || classAttrInfoData.length\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">分类属性</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <class-attr\n                ref=\"classAttrForm\"\n                @classData=\"classData\"\n                :classAttrVal=\"classAttrVal\"\n                :childDisabled=\"disabled\"\n                :classAttrInfoData=\"classAttrInfoData\"\n                :classCatId=\"classCatId\"\n              />\n            </a-col>\n          </a-col>\n          <a-col :span=\"24\">\n            <a-col :span=\"24\">\n              <h3 class=\"categoryInfo-title\">产品图片</h3>\n            </a-col>\n            <a-col :span=\"24\">\n              <product-upload @propsFileList=\"propsFileList\" :picInfoData=\"picInfoData\"/>\n            </a-col>\n          </a-col>\n        </a-row>\n      </template>\n      <template v-slot:tabMallAttr>\n        <tabMall-info/>\n      </template>\n    </tab-title>\n    <div\n      :style=\"{\n          position: 'absolute',\n          left: 0,\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #E9E9E9',\n          padding: '10px 16px',\n          background: '#FFF',\n          textAlign: 'right',\n        }\"\n    >\n      <a-button :style=\"{marginRight: '8px'}\" @click=\"onClose\">取消</a-button>\n      <a-button @click=\"onSubmit\" type=\"primary\" :loading=\"loading\" v-if=\"isEdit\">提交</a-button>\n      <a-button\n        @click=\"onSave\"\n        type=\"primary\"\n        :disabled=\"!disabled\"\n        :loading=\"loading\"\n        v-else=\"!isEdit\"\n      >保存</a-button>\n    </div>\n  </div>\n</template>\n<script>\nimport Bus from '@/Bus.js'\nimport { mixinBasic, mixinIsEdit } from '@/components/tools/mixin/mixin'\nimport TabTitle from '../other/TabTitle'\nimport TabMallInfo from './tab_mallInfo/TabMallInfo'\n// 产品信息\nimport ProductInfoForm from './tab_goodsInfo/ProductInfoForm'\nimport ClassAttrForm from './tab_goodsInfo/ClassAttrForm'\nimport ProductUpload from '@/components/upload/Upload'\n// index\nimport { goodsSkuAdd } from '../basic_lib/index'\n\nexport default {\n  name: 'GoodsInfo',\n  mixins: [mixinBasic, mixinIsEdit],\n  data() {\n    return {\n      isLabelColor: false,\n      getClassType: false,\n      classAttrVal: [],\n      // 产品详情data\n      skuData: {},\n      // Pic\n      pics: [],\n      // 客户详情\n      custInfo: {},\n      springInfo: {},\n      // 分类属性\n      attrVals: [],\n      // 产品详情回显\n      skuInfoData: {},\n      classCatObjId: [],\n      // 产品图片回显\n      picInfoData: [],\n      // 分类属性回显\n      classAttrInfoData: [],\n      classCatId: ''\n    }\n  },\n  props: {\n    goodsViewInfo: {\n      type: Object,\n      default: {}\n    }\n  },\n  created() {\n    // 编辑 || 取消\n    Bus.$on('isDisabled', val => {\n      // Input选中\n      console.log(val)\n      const edit = new Promise(resolved => {\n        this.disabled = !val\n        this.isLabelColor = !this.isLabelColor\n        resolved()\n      })\n      edit.then(() => {\n        if (this.disabled) {\n          this.setFormData()\n        }\n      })\n    })\n  },\n  destroyed() {\n    Bus.$off('isDisabled')\n  },\n  methods: {\n    // 公司上级分类\n    onChangeCategoryName(value) {\n      // console.log(value)\n    },\n    // 提交\n    onSubmit(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '添加成功')\n      })\n    },\n    // 保存修改\n    onSave(e) {\n      e.preventDefault()\n      this.getFormData().then(() => {\n        const params = {\n          sku: {\n            ...this.skuData,\n            catId: this.skuData.catId\n              ? this.skuData.catId.slice(-1).join('')\n              : '',\n            ...this.price,\n            skuType: 'MATERIAL'\n          },\n          pics: [...this.pics],\n          custInfo: {\n            ...this.custInfo\n          },\n          attrVals: [...this.attrVals]\n        }\n        // console.log(params)\n        // 添加商品列表\n        goodsSkuAdd.call(this, params, '更新成功')\n      })\n    },\n    // 删除\n    isDelete(val) {},\n    // 子组件分类属性 $emit\n    classAttrInfo(val) {\n      if (val.length) {\n        this.getClassType = true\n        this.classAttrVal = val\n        return\n      }\n      this.getClassType = false\n    },\n    // 子组件分类属性 接受data $emit\n    classData(val) {\n      // console.log(val)\n      this.attrVals = val\n    },\n    // Upload\n    propsFileList(val) {\n      this.pics = val\n    },\n    // 产品详情子组件接受分类属性ID数组\n    classCatObj(val) {\n      this.classCatObjId = val.id\n    },\n    // FormData\n    async getFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.validateFields((err, values) => {\n        if (!err) {\n          // console.log(values)\n          this.skuData = values\n        }\n      })\n      // 分类属性FormData\n      if (this.$refs.classAttrForm) {\n        this.$refs.classAttrForm.classAttrInfoForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n            }\n          }\n        )\n      }\n      // 弹簧属性FormData\n      if (this.$refs.productAttrForm) {\n        this.$refs.productAttrForm.productAttrForm.validateFields(\n          (err, values) => {\n            if (!err) {\n              // console.log(values)\n              this.springInfo = values\n            }\n          }\n        )\n      }\n    },\n    // Form详情\n    async setFormData() {\n      // 产品详情FormData\n      this.$refs.goodsInfoForm.goodsInfoForm.setFieldsValue({\n        catId: this.classCatObjId,\n        name: this.skuInfoData.name,\n        drawNum: this.skuInfoData.drawNum,\n        drawVersion: this.skuInfoData.drawVersion,\n        spec: this.skuInfoData.spec,\n        unit: this.skuInfoData.unit,\n        unit: this.skuInfoData.unit,\n        gateway: this.skuInfoData.gateway,\n        standard: this.skuInfoData.standard,\n        weight: this.skuInfoData.weight + '',\n        bmcl: this.skuInfoData.bmcl,\n        remark: this.skuInfoData.remark,\n        price: this.skuInfoData.price\n      })\n    }\n  },\n  watch: {\n    goodsViewInfo: {\n      handler(val) {\n        console.log(val)\n        if (Object.keys(val).length) {\n          // sku\n          this.skuInfoData = val.sku\n          // PIC\n          this.picInfoData = val.pics\n          // 分类属性\n          this.classAttrInfoData = val.attrVals\n          this.classCatId = val.sku.catId\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  },\n  components: {\n    'tab-title': TabTitle,\n    'tabMall-info': TabMallInfo,\n    'product-info': ProductInfoForm,\n    'class-attr': ClassAttrForm,\n    'product-upload': ProductUpload\n  }\n}\n</script>\n<style lang=\"less\" scoped>\n@import '~styles/variable.less';\n\n.goods-info {\n  .categoryInfo-title {\n    margin: 15px 0;\n    .h3_title();\n  }\n  .labelColor {\n    /deep/ .ant-form-item-label label {\n      .labelColor();\n    }\n  }\n}\n</style>"],"sourceRoot":"src/views/product/bom/bom_list/child_info"}]}